!function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.Graph=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var s=e("./KERNEL_DIR.class"),u=e("./KERNEL_ADJMATRIX_UPDATE.class"),l=e("./VFP_NODE.class"),d=e("./VFP_NODEPICKDRAG.class"),c=e("./ProccessImg.class"),h=r.Graph=function(){function e(t,r){var n=this;a(this,e),this._sce=t,this._project=this._sce.getLoadedProject(),this._gl=this._project.getActiveStage().getWebGLContext(),this._utils=new Utils,this.MAX_ITEMS_PER_ARRAY=4294967295,this.NODE_IMG_COLUMNS=8,this.NODE_IMG_WIDTH=2048,this._enableFont=r&&!0===r.enableFonts,this._enableHover=!1,this._enableAutoLink=!0,this._enabledForceLayout=!1,this._MAX_ADJ_MATRIX_WIDTH=2048,this._playAnimation=!1,this._loop=!1,this._animationFrames=500,this._geometryLength=void 0===r||r&&void 0===r.nodeDrawMode||r&&"plane"===r.nodeDrawMode?4:1,this.circleSegments=12,this.nodesTextPlanes=12,this.lineVertexCount=1,this._enableNeuronalNetwork=!1,this.batch_size=null,this.layerCount=0,this.afferentNodesCount=0,this.efferentNodesCount=0,this.trainTickCount=0,this.onAction=null,this.onTrained=null,this.afferentNeuron=[],this.efferentNeuron=[],this.v_val=0,this.return_v=!1,this._only2d=!1,this.multiplyOutput=1,this._nodesByName={},this._nodesById={},this._links={},this._customArgs={},this.arrAdjMatrix=null,this.arrAdjMatrixB=null,this.arrAdjMatrixC=null,this.currentTrainLayer=-3,this._ADJ_MATRIX_WIDTH=null,this._initTimestamp=0,this._currentFrame=0,this._endTimestamp=Date.now(),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames,this.readPixel=!1,this.selectedId=-1,this._initialPosDrag=null,this._onClickNode=null,this._onAnimationStep=null,this._onAnimationEnd=null,this.mesh_nodes=1===this._geometryLength?(new Mesh).loadPoint():(new Mesh).loadQuad(4,4),this.mesh_arrows=(new Mesh).loadTriangle({scale:1.75,side:.3}),this.mesh_nodesText=(new Mesh).loadQuad(4,4),this.objNodeImages={},this._stackNodesImg=[],this.nodesImgMask=null,this.nodesImgMaskLoaded=!1,this.nodesImgCrosshair=null,this.nodesImgCrosshairLoaded=!1,this.FONT_IMG_COLUMNS=7,this.disabVal=0,this.arrayNodeData=[],this.arrayNodeDataB=[],this.arrayNodeDataF=[],this.arrayNodeDataG=[],this.arrayNodeDataH=[],this.arrayNodePosXYZW=[],this.arrayNodeVertexPos=[],this.arrayNodeVertexNormal=[],this.arrayNodeVertexTexture=[],this.startIndexId=0,this.arrayNodeIndices=[],this.arrayNodeImgId=[],this.arrayNodeDir=[],this.currentNodeId=0,this.nodeArrayItemStart=0,this.linksObj=[],this.currentLinksObjItem=-1,this.currentLinkId=0,this.arrowsObj=[],this.currentArrowsObjItem=-1,this.currentArrowId=0,this.arrayNodeTextData=[],this.arrayNodeTextNodeName=[],this.arrayNodeTextPosXYZW=[],this.arrayNodeTextVertexPos=[],this.arrayNodeTextVertexNormal=[],this.arrayNodeTextVertexTexture=[],this.startIndexId_nodestext=0,this.arrayNodeTextIndices=[],this.arrayNodeText_itemStart=[],this.arrayNodeTextLetterId=[],this.currentNodeTextId=0,this.nodeTextArrayItemStart=0,this.layout=null,this.currHiddenNeuron=0,this.nodSep=5,this.nodes=new Node,this.nodes.setName("graph_nodes"),this._project.getActiveStage().addNode(this.nodes),this.nodes.addComponent(new ComponentTransform),this.comp_renderer_nodes=new Component_GPU,this.nodes.addComponent(this.comp_renderer_nodes);var o=new ComponentMouseEvents;this.nodes.addComponent(o),o.onmousedown(function(e){n.selectedId=-1,n.mouseDown()}),o.onmouseup(function(e){if(-1!==n.selectedId){var t=n._nodesById[n.selectedId];void 0!==t&&null!==t&&void 0!==t.onmouseup&&null!==t.onmouseup&&t.onmouseup(t,e)}n.mouseUp()}),o.onmousemove(function(e,t){n.makeDrag(e,t)}),o.onmousewheel(function(e){}),this.createLinksObjItem(),this.createArrowsObjItem(),this.nodesText=null,this.comp_renderer_nodesText=null,!0===this._enableFont&&(this.nodesText=new Node,this.nodesText.setName("graph_nodesText"),this._project.getActiveStage().addNode(this.nodesText),this.nodesText.addComponent(new ComponentTransform),this.comp_renderer_nodesText=new Component_GPU,this.nodesText.addComponent(this.comp_renderer_nodesText))}return i(e,[{key:"createLinksObjItem",value:function(){this.currentLinksObjItem++,this.linksObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayLinkData:[],arrayLinkDataC:[],arrayLinkNodeName:[],arrayLinkPosXYZW:[],arrayLinkVertexPos:[],startIndexId_link:0,arrayLinkIndices:[]}),this.linksObj[this.currentLinksObjItem].node.setName("graph_links"+this.currentLinksObjItem),this._project.getActiveStage().addNode(this.linksObj[this.currentLinksObjItem].node),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentTransform),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentRenderer)}},{key:"createArrowsObjItem",value:function(){this.currentArrowsObjItem++,this.arrowsObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayArrowData:[],arrayArrowDataC:[],arrayArrowNodeName:[],arrayArrowPosXYZW:[],arrayArrowVertexPos:[],arrayArrowVertexNormal:[],arrayArrowVertexTexture:[],startIndexId_arrow:0,arrayArrowIndices:[],arrowArrayItemStart:0}),this.arrowsObj[this.currentArrowsObjItem].node.setName("graph_arrows"+this.currentArrowsObjItem),this._project.getActiveStage().addNode(this.arrowsObj[this.currentArrowsObjItem].node),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentTransform),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentRenderer)}},{key:"onClickNode",value:function(e){this._onClickNode=e}},{key:"getBornDieTS",value:function(t,r){var n=this,o=void 0,a=void 0;if(null!=t)if(t.constructor===String)if("RANDOM"===t){var i=function(){for(var e=n._initTimestamp+Math.round(Math.random()*Math.max(0,n._animationFrames-20))*n._timeFrameIncrement,t=void 0;!((t=n._initTimestamp+Math.round(Math.random()*n._animationFrames)*n._timeFrameIncrement)>e););return{bornDate:e,dieDate:t}}();o=i.bornDate,a=i.dieDate}else o=e.datetimeToTimestamp(t),a=e.datetimeToTimestamp(r);else o=t,a=r;else o=1,a=0;return{bornDate:o,dieDate:a}}},{key:"showTimeline",value:function(e){var t=this,r=document.createElement("input");r.type="range",r.min="0",r.max=this._animationFrames.toString(),r.step="1",r.value="0",r.style.verticalAlign="middle",r.style.width="78%",e.innerText="",e.appendChild(r);r.addEventListener("input",function(e){var r=e.value;t.setFrame(r)}.bind(this,r))}},{key:"setTimelineDatetimeRange",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t.initDatetime),this._endTimestamp=e.datetimeToTimestamp(t.endDatetime),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeStart",value:function(){return this._initTimestamp}},{key:"setTimelineDatetimeRangeStart",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeEnd",value:function(){return this._endTimestamp}},{key:"setTimelineDatetimeRangeEnd",value:function(t){this._endTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineRangeDates",value:function(){return{initDate:this.timestampToDate(this._initTimestamp),endDate:this.timestampToDate(this._endTimestamp)}}},{key:"getTimelineFramesLength",value:function(){return this._animationFrames}},{key:"setTimelineFramesLength",value:function(e){this._animationFrames=e,this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"setTimelineTimestamp",value:function(e){this._currentFrame=Math.round((e-this._initTimestamp)/this._timeFrameIncrement)}},{key:"setFrame",value:function(e){this._currentFrame=e}},{key:"getFrame",value:function(e){return this._currentFrame}},{key:"playTimeline",value:function(e){this._playAnimation=!0,void 0!==e&&(this._loop=e)}},{key:"pauseTimeline",value:function(){this._playAnimation=!1}},{key:"onAnimationStep",value:function(e){this._onAnimationStep=e}},{key:"onAnimationEnd",value:function(e){this._onAnimationEnd=e}},{key:"getNodesCount",value:function(){return Object.keys(this._nodesByName).length}},{key:"getLinksCount",value:function(){return Object.keys(this._links).length}},{key:"getNodeByName",value:function(e){return this._nodesByName[e]}},{key:"getNodeById",value:function(e){return this._nodesById[e]}},{key:"selectNode",value:function(e){this.selectedId=e,this.makeDrag(null,$V3([0,0,0]))}},{key:"getSelectedId",value:function(){return this.selectedId}},{key:"enableHover",value:function(){this._enableHover=!0,this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1)}},{key:"enableAutoLink",value:function(){this._enableAutoLink=!0}},{key:"disableAutoLink",value:function(){this._enableAutoLink=!1}},{key:"only2d",value:function(e){this._only2d=e}},{key:"setFontsImage",value:function(e){var t=this;if(!0===this._enableFont){var r=new Image;r.onload=function(){t.comp_renderer_nodesText.setArg("fontsImg",function(){return r})},r.src=e}}},{key:"setNodeMesh",value:function(e){this.mesh_nodes=e}},{key:"exportFile",value:function(){var e="[",t="";for(var r in this._nodesByName)e+=t+JSON.stringify(this._nodesByName[r]),t=",",console.log(this._nodesByName[r]);e+="]|[",t="";for(var n in this._links)e+=t+JSON.stringify(this._links[n]),t=",",console.log(this._links[n]);e+="]",console.log(e)}},{key:"importFile",value:function(e){var t=e.split("|"),r=JSON.parse(t[0]),o=JSON.parse(t[1]);for(var a in r)this.addNode({name:r[a].name,data:r[a].name,label:r[a].label,position:r[a].pos,color:0===Math.floor(n%2)?"../_RESOURCES/lena_128x128.jpg":"../_RESOURCES/cartman08.jpg",layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:r[a].pos,initDir:[0,0,0,0],nodeColor:[Math.random(),Math.random(),Math.random(),1],nodeLock:0},onmouseup:function(e){}});for(var i in o){var s=o[i].origin_nodeName,u=o[i].target_nodeName;this.addLink({origin:s,target:u,directed:!0})}}},{key:"loadRBFromFile",value:function(e,t,r,n){var o=this,a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",function(e){console.log("RB file Loaded"),o.loadRBFromStr({data:e.target.responseText,generateBornAndDieDates:r,randomLinkWeights:n}),void 0!==t&&null!==t&&t()}),a.addEventListener("error",function(e){console.log(e)}),a.send(null)}},{key:"loadRBFromStr",value:function(e){var t=e.data,r=t.split("\r\n");1===r.length&&(r=t.split("\n"));var n=r[0].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==n[0]&&null!==n[0]&&n[0],void 0!==n[1]&&null!==n[1]&&n[1];console.log(n);var o=r[1].replace(/(\s|\t)+/gi," ").trim().split(" "),a=(void 0!==o[0]&&null!==o[0]&&parseInt(o[0]),void 0!==o[1]&&null!==o[1]?parseInt(o[1]):null),i=void 0!==o[2]&&null!==o[2]?parseInt(o[2]):null;void 0!==o[3]&&null!==o[3]&&parseInt(o[3]),void 0!==o[4]&&null!==o[4]&&parseInt(o[4]);console.log(o);var s=r[2].replace(/(\s|\t)+/gi," ").trim().split(" "),u=(void 0!==s[0]&&null!==s[0]&&s[0],void 0!==s[1]&&null!==s[1]?parseInt(s[1]):null);void 0!==s[2]&&null!==s[2]&&parseInt(s[2]),void 0!==s[3]&&null!==s[3]&&parseInt(s[3]),void 0!==s[4]&&null!==s[4]&&parseInt(s[4]);console.log(s);var l=r[3].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==l[0]&&null!==l[0]&&l[0],void 0!==l[1]&&null!==l[1]&&l[1],void 0!==l[2]&&null!==l[2]&&l[2],void 0!==l[3]&&null!==l[3]&&l[3];console.log(l);for(var d=0;d<u;d++){var c=[500*Math.random()-250,500*Math.random()-250,500*Math.random()-250,1],h=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0};this.addNode({name:d.toString(),data:d.toString(),label:d.toString(),position:c,color:!1===this._enableNeuronalNetwork?"../_RESOURCES/UV.jpg":"../_RESOURCES/white.jpg",bornDate:h.bornDate,dieDate:h.dieDate,layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:c,initDir:[0,0,0,0],nodeColor:[1,1,1,1],nodeLock:0},onmouseup:function(e){}})}for(var f="",p=4;p<4+a;p++)f+=r[p];var m=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(m),f="";for(var g=4+a;g<4+a+i;g++)f+=r[g];var _=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(_);for(var v=0,x=0,N=m.length;x<N;x++){for(var A=parseInt(m[x])-1,y=0,C=parseInt(m[x+1])-1-A;y<C;y++){var D=parseInt(_[A+y])-1,I=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0},b=void 0!==e.randomLinkWeights&&null!==e.randomLinkWeights&&!0===e.randomLinkWeights?"RANDOM":null;this.addLink({origin:D.toString(),target:v.toString(),directed:!0,bornDate:I.bornDate,dieDate:I.dieDate,weight:b})}v++}}},{key:"clear",value:function(){var e=function(e){var t=e.gpufG.getAllArgs();for(var r in t)t[r]instanceof WebCLGLBuffer==!0&&"RGB"!==r&&t[r].remove()};e(this.comp_renderer_nodes);for(var t=0;t<this.linksObj.length;t++)e(this.linksObj[t].componentRenderer);for(var r=0;r<this.arrowsObj.length;r++)e(this.arrowsObj[r].componentRenderer);!0===this._enableFont&&e(this.comp_renderer_nodesText),this._project.getActiveStage().removeNode(this.nodes);for(var n=0;n<this.linksObj.length;n++)this._project.getActiveStage().removeNode(this.linksObj[n].node);for(var o=0;o<this.arrowsObj.length;o++)this._project.getActiveStage().removeNode(this.arrowsObj[o].node);this._project.getActiveStage().removeNode(this.nodesText)}},{key:"applyLayout",value:function(e){this.layout=e;var t=function(e,t){for(var r=0,n=t.length;r<n;r++)e[t[r].trim().split(" ")[1]]={arg:t[r].trim(),nodes_array_value:[],links_array_value:[],arrows_array_value:[],nodestext_array_value:[]};return e};this.layout.argsDirection=void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection?this.layout.argsDirection.split(","):null,this.layout.argsObject=void 0!==this.layout.argsObject&&null!==this.layout.argsObject?this.layout.argsObject.split(","):null,this._customArgs={},null!=this.layout.argsDirection&&(this._customArgs=t(this._customArgs,this.layout.argsDirection)),null!=this.layout.argsObject&&(this._customArgs=t(this._customArgs,this.layout.argsObject))}},{key:"createWebGLBuffers",value:function(){var e=this,t={"float4* posXYZW":function(){return null},"float4* dataB":function(){return null},"float4* dataF":function(){return null},"float4* dataG":function(){return null},"float4* dataH":function(){return null},"float4*attr data":function(){return null},"float4*attr dataC":function(){return null},"float4*attr nodeVertexPos":function(){return null},"float4*attr nodeVertexNormal":function(){return null},"float4*attr nodeVertexTexture":function(){return null},"float*attr letterId":function(){return null},"float*attr nodeImgId":function(){return null},indices:function(){return null},"float4* adjacencyMatrix":function(){return null},"float4* adjacencyMatrixB":function(){return null},"float4* adjacencyMatrixC":function(){return null},"float widthAdjMatrix":function(){return null},"float nodesCount":function(){return null},"float currentTimestamp":function(){return null},"mat4 PMatrix":function(){return null},"mat4 cameraWMatrix":function(){return null},"mat4 nodeWMatrix":function(){return null},"float isNode":function(){return null},"float isLink":function(){return null},"float isArrow":function(){return null},"float isNodeText":function(){return null},"float bufferNodesWidth":function(){return null},"float bufferLinksWidth":function(){return null},"float bufferArrowsWidth":function(){return null},"float bufferTextsWidth":function(){return null},"float idToDrag":function(){return null},"float idToHover":function(){return null},"float enableForceLayout":function(){return null},"float enableForceLayoutCollision":function(){return null},"float enableNeuronalNetwork":function(){return null},"float afferentNodesCount":function(){return null},"float efferentNodesCount":function(){return null},"float efferentStart":function(){return null},"float currentTrainLayer":function(){return null},"float multiplyOutput":function(){return null},"float only2d":function(){return null},"float nodeImgColumns":function(){return null},"float fontImgColumns":function(){return null},"float4* fontsImg":function(){return null},"float4* nodesImg":function(){return null},"float4* nodesImgCrosshair":function(){return null}},r=0===this.afferentNodesCount?1:this.afferentNodesCount,n=0===this.efferentNodesCount?1:this.efferentNodesCount;if(t["float afferentNodesA["+r+"]"]=function(){return null},t["float efferentNodesA["+n+"]"]=function(){return null},t["float afferentNodesB["+r+"]"]=function(){return null},t["float efferentNodesB["+n+"]"]=function(){return null},t["float afferentNodesC["+r+"]"]=function(){return null},t["float efferentNodesC["+n+"]"]=function(){return null},t["float afferentNodesD["+r+"]"]=function(){return null},t["float efferentNodesD["+n+"]"]=function(){return null},t["float afferentNodesE["+r+"]"]=function(){return null},t["float efferentNodesE["+n+"]"]=function(){return null},t["float afferentNodesF["+r+"]"]=function(){return null},t["float efferentNodesF["+n+"]"]=function(){return null},t["float afferentNodesG["+r+"]"]=function(){return null},t["float efferentNodesG["+n+"]"]=function(){return null},void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection)for(var o=0;o<this.layout.argsDirection.length;o++)t[this.layout.argsDirection[o]]=function(){return null};if(void 0!==this.layout.argsObject&&null!==this.layout.argsObject)for(var a=0;a<this.layout.argsObject.length;a++)t[this.layout.argsObject[a]]=function(){return null};for(var i={"float4* dir":function(){return null},"float nodesCount":function(){return null},"float enableDrag":function(){return null},"float initialPosX":function(){return null},"float initialPosY":function(){return null},"float initialPosZ":function(){return null},"float MouseDragTranslationX":function(){return null},"float MouseDragTranslationY":function(){return null},"float MouseDragTranslationZ":function(){return null}},c=0;c<this.linksObj.length;c++)this.linksObj[c].componentRenderer.setGPUFor(this.linksObj[c].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"LINKS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.linksObj[c].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));for(var h=0;h<this.arrowsObj.length;h++)this.arrowsObj[h].componentRenderer.setGPUFor(this.arrowsObj[h].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"ARROWS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.arrowsObj[h].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));var f=Object.create(t);for(var p in i)f[p]=i[p];this.comp_renderer_nodes.setGPUFor(this.comp_renderer_nodes.gl,f,{type:"KERNEL",name:"NODES_KERNEL_DIR",viewSource:!1,config:s.KERNEL_DIR.getSrc(this.layout.codeDirection,this._geometryLength,this.currentNodeId-this.efferentNodesCount,this.efferentNodesCount,this._enableNeuronalNetwork),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"KERNEL",name:"NODES_KERNEL_ADJMATRIX_UPDATE",viewSource:!1,config:u.KERNEL_ADJMATRIX_UPDATE.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"GRAPHIC",name:"NODES_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA},{type:"GRAPHIC",name:"NODES_VFP_NODEPICKDRAG",viewSource:!1,config:d.VFP_NODEPICKDRAG.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ZERO});var m=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU);this.comp_renderer_nodes.getComponentBufferArg("RGB",m),this.comp_renderer_nodes.gpufG.onPreProcessKernel(0,function(){var t=e._initTimestamp+e._currentFrame*e._timeFrameIncrement;e.comp_renderer_nodes.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var r=0;r<e.linksObj.length;r++)e.linksObj[r].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var n=0;n<e.arrowsObj.length;n++)e.arrowsObj[n].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));!0===e._playAnimation&&(e._currentFrame++,void 0!==e._onAnimationStep&&null!==e._onAnimationStep&&e._onAnimationStep(e._currentFrame),e._currentFrame===e._animationFrames&&(e._currentFrame=0,!1===e._loop&&(e.pauseTimeline(),void 0!==e._onAnimationEnd&&null!==e._onAnimationEnd&&e._onAnimationEnd()))),e.comp_renderer_nodes.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var o=0;o<e.linksObj.length;o++)e.linksObj[o].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var a=0;a<e.arrowsObj.length;a++)e.arrowsObj[a].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});e.comp_renderer_nodes.setArg("only2d",function(){return!0===e._only2d?1:0})}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.disableKernel(1),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(1,function(){e.procSelectedOrHover()}),this.comp_renderer_nodes.gpufG.disableGraphic(1),!0===this._enableFont&&(this.comp_renderer_nodesText.setGPUFor(this.comp_renderer_nodesText.gl,Object.create(t),{type:"GRAPHIC",name:"NODESTEXT_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.comp_renderer_nodesText.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU))),this.enableHov(-1),this.updateNodes(),this.updateLinks()}},{key:"mouseDown",value:function(){!1===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"mouseUp",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0});if(!0===this._enableFont&&this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),-1===this.selectedId){this.comp_renderer_nodes.setArg("idToDrag",function(){return-1});for(var r=0;r<this.linksObj.length;r++)this.linksObj[r].componentRenderer.setArg("idToDrag",function(){return-1});for(var n=0;n<this.arrowsObj.length;n++)this.arrowsObj[n].componentRenderer.setArg("idToDrag",function(){return-1});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToDrag",function(){return-1})}!0===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"procSelectedOrHover",value:function(){if(!1===this._enableHover)!0===this.readPixel&&(this.readPixel=!1,this.readPix(),this.comp_renderer_nodes.gpufG.disableGraphic(1));else{var e=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!0===e.isLeftBtnActive()&&(this.readPixel=!1),this.readPix(),!0===e.isLeftBtnActive()&&this.comp_renderer_nodes.gpufG.disableGraphic(1)}}},{key:"readPix",value:function(){var e=new Uint8Array(4),t=this._sce.getEvents().getMousePosition();this._gl.readPixels(t.x,this._sce.getCanvas().height-t.y,1,1,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);var r=this._utils.unpack([e[0]/255,e[1]/255,e[2]/255,e[3]/255]);if(this.selectedId=Math.round(1e6*r)-1,-1!==this.selectedId&&this.selectedId<this.currentNodeId){var n=this._nodesById[this.selectedId];void 0!==n&&null!==n&&void 0!==n.onmousedown&&null!==n.onmousedown&&n.onmousedown(n),void 0!==n&&null!==n&&void 0!==this._onClickNode&&null!==this._onClickNode&&this._onClickNode(n);var o=this.comp_renderer_nodes.gpufG.readArg("posXYZW"),a=o[4*this._nodesById[this.selectedId].itemStart],i=o[4*this._nodesById[this.selectedId].itemStart+1],s=o[4*this._nodesById[this.selectedId].itemStart+2];this._initialPosDrag=$V3([a,i,s]),this.makeDrag(null,$V3([0,0,0]))}}},{key:"makeDrag",value:function(e,t){var r=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!1===this._enableHover?!0===r.isLeftBtnActive()&&(-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):!0===r.isLeftBtnActive()?(this.enableHov(-1),-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):this.enableHov(this.selectedId)}},{key:"enableHov",value:function(e){this.comp_renderer_nodes.setArg("idToHover",function(){return e});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg("idToHover",function(){return e});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg("idToHover",function(){return e});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToHover",function(){return e})}},{key:"enableDrag",value:function(e,t){var r=this,n=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION),o=this._initialPosDrag.add(t.x(2*n.getFov()/this._sce.getCanvas().width));this.comp_renderer_nodes.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodes.setArg("idToDrag",function(){return e}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodes.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodes.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodes.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.setArg("enableDrag",function(){return 1}),this.linksObj[a].componentRenderer.setArg("idToDrag",function(){return e}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.linksObj[a].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.linksObj[a].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.linksObj[a].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.setArg("enableDrag",function(){return 1}),this.arrowsObj[i].componentRenderer.setArg("idToDrag",function(){return e}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.arrowsObj[i].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.arrowsObj[i].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.arrowsObj[i].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return e}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodesText.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodesText.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodesText.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]}))}},{key:"disableDrag",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodes.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("idToDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("idToDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return 0}))}},{key:"enableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!0,this.disableAutoLink(),this.applyLayout({argsDirection:"float4* dest,float* enableDestination",codeDirection:"if(enableDestination[x] == 1.0) {\n                    vec3 destinationPos = dest[x].xyz;\n                    vec3 dirDestination = normalize(destinationPos-currentPos);\n                    float distan = abs(distance(currentPos,destinationPos));\n                    float dirDestWeight = sqrt(distan);\n                    currentDir = (currentDir+(dirDestination*dirDestWeight))*dirDestWeight*0.1;\n                }",argsObject:"float4*attr nodeColor",codeObject:"if(isArrow == 1.0 && currentLineVertex == 1.0) nodeVertexColor = vec4(0.3, 0.2, 0.2, 1.0);if(isArrow == 1.0 && currentLineVertex == 0.0) nodeVertexColor = vec4(1.0, 0.0, 0.0, 0.0);"})}},{key:"disableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!1}},{key:"addNeuron",value:function(e,t){var r=[1e3*Math.random()-500,1e3*Math.random()-500,1e3*Math.random()-500,1],n=void 0!==t&&null!==t?t:[0,0,0,1],o=void 0!==t&&null!==t?1:0;this.addNode({name:e,data:e,label:e.toString(),position:r,color:"../_RESOURCES/white.jpg",layoutNodeArgumentData:{nodeColor:[1,1,1,1],enableDestination:o,dest:n},onmouseup:function(e){}})}},{key:"addAfferentNeuron",value:function(e,t){this.afferentNeuron.push(e),this.addNeuron(e,t)}},{key:"addEfferentNeuron",value:function(e,t){this.efferentNeuron.push(e),this.addNeuron(e,t)}},{key:"createNeuronLayer",value:function(e,t,r,n){for(var o=[],a=0;a<e;a++)for(var i=0;i<t;i++){var s=[r[0]+(a-e/2)*n,r[1],r[2]+(i-t/2)*n,r[3]];this.addNeuron(this.currHiddenNeuron.toString(),s),o.push(this.currHiddenNeuron),this.currHiddenNeuron++}return o}},{key:"createXYNeuronsFromImage",value:function(e){for(var t=[],r=0;r<e.w;r++)for(var n=0;n<e.h;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.neuron+r+"_"+n,o),t.push(e.neuron+r+"_"+n)}return t}},{key:"createConvXYNeuronsFromXYNeurons",value:function(e){for(var t=[],r=0;r<e.w-2;r++)for(var n=0;n<e.h-2;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.idTarget+r+"_"+n,o),t.push(e.idTarget+r+"_"+n);for(var a=0,i=r;i<r+3;i++)for(var s=n;s<n+3;s++)this.addSinapsis({neuronNameA:e.idOrigin+i+"_"+s,neuronNameB:e.idTarget+r+"_"+n,activationFunc:e.activationFunc,multiplier:e.convMatrix[a],layerNum:0}),a++}return t}},{key:"addSinapsis",value:function(e){var t=this,r=function e(){if(!0===t.return_v)return t.return_v=!1,t.v_val;var r=2*Math.random()-1,n=2*Math.random()-1,o=r*r+n*n;if(0===o||o>1)return e();var a=Math.sqrt(-2*Math.log(o)/o);return t.v_val=n*a,t.return_v=!0,r*a},n=Math.sqrt(.02),o=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,a=void 0!==e.weight&&null!==e.weight?e.weight:function(e,t){return e+r()*t}(0,n),i=void 0!==e.multiplier&&null!==e.multiplier?e.multiplier:1;this.addLink({origin:e.neuronNameA,target:e.neuronNameB,directed:!0,showArrow:!1,activationFunc:o,weight:a,linkMultiplier:i,layerNum:e.layerNum})}},{key:"connectNeuronWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuron.toString(),neuronNameB:e.neuronLayer[t].toString(),activationFunc:e.activationFunc,weight:e.weight,multiplier:e.multiplier,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuron",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuronLayer[t].toString(),neuronNameB:e.neuron,activationFunc:1,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayerOrigin.length;t++){var r=e.neuronLayerOrigin[t];this.connectNeuronWithNeuronLayer({neuron:r.toString(),neuronLayer:e.neuronLayerTarget,layerNum:e.layerNum})}}},{key:"forward",value:function(e){var t=this;this.onAction=e.onAction;for(var r=e.state.slice(0),n=e.state.length;n<this.afferentNodesCount;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.afferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("afferentNodes"+o[a++],function(){return r.slice(e,e+t.afferentNodesCount)})}(i);for(var u=0;u<this.layerCount;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this._sce.getLoadedProject().getActiveStage().tick(),null!==this.onAction){for(var l=[["dataB",2],["dataF",0],["dataF",2],["dataG",0],["dataG",2],["dataH",0],["dataH",2]],d=[[]],c=0,h=0;h<this.efferentNodesCount*this.batch_size;h++){d[c].length===this.efferentNodesCount&&(d.push([]),c++);var f=this.getNeuronOutput(this.efferentNeuron[d[c].length],l[c]);isNaN(f[2]),d[c].push({output:f[l[c][1]]})}this.onAction(d)}}},{key:"train",value:function(e){var t=this;this.onTrained=e.onTrained;for(var r=e.arrReward.slice(0),n=e.arrReward.length;n<this.efferentNodesCount*this.batch_size;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.efferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("efferentNodes"+o[a++],function(){return r.slice(e,e+t.efferentNodesCount)})}(i);for(var u=0;u<this.layerCount-1;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this.comp_renderer_nodes.gpufG.enableKernel(1),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return 10}),this._sce.getLoadedProject().getActiveStage().tick(),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return-3}),this.comp_renderer_nodes.gpufG.disableKernel(1),null!==this.onTrained){for(var l=[],d=0;d<this.efferentNodesCount;d++);this.onTrained(l)}}},{key:"getNeuronOutput",value:function(e,t){var r=this.comp_renderer_nodes.gpufG.readArg(t[0]),n=4*this._nodesByName[e].itemStart;return[r[n],r[n+1],r[n+2],r[n+3]]}},{key:"setLayoutArgumentData",value:function(e){this._customArgs[e.argName].nodes_array_value=e.value,this._customArgs[e.argName].links_array_value=e.value,this._customArgs[e.argName].arrows_array_value=e.value,this._customArgs[e.argName].nodestext_array_value=e.value,this.comp_renderer_nodes.setArg(e.argName,function(){return e.value});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg(e.argName,function(){return e.value});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg(e.argName,function(){return e.value});!0===this._enableFont&&this.comp_renderer_nodesText.setArg(e.argName,function(){return e.value})}},{key:"getLayoutNodeArgumentData",value:function(e){for(var t=this._nodesByName[e.nodeName],r=this._customArgs[e.argName].arg.split("*")[0],n=0;n<this.arrayNodeData.length/4;n++)if(void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*n]===t.nodeId){var o=this._customArgs[e.argName].nodes_array_value;if("float"===r){var a=n;if(void 0!==o[a]&&null!==o[a])return o[a]}else{var i=4*n;if(void 0!==o[i]&&null!==o[i])return[o[i],o[i+1],o[i+2],o[i+3]]}}}},{key:"setLayoutNodeArgumentData",value:function(e){for(var t=this,r=this._nodesByName[e.nodeName],n=this._customArgs[e.argName].arg.split("*")[0],o=function(e,r,n,o,a){if("float"===e)t._customArgs[r][n][o]=a;else{var i=4*o;t._customArgs[r][n][i]=a[0],t._customArgs[r][n][i+1]=a[1],t._customArgs[r][n][i+2]=a[2],t._customArgs[r][n][i+3]=a[3]}},a=0;a<this.arrayNodeData.length/4;a++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*a]===r.nodeId)o(n,e.argName,"nodes_array_value",a,e.value);else{var i="float"===n?a:4*a;void 0===this._customArgs[e.argName].nodes_array_value[i]&&null===this._customArgs[e.argName].nodes_array_value[i]&&!1===e.update&&("float"===n?o(n,e.argName,"nodes_array_value",a,0):o(n,e.argName,"nodes_array_value",a,[0,0,0,0]))}this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value});for(var s=0;s<this.linksObj.length;s++){for(var u=0;u<this.linksObj[s].arrayLinkData.length/4;u++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.linksObj[s].arrayLinkData[4*u]===r.nodeId)o(n,e.argName,"links_array_value",u,e.value);else{var l="float"===n?u:4*u;void 0===this._customArgs[e.argName].links_array_value[l]&&null===this._customArgs[e.argName].links_array_value[l]&&!1===e.update&&("float"===n?o(n,e.argName,"links_array_value",u,0):o(n,e.argName,"links_array_value",u,[0,0,0,0]))}this.linksObj[s].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}for(var d=0;d<this.arrowsObj.length;d++){for(var c=0;c<this.arrowsObj[d].arrayArrowData.length/4;c++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrowsObj[d].arrayArrowData[4*c]===r.nodeId)o(n,e.argName,"arrows_array_value",c,e.value);else{var h="float"===n?c:4*c;void 0===this._customArgs[e.argName].arrows_array_value[h]&&null===this._customArgs[e.argName].arrows_array_value[h]&&!1===e.update&&("float"===n?o(n,e.argName,"arrows_array_value",c,0):o(n,e.argName,"arrows_array_value",c,[0,0,0,0]))}this.arrowsObj[d].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){for(var f=0;f<this.arrayNodeTextData.length/4;f++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeTextData[4*f]===r.nodeId)o(n,e.argName,"nodestext_array_value",f,e.value);else{var p="float"===n?f:4*f;void 0===this._customArgs[e.argName].nodestext_array_value[p]&&null===this._customArgs[e.argName].nodestext_array_value[p]&&!1===e.update&&("float"===n?o(n,e.argName,"nodestext_array_value",f,0):o(n,e.argName,"nodestext_array_value",f,[0,0,0,0]))}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"setLayoutNodeArgumentArrayData",value:function(e){var t=this,r=this._customArgs[e.argName].arg.split("*")[0],n=-1,o=0,a=0,i=0,s=0;this._customArgs[e.argName].nodes_array_value=[];for(var u=0;u<this.arrayNodeData.length/4;u++)n!==this.arrayNodeData[4*u]?(n=this.arrayNodeData[4*u],"float"===r?(o=e.value[n],this._customArgs[e.argName].nodes_array_value.push(o)):(o=e.value[4*n],a=e.value[4*n+1],i=e.value[4*n+2],s=e.value[4*n+3],this._customArgs[e.argName].nodes_array_value.push(o,a,i,s))):"float"===r?this._customArgs[e.argName].nodes_array_value.push(o):this._customArgs[e.argName].nodes_array_value.push(o,a,i,s);this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value}),this._customArgs[e.argName].links_array_value=[];for(var l=0;l<this.linksObj.length;l++){for(var d=0;d<this.linksObj[l].arrayLinkNodeName.length;d++){var c=this.linksObj[l].arrayLinkNodeName[d],h=this._nodesByName[c].itemStart;"float"===r?this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[h]):this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[4*h],this._customArgs[e.argName].nodes_array_value[4*h+1],this._customArgs[e.argName].nodes_array_value[4*h+2],this._customArgs[e.argName].nodes_array_value[4*h+3])}this.linksObj[l].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}this._customArgs[e.argName].arrows_array_value=[];for(var f=0;f<this.arrowsObj.length;f++){for(var p=0;p<this.arrowsObj[f].arrayArrowNodeName.length;p++){var m=this.arrowsObj[f].arrayArrowNodeName[p],g=this._nodesByName[m].itemStart;"float"===r?this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[g]):this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[4*g],this._customArgs[e.argName].nodes_array_value[4*g+1],this._customArgs[e.argName].nodes_array_value[4*g+2],this._customArgs[e.argName].nodes_array_value[4*g+3])}this.arrowsObj[f].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){this._customArgs[e.argName].nodestext_array_value=[];for(var _=0;_<this.arrayNodeTextNodeName.length;_++){var v=this.arrayNodeTextNodeName[_],x=this._nodesByName[v].itemStart;"float"===r?this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[x]):this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[4*x],this._customArgs[e.argName].nodes_array_value[4*x+1],this._customArgs[e.argName].nodes_array_value[4*x+2],this._customArgs[e.argName].nodes_array_value[4*x+3])}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"addNode",value:function(e){if(!1===this._nodesByName.hasOwnProperty(e.name)){var t=this.createNode(e);return this._nodesByName[e.name]=t,this._nodesById[t.nodeId]=t,void 0!==t.label&&null!==t.label&&!0===this._enableFont&&this.createNodeText(t),console.log("%cnode "+Object.keys(this._nodesByName).length+" ("+e.name+")","color:green"),e.name}return console.log("node "+e.name+" already exists"),!1}},{key:"createNode",value:function(e){var t=this.nodeArrayItemStart,r=void 0!==e.position&&null!==e.position?e.position:[100*Math.random()-50,100*Math.random()-50,100*Math.random()-50,1],n=e.color,o=-1;if(void 0!==n&&null!==n&&n.constructor===String){if(!1===this.objNodeImages.hasOwnProperty(n)){var a=Object.keys(this.objNodeImages).length;this.objNodeImages[n]=a,this.addNodesImage(n,a)}o=this.objNodeImages[n]}for(var i=0;i<this.mesh_nodes.vertexArray.length/4;i++){var s=4*i,u=this.getBornDieTS(e.bornDate,e.dieDate);if(this.arrayNodeData.push(this.currentNodeId,0,u.bornDate,u.dieDate),this.arrayNodeDataB.push(u.bornDate,u.dieDate,0,0),this.arrayNodeDataF.push(0,0,0,0),this.arrayNodeDataG.push(0,0,0,0),this.arrayNodeDataH.push(0,0,0,0),this.arrayNodePosXYZW.push(r[0],r[1],r[2],r[3]),this.arrayNodeDir.push(0,0,0,1),this.arrayNodeVertexPos.push(this.mesh_nodes.vertexArray[s],this.mesh_nodes.vertexArray[s+1],this.mesh_nodes.vertexArray[s+2],1),this.arrayNodeVertexNormal.push(this.mesh_nodes.normalArray[s],this.mesh_nodes.normalArray[s+1],this.mesh_nodes.normalArray[s+2],1),this.arrayNodeVertexTexture.push(this.mesh_nodes.textureArray[s],this.mesh_nodes.textureArray[s+1],this.mesh_nodes.textureArray[s+2],1),this.arrayNodeImgId.push(o),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var l in this._customArgs){var d=this._customArgs[l].arg.split("*");d.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(l)&&void 0!==e.layoutNodeArgumentData[l]&&null!==e.layoutNodeArgumentData[l]&&("float"===d[0]?this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l]):"float4"===d[0]&&this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l][0],e.layoutNodeArgumentData[l][1],e.layoutNodeArgumentData[l][2],e.layoutNodeArgumentData[l][3]))}this.nodeArrayItemStart++}for(var c=0,h=0;h<this.mesh_nodes.indexArray.length;h++){var f=h;this.arrayNodeIndices.push(this.startIndexId+this.mesh_nodes.indexArray[f]),this.mesh_nodes.indexArray[f]>c&&(c=this.mesh_nodes.indexArray[f])}return this.startIndexId+=c+1,e.nodeId=this.currentNodeId++,e.itemStart=t,e}},{key:"createNodeText",value:function(e){for(var t=function(e){return{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,"Ñ":14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26," ":27,0:28,1:29,2:30,3:31,4:32,5:33,6:34,7:35,8:36,9:37}[e]},r=0;r<this.nodesTextPlanes;r++){var n=null;void 0!==e.label&&null!==e.label&&void 0!==e.label[r]&&null!==e.label[r]&&(n=t(e.label[r].toUpperCase())),null===n&&(n=t(" "));for(var o=0;o<this.mesh_nodesText.vertexArray.length/4;o++){var a=4*o;if(this.arrayNodeTextData.push(e.nodeId,0,0,0),this.arrayNodeTextPosXYZW.push(0,0,0,1),this.arrayNodeTextVertexPos.push(this.mesh_nodesText.vertexArray[a]+5*r,this.mesh_nodesText.vertexArray[a+1],this.mesh_nodesText.vertexArray[a+2],1),this.arrayNodeTextVertexNormal.push(this.mesh_nodesText.normalArray[a],this.mesh_nodesText.normalArray[a+1],this.mesh_nodesText.normalArray[a+2],1),this.arrayNodeTextVertexTexture.push(this.mesh_nodesText.textureArray[a],this.mesh_nodesText.textureArray[a+1],this.mesh_nodesText.textureArray[a+2],1),this.arrayNodeTextNodeName.push(e.name),this.arrayNodeText_itemStart.push(e.itemStart),this.arrayNodeTextLetterId.push(n),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.layoutNodeArgumentData[i]&&null!==e.layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i][0],e.layoutNodeArgumentData[i][1],e.layoutNodeArgumentData[i][2],e.layoutNodeArgumentData[i][3]))}this.nodeTextArrayItemStart++}}for(var u=0,l=0;l<this.nodesTextPlanes;l++)for(var d=0;d<this.mesh_nodesText.indexArray.length;d++){var c=d,h=4*l,f=this.mesh_nodesText.indexArray[c]+h;this.arrayNodeTextIndices.push(this.startIndexId_nodestext+f),f>u&&(u=f)}this.startIndexId_nodestext+=u+1,this.currentNodeTextId++}},{key:"addNodesImage",value:function(e,t){this._stackNodesImg.push({url:e,locationIdx:t})}},{key:"generateNodesImage",value:function(){var e=this;!1===this.nodesImgMaskLoaded?(this.nodesImgMask=new Image,this.nodesImgMask.onload=function(){e.nodesImgMaskLoaded=!0,e.generateNodesImage()},this.nodesImgMask.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgMask.png"):!1===this.nodesImgCrosshairLoaded?(this.nodesImgCrosshair=new Image,this.nodesImgCrosshair.onload=function(){e.nodesImgCrosshairLoaded=!0,e.generateNodesImage()},this.nodesImgCrosshair.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgCrosshair.png"):new c.ProccessImg({stackNodesImg:this._stackNodesImg,NODE_IMG_WIDTH:this.NODE_IMG_WIDTH,NODE_IMG_COLUMNS:this.NODE_IMG_COLUMNS,nodesImgMask:this.nodesImgMask,nodesImgCrosshair:this.nodesImgCrosshair,onend:function(t){e.comp_renderer_nodes.setArg("nodesImg",function(){return t.nodesImg}),e.comp_renderer_nodes.setArg("nodesImgCrosshair",function(){return t.nodesImgCrosshair})}})}},{key:"addLink",value:function(e){var t=!0;if(void 0===this._nodesByName[e.origin]&&null===this._nodesByName[e.origin]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.origin+" not exists","color:red"),t=!1),void 0===this._nodesByName[e.target]&&null===this._nodesByName[e.target]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.target+" not exists","color:red"),t=!1),e.origin===e.target&&!1===this._enableAutoLink&&(console.log("%cDiscarting autolink "+e.origin+"->"+e.target,"color:orange"),t=!1),!0===t){console.log("%clink "+e.origin+"->"+e.target,"color:green"),e.origin_nodeName=e.origin.toString(),e.target_nodeName=e.target.toString(),e.origin_nodeId=this._nodesByName[e.origin].nodeId,e.target_nodeId=this._nodesByName[e.target].nodeId,e.origin_itemStart=this._nodesByName[e.origin].itemStart,e.target_itemStart=this._nodesByName[e.target].itemStart,e.origin_layoutNodeArgumentData=this._nodesByName[e.origin].layoutNodeArgumentData,e.target_layoutNodeArgumentData=this._nodesByName[e.target].layoutNodeArgumentData;var r=this.getBornDieTS(e.bornDate,e.dieDate);e.bornDate=r.bornDate,e.dieDate=r.dieDate,e.activationFunc=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,e.weight=void 0!==e.weight&&null!==e.weight&&e.weight.constructor===String?Math.random():e.weight||1,e.linkMultiplier=void 0!==e.linkMultiplier&&null!==e.linkMultiplier?e.linkMultiplier:1;for(var n=1;;){if(!0!==(this._links.hasOwnProperty(e.origin+"->"+e.target+"_"+n)||this._links.hasOwnProperty(e.target+"->"+e.origin+"_"+n)))break;n++}e.repeatId=n,void 0!==(e=this.createLink(e)).directed&&null!==e.directed&&!0===e.directed&&(void 0!==e.showArrow&&null!==e.showArrow&&!1===e.showArrow||this.createArrow(e)),this._links[e.origin+"->"+e.target+"_"+n]=e;for(var o=0;o<this.arrayNodeData.length/4;o++){var a=4*o;this.arrayNodeData[a]===this._nodesByName[e.origin].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1),this.arrayNodeData[a]===this._nodesByName[e.target].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1)}}}},{key:"createLink",value:function(e){this.currentLinkId%6e4==0&&this.createLinksObjItem();for(var t=0;t<2*this.lineVertexCount;t++)if(this.linksObj[this.currentLinksObjItem].arrayLinkData.push(e.origin_nodeId,e.target_nodeId,Math.ceil(t/2),e.repeatId),this.linksObj[this.currentLinksObjItem].arrayLinkDataC.push(e.bornDate,e.dieDate,e.weight,0),Math.ceil(t/2)!==this.lineVertexCount-1?this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.origin_nodeName):this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.target_nodeName),this.linksObj[this.currentLinksObjItem].arrayLinkPosXYZW.push(0,0,0,1),this.linksObj[this.currentLinksObjItem].arrayLinkVertexPos.push(0,0,0,1),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var r in this._customArgs){var n=this._customArgs[r].arg.split("*");n.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(r)&&void 0!==e.origin_layoutNodeArgumentData[r]&&null!==e.origin_layoutNodeArgumentData[r]&&("float"===n[0]?this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r]):"float4"===n[0]&&this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r][0],e.origin_layoutNodeArgumentData[r][1],e.origin_layoutNodeArgumentData[r][2],e.origin_layoutNodeArgumentData[r][3]))}for(var o=0;o<2*this.lineVertexCount;o++)this.linksObj[this.currentLinksObjItem].arrayLinkIndices.push(this.linksObj[this.currentLinksObjItem].startIndexId_link++);return this.currentLinkId+=2,e.linkId=this.currentLinkId-2,e}},{key:"createArrow",value:function(e){this.currentArrowId%2e4==0&&this.createArrowsObjItem(),void 0!==e&&null!==e&&void 0!==e.node&&null!==e.node&&(this.mesh_arrows=e.node);for(var t=0;t<2;t++){for(var r=0;r<this.mesh_arrows.vertexArray.length/4;r++){var n=4*r;if(0===t&&this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart,this.arrowsObj[this.currentArrowsObjItem].arrayArrowPosXYZW.push(0,0,0,1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexPos.push(this.mesh_arrows.vertexArray[n],this.mesh_arrows.vertexArray[n+1],this.mesh_arrows.vertexArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexNormal.push(this.mesh_arrows.normalArray[n],this.mesh_arrows.normalArray[n+1],this.mesh_arrows.normalArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexTexture.push(this.mesh_arrows.textureArray[n],this.mesh_arrows.textureArray[n+1],this.mesh_arrows.textureArray[n+2],1),0===t){if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.origin_nodeId,e.target_nodeId,0,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.origin_nodeName),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var o in this._customArgs){var a=this._customArgs[o].arg.split("*");a.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(o)&&void 0!==e.origin_layoutNodeArgumentData[o]&&null!==e.origin_layoutNodeArgumentData[o]&&("float"===a[0]?this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o]):"float4"===a[0]&&this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o][0],e.origin_layoutNodeArgumentData[o][1],e.origin_layoutNodeArgumentData[o][2],e.origin_layoutNodeArgumentData[o][3]))}}else if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.target_nodeId,e.origin_nodeId,1,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.target_nodeName),void 0!==e.target_layoutNodeArgumentData&&null!==e.target_layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.target_layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.target_layoutNodeArgumentData[i]&&null!==e.target_layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i][0],e.target_layoutNodeArgumentData[i][1],e.target_layoutNodeArgumentData[i][2],e.target_layoutNodeArgumentData[i][3]))}this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart++}for(var u=0,l=0;l<this.mesh_arrows.indexArray.length;l++){var d=l;this.arrowsObj[this.currentArrowsObjItem].arrayArrowIndices.push(this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+this.mesh_arrows.indexArray[d]),this.mesh_arrows.indexArray[d]>u&&(u=this.mesh_arrows.indexArray[d])}this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+=u+1,this.currentArrowId++}}},{key:"updateNodes",value:function(){var e=this;console.log(this.currentNodeId+" nodes"),this._ADJ_MATRIX_WIDTH=this._MAX_ADJ_MATRIX_WIDTH,this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var n=0;n<this.linksObj.length;n++)this.linksObj[n].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);for(var o=0;o<this.arrowsObj.length;o++)this.arrowsObj[o].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var s=0;s<this.linksObj.length;s++)this.linksObj[s].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var u=0;u<this.arrowsObj.length;u++)this.arrowsObj[u].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData}),this.comp_renderer_nodes.setArg("dataB",function(){return e.arrayNodeDataB}),this.comp_renderer_nodes.setArg("dataF",function(){return e.arrayNodeDataF}),this.comp_renderer_nodes.setArg("dataG",function(){return e.arrayNodeDataG}),this.comp_renderer_nodes.setArg("dataH",function(){return e.arrayNodeDataH}),void 0!==this.comp_renderer_nodes.getBuffers().posXYZW&&null!==this.comp_renderer_nodes.getBuffers().posXYZW&&(this.arrayNodePosXYZW=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("posXYZW"))),this.comp_renderer_nodes.setArg("posXYZW",function(){return e.arrayNodePosXYZW}),this.comp_renderer_nodes.setArg("nodeVertexPos",function(){return e.arrayNodeVertexPos}),this.comp_renderer_nodes.setArg("nodeVertexNormal",function(){return e.arrayNodeVertexNormal}),this.comp_renderer_nodes.setArg("nodeVertexTexture",function(){return e.arrayNodeVertexTexture}),this.comp_renderer_nodes.setArg("nodesCount",function(){return e.currentNodeId}),this._MAX_ADJ_MATRIX_WIDTH=this.currentNodeId,this.comp_renderer_nodes.setArg("nodeImgColumns",function(){return e.NODE_IMG_COLUMNS}),this.comp_renderer_nodes.setArg("nodeImgId",function(){return e.arrayNodeImgId}),this.comp_renderer_nodes.setArg("indices",function(){return e.arrayNodeIndices}),void 0!==this.comp_renderer_nodes.getBuffers().dir&&null!==this.comp_renderer_nodes.getBuffers().dir&&(this.arrayNodeDir=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("dir"))),this.comp_renderer_nodes.setArg("dir",function(){return e.arrayNodeDir}),this.comp_renderer_nodes.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodes.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodes.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return e.currentTrainLayer}),this.comp_renderer_nodes.setArg("afferentNodesCount",function(){return e.afferentNodesCount}),this.comp_renderer_nodes.setArg("efferentNodesCount",function(){return e.efferentNodesCount}),this.comp_renderer_nodes.setArg("efferentStart",function(){return e.currentNodeId-e.efferentNodesCount}),this.comp_renderer_nodes.setArg("afferentNodesA",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesA",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesB",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesB",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesC",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesC",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesD",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesD",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesE",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesE",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesF",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesF",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesG",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesG",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("isNode",function(){return 1}),this.comp_renderer_nodes.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W});for(var l in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodes.setArg(t,function(){return e._customArgs[t].nodes_array_value})}(l);this.generateNodesImage(),!0===this._enableFont&&this.updateNodesText()}},{key:"updateNodesText",value:function(){var e=this;this.comp_renderer_nodesText.setArg("data",function(){return e.arrayNodeTextData}),this.comp_renderer_nodesText.getComponentBufferArg("posXYZW",this.comp_renderer_nodes),this.comp_renderer_nodesText.setArg("nodeVertexPos",function(){return e.arrayNodeTextVertexPos}),this.comp_renderer_nodesText.setArg("nodeVertexNormal",function(){return e.arrayNodeTextVertexNormal}),this.comp_renderer_nodesText.setArg("nodeVertexTexture",function(){return e.arrayNodeTextVertexTexture}),this.comp_renderer_nodesText.setArg("fontImgColumns",function(){return e.FONT_IMG_COLUMNS}),this.comp_renderer_nodesText.setArg("letterId",function(){return e.arrayNodeTextLetterId}),this.comp_renderer_nodesText.setArg("indices",function(){return e.arrayNodeTextIndices}),this.comp_renderer_nodesText.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodesText.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodesText.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodesText.setArg("isNodeText",function(){return 1}),this.comp_renderer_nodesText.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),this.comp_renderer_nodesText.setArg("bufferTextsWidth",function(){return e.comp_renderer_nodesText.getBuffers().data.W});for(var t in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodesText.setArg(t,function(){return e._customArgs[t].nodestext_array_value})}(t)}},{key:"updateLinks",value:function(){var e=this;console.log(Object.keys(this._links).length+" links"),this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData});for(var t=0;t<this.linksObj.length;t++)!function(t){e.linksObj[t].componentRenderer.setArg("data",function(){return e.linksObj[t].arrayLinkData}),e.linksObj[t].componentRenderer.setArg("dataC",function(){return e.linksObj[t].arrayLinkDataC}),e.linksObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.linksObj[t].arrayLinkVertexPos}),e.linksObj[t].componentRenderer.setArg("indices",function(){return e.linksObj[t].arrayLinkIndices}),e.linksObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.linksObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.linksObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.linksObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.linksObj[t].componentRenderer.setArg("isLink",function(){return 1}),e.linksObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.linksObj[t].componentRenderer.setArg("bufferLinksWidth",function(){return e.linksObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.linksObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].links_array_value})}(r)}(t);this.updateArrows(),Object.keys(this._links).length>0&&this.updateAdjMat()}},{key:"updateArrows",value:function(){for(var e=this,t=0;t<this.arrowsObj.length;t++)!function(t){e.arrowsObj[t].componentRenderer.setArg("data",function(){return e.arrowsObj[t].arrayArrowData}),e.arrowsObj[t].componentRenderer.setArg("dataC",function(){return e.arrowsObj[t].arrayArrowDataC}),e.arrowsObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.arrowsObj[t].arrayArrowVertexPos}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexNormal",function(){return e.arrowsObj[t].arrayArrowVertexNormal}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexTexture",function(){return e.arrowsObj[t].arrayArrowVertexTexture}),e.arrowsObj[t].componentRenderer.setArg("indices",function(){return e.arrowsObj[t].arrayArrowIndices}),e.arrowsObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.arrowsObj[t].componentRenderer.setArg("isArrow",function(){return 1}),e.arrowsObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.arrowsObj[t].componentRenderer.setArg("bufferArrowsWidth",function(){return e.arrowsObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.arrowsObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].arrows_array_value})}(r)}(t)}},{key:"updateAdjMat",value:function(){var e=this,t=function(t,r,n,o,a,i,s,u,l,d){var c=4*r;e.arrAdjMatrix[c]=a,e.arrAdjMatrix[c+1]=i,e.arrAdjMatrix[c+2]=!0===t?e.disabVal:s,e.arrAdjMatrix[c+3]=!0===t?1:.5,e.arrAdjMatrixB[c]=u,e.arrAdjMatrixB[c+1]=l,e.arrAdjMatrixB[c+2]=n,e.arrAdjMatrixB[c+3]=o,e.arrAdjMatrixC[c]=0,e.arrAdjMatrixC[c+1]=d,e.arrAdjMatrixC[c+2]=0,e.arrAdjMatrixC[c+3]=0};this.arrAdjMatrix=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixB=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixC=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4);for(var r in this._links){var n=this._links[r].origin_nodeId,o=this._links[r].target_nodeId,a=o*this._ADJ_MATRIX_WIDTH+n,i=n*this._ADJ_MATRIX_WIDTH+o;t(!0,a,o,n,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,-99),t(!1,i,n,o,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,this._links[r].layerNum)}this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return e.arrAdjMatrix}),this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return e.arrAdjMatrixB}),this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return e.arrAdjMatrixC})}},{key:"adjacencyMatrixToImage",value:function(e,t,r){var n=this;!function(e,t,o){var a=Utils.getCanvasFromUint8Array(e,t,o);n._utils.getImageFromCanvas(a,function(e){r(e)})}(function(e){for(var t=new Uint8Array(4*e.length),r=0;r<e.length;r++){var n=4*r;t[n]=255*e[r],t[n+1]=255*e[r],t[n+2]=255*e[r],t[n+3]=255}return t}(e),t,t)}},{key:"enableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 1});this._enabledForceLayout=!0}},{key:"disableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 0});this._enabledForceLayout=!1}},{key:"enableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 1})}},{key:"disableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 0})}},{key:"enableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 1});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 1})}},{key:"disableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 0})}}],[{key:"datetimeToTimestamp",value:function(e){return Date.parse(e)}},{key:"timestampToDate",value:function(e){var t=new Date(e);return(t=t.toISOString().split("T")[0].split("-"))[2]+"/"+t[1]+"/"+t[0]}}]),e}();o.Graph=h,t.exports.Graph=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./KERNEL_ADJMATRIX_UPDATE.class":3,"./KERNEL_DIR.class":4,"./ProccessImg.class":5,"./VFP_NODE.class":6,"./VFP_NODEPICKDRAG.class":7,scejs:1}],3:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.KERNEL_ADJMATRIX_UPDATE=function(){function e(){n(this,e)}return o(e,null,[{key:"getSrc",value:function(e){return["x",["adjacencyMatrix"],"","vec4 adjMat = adjacencyMatrix[x]; \n            vec4 adjMatB = adjacencyMatrixB[x]; \n            vec4 adjMatC = adjacencyMatrixC[x]; \n\n            float linkBornDate = adjMat.x;\n            float linkDieDate = adjMat.y;\n            float linkWeight = adjMat.z;\n            float linkTypeParent = adjMat.w;\n\n            float id = adjMatB.z;\n            float idInv = adjMatB.w;\n            float linkLayerNum = adjMatC.y;\n\n           if(linkTypeParent == 0.5) {\n                vec2 xGeometryCurrentChild = get_global_id(id, bufferNodesWidth, "+e.toFixed(1)+");\n                vec2 xGeometryParent = get_global_id(idInv, bufferNodesWidth, "+e.toFixed(1)+");\n\n                float childGOutputA = dataB[xGeometryCurrentChild].z;\n                float parentGErrorA = dataB[xGeometryParent].w;\n                \n                float childGOutputB = dataF[xGeometryCurrentChild].x;\n                float parentGErrorB = dataF[xGeometryParent].y;\n                \n                float childGOutputC = dataF[xGeometryCurrentChild].z;\n                float parentGErrorC = dataF[xGeometryParent].w;\n                \n                float childGOutputD = dataG[xGeometryCurrentChild].x;\n                float parentGErrorD = dataG[xGeometryParent].y;\n                \n                float childGOutputE = dataG[xGeometryCurrentChild].z;\n                float parentGErrorE = dataG[xGeometryParent].w;\n                \n                float childGOutputF = dataH[xGeometryCurrentChild].x;\n                float parentGErrorF = dataH[xGeometryParent].y;\n                \n                float childGOutputG = dataH[xGeometryCurrentChild].z;\n                float parentGErrorG = dataH[xGeometryParent].w;                \n            \n                if(linkLayerNum > 0.0) {                        \n                    float learningRate = 0.01;\n                    float l2_decay = 0.01;\n                    float cpu_batch_repeats = 7.0;\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputA*parentGErrorA))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputB*parentGErrorB))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputC*parentGErrorC))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputD*parentGErrorD))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputE*parentGErrorE))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputF*parentGErrorF))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputG*parentGErrorG))/(7.0*cpu_batch_repeats));\n                }\n            }\n            \n            return [vec4(linkBornDate, linkDieDate, linkWeight, linkTypeParent)];\n            "]}}]),e}();e.KERNEL_ADJMATRIX_UPDATE=a,t.exports.KERNEL_ADJMATRIX_UPDATE=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.KERNEL_DIR=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("./graphUtil"),s=r.KERNEL_DIR=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t,r,n,o){var a=null,s=null;return!0===o?(a=["dir","posXYZW","dataB","dataF","dataG","dataH"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0), currentDataB, currentDataF, currentDataG, currentDataH];"):(a=["dir","posXYZW"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0)];"),["x",a,i.GraphUtils.adjMatrix_ForceLayout_GLSLFunctionString(t,r,n),"float nodeId = data[x].x;\n                    float numOfConnections = data[x].y;\n                    vec2 xGeometry = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n\n\n                    vec3 currentPos = posXYZW[xGeometry].xyz;\n\n                    float bornDate = dataB[xGeometry].x;\n                    float dieDate = dataB[xGeometry].y;\n\n                    vec3 currentDir = dir[xGeometry].xyz;\n\n\n                    vec4 currentDataB = dataB[xGeometry];\n                    vec4 currentDataF = dataF[xGeometry];\n                    vec4 currentDataG = dataG[xGeometry];\n                    vec4 currentDataH = dataH[xGeometry];\n\n                    currentDir = vec3(0.0, 0.0, 0.0);\n\n                    if(enableForceLayout == 1.0) {\n                        idAdjMatrixResponse adjM = idAdjMatrix_ForceLayout(nodeId, currentPos, currentDir, numOfConnections, currentTimestamp, bornDate, dieDate, enableNeuronalNetwork);\n                        currentDir = (adjM.collisionExists == 1.0) ? adjM.force : currentDir+(adjM.force*1.0);\n\n                        if(enableNeuronalNetwork == 1.0 && currentTrainLayer == -3.0) {\n                            currentDataB = vec4(currentDataB.x, currentDataB.y, adjM.netFOutputA, adjM.netErrorWeightA);\n                            currentDataF = vec4(adjM.netFOutputB, adjM.netErrorWeightB, adjM.netFOutputC, adjM.netErrorWeightC);\n                            currentDataG = vec4(adjM.netFOutputD, adjM.netErrorWeightD, adjM.netFOutputE, adjM.netErrorWeightE);\n                            currentDataH = vec4(adjM.netFOutputF, adjM.netErrorWeightF, adjM.netFOutputG, adjM.netErrorWeightG);\n                        }\n                    }\n\n                    "+(void 0!==e?e:"")+"\n\n                    if(enableDrag == 1.0) {\n                        if(nodeId == idToDrag) {\n                            currentPos = vec3(MouseDragTranslationX, MouseDragTranslationY, MouseDragTranslationZ);\n                        }\n                    }\n\n                    currentPos += currentDir;\n                    if(only2d == 1.0) {\n                        currentPos.y = 0.0;\n                    }\n\n                    "+s]}}]),e}();n.KERNEL_DIR=s,t.exports.KERNEL_DIR=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":10}],5:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ProccessImg=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.ProccessImg=function(){function e(t){o(this,e),this.stackNodesImg=t.stackNodesImg,this.drawedImages=0,this.output={nodesImg:null,nodesImgCrosshair:null};var r=t.NODE_IMG_WIDTH;this.NODE_IMG_COLUMNS=t.NODE_IMG_COLUMNS,this.NODE_IMG_SPRITE_WIDTH=r/this.NODE_IMG_COLUMNS;var n=t.nodesImgMask;this.datMask=Utils.getUint8ArrayFromHTMLImageElement(n);var a=t.nodesImgCrosshair;this.datCrosshair=Utils.getUint8ArrayFromHTMLImageElement(a),this.canvasNodeImg=document.createElement("canvas"),this.canvasNodeImg.width=r,this.canvasNodeImg.height=r,this.ctxNodeImg=this.canvasNodeImg.getContext("2d"),this.canvasNodeImgCrosshair=document.createElement("canvas"),this.canvasNodeImgCrosshair.width=r,this.canvasNodeImgCrosshair.height=r,this.ctxNodeImgCrosshair=this.canvasNodeImgCrosshair.getContext("2d");var i=document.createElement("canvas");i.width=this.NODE_IMG_SPRITE_WIDTH,i.height=this.NODE_IMG_SPRITE_WIDTH;for(var s=i.getContext("2d"),u=0;u<this.stackNodesImg.length;u++){var l=this.stackNodesImg[u],d=new Image;d.onload=function(e,r){s.clearRect(0,0,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH);var n=this.NODE_IMG_SPRITE_WIDTH/4;s.drawImage(e,0,0,e.width,e.height,n,n,this.NODE_IMG_SPRITE_WIDTH/2,this.NODE_IMG_SPRITE_WIDTH/2),(new Utils).getImageFromCanvas(i,function(e,r){e.image=Utils.getUint8ArrayFromHTMLImageElement(r);for(var n=!0,o=0;o<this.stackNodesImg.length;o++)if(null==this.stackNodesImg[o].image){n=!1;break}!0===n&&this.generateAll(t)}.bind(this,r))}.bind(this,d,l),d.src=l.url}}return a(e,[{key:"generateAll",value:function(e){for(var t=function(t,r,n){var o=this,a=function(e,t){var r=e/t,n=parseFloat(parseInt(r));return{col:Utils.fract(r)*t,row:n}}.bind(this),i=function(e){var t=function(e,t,r){this.output[t]=r,null!=this.output.nodesImg&&null!=this.output.nodesImgCrosshair&&e(this.output)}.bind(this,e);(new Utils).getImageFromCanvas(this.canvasNodeImg,function(e){t("nodesImg",e)}.bind(this)),(new Utils).getImageFromCanvas(this.canvasNodeImgCrosshair,function(e){t("nodesImgCrosshair",e)}.bind(this))}.bind(this,e.onend);(new Utils).getImageFromCanvas(Utils.getCanvasFromUint8Array(n,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH),function(e){var n=a(t.locationIdx,o.NODE_IMG_COLUMNS);r.drawImage(e,n.col*o.NODE_IMG_SPRITE_WIDTH,n.row*o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH),o.drawedImages++,o.drawedImages===2*o.stackNodesImg.length&&i()})}.bind(this),r=0;r<this.stackNodesImg.length;r++){for(var n=this.stackNodesImg[r],o=this.stackNodesImg[r].image,a=0;a<this.datMask.length/4;a++){var i=4*a;o[i+3]>0&&(o[i+3]=this.datMask[i+3])}t(n,this.ctxNodeImg,o);for(var s=0;s<this.datCrosshair.length/4;s++){var u=4*s;o[u]=(this.datCrosshair[u]*this.datCrosshair[u+3]+o[u]*(255-this.datCrosshair[u+3]))/255,o[u+1]=(this.datCrosshair[u+1]*this.datCrosshair[u+3]+o[u+1]*(255-this.datCrosshair[u+3]))/255,o[u+2]=(this.datCrosshair[u+2]*this.datCrosshair[u+3]+o[u+2]*(255-this.datCrosshair[u+3]))/255,o[u+3]=(this.datCrosshair[u+3]*this.datCrosshair[u+3]+o[u+3]*(255-this.datCrosshair[u+3]))/255}t(n,this.ctxNodeImgCrosshair,o)}}}]),e}();n.ProccessImg=i,t.exports.ProccessImg=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],6:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODE=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./graphUtil"),s=r.VFP_NODE=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t){return[["RGB"],"varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\nvec2 get2Dfrom1D(float idx, float columns) {float n = idx/columns;float row = float(int(n));float col = fract(n)*columns;float ts = 1.0/columns;return vec2(ts*col, ts*row);}mat4 lookAt(vec3 eye, vec3 center, vec3 up) {vec3 zaxis = normalize(center - eye);vec3 xaxis = normalize(cross(up, zaxis));vec3 yaxis = cross(zaxis, xaxis);mat4 matrix;matrix[0][0] = xaxis.x;matrix[1][0] = yaxis.x;matrix[2][0] = zaxis.x;matrix[3][0] = 0.0;matrix[0][1] = xaxis.y;matrix[1][1] = yaxis.y;matrix[2][1] = zaxis.y;matrix[3][1] = 0.0;matrix[0][2] = xaxis.z;matrix[1][2] = yaxis.z;matrix[2][2] = zaxis.z;matrix[3][2] = 0.0;matrix[0][3] = -dot(xaxis, eye);matrix[1][3] = -dot(yaxis, eye);matrix[2][3] = -dot(zaxis, eye);matrix[3][3] = 1.0;return matrix;}mat4 transpose(mat4 m) {return mat4(  m[0][0], m[1][0], m[2][0], m[3][0],m[0][1], m[1][1], m[2][1], m[3][1],m[0][2], m[1][2], m[2][2], m[3][2],m[0][3], m[1][3], m[2][3], m[3][3]);}mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}"+i.GraphUtils.adjMatrix_Autolink_GLSLFunctionString(t)+Utils.degToRadGLSLFunctionString()+Utils.radToDegGLSLFunctionString()+Utils.cartesianToSphericalGLSLFunctionString()+Utils.sphericalToCartesianGLSLFunctionString()+Utils.getVectorGLSLFunctionString()+"vec3 getVV(vec3 crB, float acum) {vec3 ob = cartesianToSpherical(crB);float angleLat = ob.y;float angleLng = ob.z;float desvLat = 0.0;float desvLng = 10.0;angleLng += (acum*desvLng);return sphericalToCartesian(vec3(1.0, angleLat, angleLng));}float getOddEven(float repeatId) {return (ceil(fract(repeatId/2.0)) == 0.0) ? 1.0*floor(repeatId/2.0) : -1.0*floor(repeatId/2.0);}vec3 getFirstDispl(float nodeId, vec4 currentPosition, float repeatId) {float repeatDistribution = -0.1;vec4 adjMatrix = idAdjMatrix_Autolink(nodeId, currentPosition.xyz);vec3 initialVec = normalize(posXYZW[adjMatrix.xy].xyz-currentPosition.xyz)*vec3(1.0, -1.0, 1.0);float totalAngleRelations = adjMatrix.z;initialVec = getVV(initialVec, (totalAngleRelations/2.0)*repeatDistribution);return getVV(initialVec, getOddEven(repeatId)*totalAngleRelations*0.01);}float checkLinkArrowVisibility(float currentTimestamp, float bornDate, float dieDate, float bornDateOpposite, float dieDateOpposite, float linkBornDate, float linkDieDate) {float visible =1.0;if(dieDate != 0.0) {if((currentTimestamp < bornDate || currentTimestamp > dieDate) || (currentTimestamp < bornDateOpposite || currentTimestamp > dieDateOpposite)) {visible = 0.0;} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}return visible;}","float nodeId = data[].x;float nodeIdOpposite = data[].y;float currentLineVertex = data[].z;float repeatId = data[].w;vec2 xGeometryNode = get_global_id(nodeId, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryNode_opposite = get_global_id(nodeIdOpposite, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryLinks = get_global_id(nodeId, bufferLinksWidth, 2.0);vec2 xGeometryLinks_opposite = get_global_id(nodeIdOpposite, bufferLinksWidth, 2.0);vec2 xGeometryArrows = get_global_id(nodeId, bufferArrowsWidth, 3.0);vec2 xGeometryArrows_opposite = get_global_id(nodeIdOpposite, bufferArrowsWidth, 3.0);vec2 xGeometryText = get_global_id(nodeId, bufferTextsWidth, 4.0*12.0);vec2 xGeometryText_opposite = get_global_id(nodeIdOpposite, bufferTextsWidth, 4.0*12.0);vec4 nodeVertexPosition = nodeVertexPos[];\nvec4 nodeVertexTex = nodeVertexTexture[];\nfloat linkBornDate = dataC[].x;float linkDieDate = dataC[].y;float bornDate = dataB[xGeometryNode].x;float dieDate = dataB[xGeometryNode].y;float foutput = dataB[xGeometryNode].z;float error = dataF[xGeometryNode].x;float bornDateOpposite = dataB[xGeometryNode_opposite].x;float dieDateOpposite = dataB[xGeometryNode_opposite].y;vec4 currentPosition = posXYZW[xGeometryNode];\nvec3 oppositePosition = posXYZW[xGeometryNode_opposite].xyz;\nvec4 nodeVertexColor = vec4(1.0, 1.0, 1.0, 1.0);\nvec4 nodeVertexColorNetError = vec4(1.0, 1.0, 1.0, 1.0);\nvec3 dir = oppositePosition-vec3(currentPosition.x, currentPosition.y, currentPosition.z);float dist = length(dir);float vertexCount = 1.0;float lineIncrements = dist/vertexCount;vec3 dirN = normalize(dir);vec3 cr = cross(dirN, vec3(0.0, 1.0, 0.0));float currentLineVertexSQRT = abs( currentLineVertex-(vertexCount/2.0) )/(vertexCount/2.0);currentLineVertexSQRT = sqrt(1.0-currentLineVertexSQRT);vVertexUV = vec2(-1.0, -1.0);vDist = max(0.3, 1.0-(distance(currentPosition.xyz, oppositePosition)*0.01));\nmat4 nodepos = nodeWMatrix;if(isNode == 1.0) {vVisibility = 1.0;currentPosition += vec4(0.0, 0.1, 0.0, 1.0);mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;float nodeImgId = nodeImgId[];if(nodeImgId != -1.0) {vUseTex = 1.0;vVertexUV = get2Dfrom1D(nodeImgId, nodeImgColumns)+vec2(nodeVertexTexture.x/nodeImgColumns,nodeVertexTexture.y/nodeImgColumns);}if(dieDate != 0.0 && (currentTimestamp < bornDate || currentTimestamp > dieDate)) vVisibility = 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(0.0, 0.0, 0.0, 1.0);if(foutput > 0.0) nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);else if(foutput < 0.0) nodeVertexColor = vec4(abs(foutput), 0.0, 0.0, 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}if(isLink == 1.0) {if(xGeometryLinks != xGeometryLinks_opposite) {currentPosition += vec4(dirN*(lineIncrements*currentLineVertex), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) currentPosition += vec4(cr*currentLineVertexSQRT*getOddEven(repeatId)*4.0, 1.0);} else {float currentLineVertexMM = abs( currentLineVertex-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPosition += vec4(initialVec*(5.0*currentLineVertexMM), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPosition += vec4((crB*sig)*currentLineVertexMMB*1.0, 1.0);}}vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}}if(isArrow == 1.0) {vec3 currentPositionTMP;if(xGeometryArrows != xGeometryArrows_opposite) {float currentLineVertexU = vertexCount-1.0;currentPositionTMP = oppositePosition+((dirN*-1.0)*(lineIncrements*currentLineVertexU));currentPositionTMP -= cr*(currentLineVertexSQRT*getOddEven(repeatId)*4.0);} else {float currentLineVertexU = vertexCount-1.0;float currentLineVertexMM = abs( currentLineVertexU-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPositionTMP = oppositePosition+(initialVec*(5.0*currentLineVertexMM));if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPositionTMP += (crB*sig)*currentLineVertexMMB*1.0;}}mat4 pp = lookAt(currentPositionTMP, vec3(currentPosition.x, currentPosition.y, currentPosition.z), vec3(0.0, 1.0, 0.0));pp = transpose(pp);nodepos[0][0] = pp[0][0];nodepos[0][1] = pp[1][0];nodepos[0][2] = pp[2][0];nodepos[1][0] = pp[0][1];nodepos[1][1] = pp[1][1];nodepos[1][2] = pp[2][1];nodepos[2][0] = pp[0][2];nodepos[2][1] = pp[1][2];nodepos[2][2] = pp[2][2];dir = currentPositionTMP-vec3(currentPosition.x, currentPosition.y, currentPosition.z);currentPosition += vec4(normalize(dir),1.0)*2.0;vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;}if(isNodeText == 1.0) {float letId = letterId[];\nmat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;vVertexUV = get2Dfrom1D(letId, fontImgColumns)+vec2(nodeVertexTexture.x/fontImgColumns,nodeVertexTexture.y/fontImgColumns);nodeVertexPosition = vec4(nodeVertexPosition.x*0.1, nodeVertexPosition.y*0.1, nodeVertexPosition.z*0.1, 1.0);currentPosition.z += 2.5;vVisibility = 1.0;vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}nodepos[3][0] = currentPosition.x;nodepos[3][1] = currentPosition.y;nodepos[3][2] = currentPosition.z;mat4 nodeposG = nodeWMatrix;vWNMatrix = nodeposG * nodeVertexNormal[];\nvUseCrosshair = 0.0;vIstarget = (currentLineVertex == 1.0) ? 1.0 : 0.0;"+e+"vVertexColor = nodeVertexColor;vVertexColorNetError = nodeVertexColorNetError;vUV = nodeVertexTexture;vNodeId = nodeId;\nvNodeIdOpposite = nodeIdOpposite;\ngl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPosition;\n","varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\n","vec4 color = vVertexColor;\nvec4 colorB = vVertexColorNetError;\nvec4 colorOrange = vec4(255.0/255.0, 131.0/255.0, 0.0/255.0, 1.0);vec4 colorOrangeDark = vec4(255.0/255.0, 80.0/255.0, 0.0/255.0, 1.0);vec4 colorPurple = vec4(132.0/255.0, 0.0/255.0, 255.0/255.0, 1.0);vec4 fcolor = vec4(0.0, 0.0, 0.0, 1.0);if(isNode == 1.0) {if(vUseTex == 1.0) {vec4 tex;if(vUseCrosshair == 1.0) {tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsSelected == 1.0) {color = colorOrangeDark;tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsHover == 1.0) {color = colorPurple;tex = nodesImg[vVertexUV.xy];} else {tex = nodesImg[vVertexUV.xy];}color = "+i.GraphUtils.nodesDrawMode(t)+";\n}if(color.a < 0.1) discard;fcolor = color;\nif(enableNeuronalNetwork == 1.0) {if(vUV.y > (0.7)) fcolor = colorB;\n}} else if(isLink == 1.0) {if(vIsSelected == 1.0) color = colorOrange;else if(vIsHover == 1.0) color = colorPurple;if(enableNeuronalNetwork == 1.0) {vec2 xAdjMatCurrent = get_global_id(vec2(vNodeIdOpposite, vNodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nvec4 pixAdjMatCCurrent = adjacencyMatrixC[xAdjMatCurrent];\nif(pixAdjMatACurrent.z > 0.0) fcolor = vec4(0.0, pixAdjMatACurrent.z, 0.0, 1.0);\nelse fcolor = vec4(abs(pixAdjMatACurrent.z), 0.0, 0.0, 1.0);\nif(multiplyOutput == 1.0) fcolor *= vec4(color.xyz, 1.0);\n} else fcolor = vec4(color.xyz, 1.0);\n} else if(isArrow == 1.0) {if(vIstarget == 1.0) {if(vIsSelected == 1.0) {color = vec4(colorOrange.rgb*vDist, 1.0);\n} else if(vIsHover == 1.0) {color = vec4(colorPurple.rgb*vDist, 1.0);\n}} else {color = vec4(1.0, 0.0, 0.0, 0.0);}fcolor = color;\n} else if(isNodeText == 1.0) {fcolor = fontsImg[vVertexUV.xy];\n}if(vVisibility == 0.0) discard;return [fcolor];"]}}]),e}();n.VFP_NODE=s,t.exports.VFP_NODE=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":10,scejs:1}],7:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODEPICKDRAG=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.VFP_NODEPICKDRAG=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e){return[[void 0],"varying vec4 vColor;\n"+Utils.packGLSLFunctionString()+"mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}","vec2 xGeometry = get_global_id(data[].x, uBufferWidth, "+e.toFixed(1)+");vec4 nodePosition = posXYZW[xGeometry];\nfloat bornDate = dataB[xGeometry].x;float dieDate = dataB[xGeometry].y;mat4 nodepos = nodeWMatrix;mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;nodepos[3][0] = nodePosition.x;nodepos[3][1] = nodePosition.y;nodepos[3][2] = nodePosition.z;vColor = vec4(1.0, 1.0, 1.0, 1.0);int mak = 0;if(dieDate != 0.0) {if(currentTimestamp > bornDate && currentTimestamp < dieDate) mak = 1;} else mak = 1;if(mak == 1) {vColor = pack((data[].x+1.0)/1000000.0);}if(vColor.x == 1.0 && vColor.y == 1.0 && vColor.z == 1.0 && vColor.w == 1.0) nodepos[3][0] = 10000.0;gl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPos[];\ngl_PointSize = 10.0;\n","varying vec4 vColor;\n","return [vColor];\n"]}}]),e}();n.VFP_NODEPICKDRAG=i,t.exports.VFP_NODEPICKDRAG=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],8:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.GBrainRL=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("./gbrain"),s=r.GBrainRL=function(){function e(t){o(this,e),this.gbrain=null,this.num_inputs=t.num_inputs,this.num_actions=t.num_actions,this.temporal_window=t.temporal_window,this.experience_size=t.experience_size,this.gamma=t.gamma,this.epsilon_min=t.epsilon_min,this.epsilon_test_time=t.epsilon_test_time,this.start_learn_threshold=t.start_learn_threshold,this.net_inputs=this.num_inputs*this.temporal_window+this.num_actions*this.temporal_window+this.num_inputs,this.window_size=Math.max(this.temporal_window,2),this.state_window=new Array(this.window_size),this.action_window=new Array(this.window_size),this.reward_window=new Array(this.window_size),this.net_window=new Array(this.window_size),this.experience=[],this.onLearned=null,this.age=0,this.epsilon=1,this.avcost=0,this.latest_reward=0,this.last_input_array=null,this.forward_passes=0,this.learning=!0,this.sweep=0,this.sweepMax=200,this.sweepDir=0,this.learning_steps_total=6e4,this.learning_steps_burnin=300,this.arrInputs=[],this.arrTargets=[],this.gbrain=new i.GBrain({target:t.target,dimensions:t.dimensions}),this.gbrain.makeLayers(t.layer_defs),this.lastTotalError=0,this.currentBatchRepeat=t.gpu_batch_repeats}return a(e,[{key:"getNetInput",value:function(e){var t=[];t=t.concat(e);for(var r=this.window_size,n=0;n<this.temporal_window;n++){t=t.concat(this.state_window[r-1-n]);for(var o=new Array(this.num_actions),a=0;a<this.num_actions;a++)o[a]=0;o[this.action_window[r-1-n]]=1*this.num_inputs,t=t.concat(o)}return t}},{key:"random_action",value:function(){return Math.floor(Math.random()*this.num_actions)}},{key:"policy",value:function(e,t){this.gbrain.forward(e,function(e){for(var r=[],n=0;n<e.length;n++){for(var o=0,a=e[n][0].output,i=1;i<e[n].length;i++)e[n][i].output>a&&(o=i,a=e[n][i].output);r.push({action:o,value:a})}t(r)})}},{key:"pushWindow",value:function(e,t,r){this.state_window.shift(),this.state_window.push(e),this.net_window.shift(),this.net_window.push(t),this.action_window.shift(),this.action_window.push(r)}},{key:"forward",value:function(e,t){var r=this;this.forward_passes++,this.last_input_array=e;var n=null,o=null;if(this.forward_passes>this.temporal_window){if(o=this.getNetInput(e),!0===this.learning){var a=Math.min(1,Math.max(0,this.latest_reward)),i=a>0?1-a:-1*a;i=2*Math.min(1,Math.max(0,i)),i=Math.min(1,Math.max(.1,i)),this.sweep>=this.sweepMax?this.sweepDir=-1:this.sweep<=0&&(this.sweepDir=1),this.sweep+=this.sweepDir;this.sweep,this.sweepMax;this.epsilon=Math.min(1,Math.max(this.epsilon_min,1-(this.age-this.learning_steps_burnin)/(this.learning_steps_total-this.learning_steps_burnin)))}else this.epsilon=this.epsilon_test_time;Math.random()<this.epsilon?(n=this.random_action(),this.pushWindow(e,o,n),t(n)):this.policy(o,function(n){r.pushWindow(e,o,n[0].action),t(n[0].action)})}else o=[],n=this.random_action(),this.pushWindow(e,o,n),t(n)}},{key:"train",value:function(){var e=this;this.gbrain.forward(this.arrInputs,function(t){e.gbrain.train(e.arrTargets,function(t){e.arrInputs=[],e.arrTargets=[],9===e.currentBatchRepeat?e.onLearned():(e.currentBatchRepeat++,e.bb())})})}},{key:"bb",value:function(){for(var e=this,t=[],r=[],n=0;n<this.gbrain.batch_size;n++){var o=this.experience[Math.floor(Math.random()*this.experience.length)];t.push(o);for(var a=0;a<o.state1.length;a++)r.push(o.state1[a])}this.policy(r,function(r){for(var n=[],o=0;o<e.gbrain.batch_size;o++){for(var a=t[o].reward0+e.gamma*r[o].value,i={dim:t[o].action0,val:a},s=0;s<t[o].state0.length;s++)n.push(t[o].state0[s]);e.arrTargets.push(i)}e.arrInputs=n,e.avcost=0,e.train()})}},{key:"backward",value:function(e,t){if(this.latest_reward=e,this.onLearned=t,this.reward_window.shift(),this.reward_window.push(e),!1===this.learning)this.onLearned();else{if(this.age++,this.forward_passes>this.temporal_window+1){var r=this.window_size,n={state0:this.net_window[r-2],action0:this.action_window[r-2],reward0:this.reward_window[r-2],state1:this.net_window[r-1]};if(this.experience.length<this.experience_size)this.experience.push(n);else{var o=Math.floor(Math.random()*this.experience.length);this.experience[o]=o}}this.experience.length>this.start_learn_threshold?(this.currentBatchRepeat=0,this.bb()):this.onLearned()}}}]),e}();n.GBrainRL=s,t.exports.GBrainRL=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./gbrain":9}],9:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.GBrain=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./Graph.class"),s=r.GBrain=function(){function e(t){o(this,e),this.project=null,this.graph=null,this.inputCount=0,this.outputCount=0,this.neuronLayers=[],this.batch_size=7,this.ini(t)}return a(e,[{key:"ini",value:function(e){var t=new SCE;t.initialize(e),this.project=new Project,t.loadProject(this.project);var r=new Stage;this.project.addStage(r),this.project.setActiveStage(r);var n=new SimpleCamera(t);n.setView(Constants.VIEW_TYPES.TOP),n.setVelocity(1),t.setDimensions(e.dimensions.width,e.dimensions.height),this.graph=new i.Graph(t,{enableFonts:!0}),this.graph.enableNeuronalNetwork(),this.graph.layerCount=0,this.graph.batch_size=this.batch_size;(new Mesh).loadPoint();this.graph.setFontsImage(t.sceDirectory+"/Prefabs/Graph/fonts.png")}},{key:"makeLayers",value:function(e){for(var t=this,r=-30,n={input:function(e){for(var n=e.depth/2*-10,o=0;o<e.depth;o++)t.graph.afferentNodesCount++,t.graph.addAfferentNeuron("input"+t.inputCount,[r,0,n,1]),t.inputCount++,n+=10;t.graph.layerCount++,r+=30},fc:function(e){var n=t.graph.createNeuronLayer(1,e.num_neurons,[r,0,0,1],5);if(t.neuronLayers.push(n),1===t.graph.layerCount)for(var o=0;o<t.inputCount;o++)t.graph.connectNeuronWithNeuronLayer({neuron:"input"+o,neuronLayer:t.neuronLayers[t.neuronLayers.length-1],activationFunc:0,weight:null,multiplier:1,layerNum:t.graph.layerCount-1});else t.graph.connectNeuronLayerWithNeuronLayer({neuronLayerOrigin:t.neuronLayers[t.neuronLayers.length-2],neuronLayerTarget:t.neuronLayers[t.neuronLayers.length-1],layerNum:t.graph.layerCount-1});t.graph.layerCount++,r+=30},regression:function(e){for(var n=e.num_neurons/2*-30,o=0;o<e.num_neurons;o++)t.graph.efferentNodesCount++,t.graph.addEfferentNeuron("output"+t.outputCount,[r,0,n,1]),t.graph.connectNeuronLayerWithNeuron({neuronLayer:t.neuronLayers[t.neuronLayers.length-1],neuron:"output"+t.outputCount,layerNum:t.graph.layerCount-1}),t.outputCount++,n+=30;t.graph.layerCount++}},o=0;o<e.length;o++){var a=e[o];n[a.type](a)}this.graph.createWebGLBuffers(),this.graph.enableForceLayout()}},{key:"forward",value:function(e,t){this.graph.forward({state:e,onAction:function(e){t(e)}})}},{key:"train",value:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var o=0;o<this.outputCount/this.batch_size;o++)o===e[n].dim?r.push(e[n].val):r.push(0);this.graph.train({arrReward:r,onTrained:function(e){t(e)}})}},{key:"enableShowOutputWeighted",value:function(){this.graph.enableShowOutputWeighted()}},{key:"disableShowOutputWeighted",value:function(){this.graph.disableShowOutputWeighted()}},{key:"tick",value:function(){this.project.getActiveStage().tick()}}]),e}();n.GBrain=s,t.exports.GBrain=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Graph.class":2,scejs:1}],10:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[8]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.Graph=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var s=e("./KERNEL_DIR.class"),u=e("./KERNEL_ADJMATRIX_UPDATE.class"),l=e("./VFP_NODE.class"),d=e("./VFP_NODEPICKDRAG.class"),c=e("./ProccessImg.class"),h=r.Graph=function(){function e(t,r){var n=this;a(this,e),this._sce=t,this._project=this._sce.getLoadedProject(),this._gl=this._project.getActiveStage().getWebGLContext(),this._utils=new Utils,this.MAX_ITEMS_PER_ARRAY=4294967295,this.NODE_IMG_COLUMNS=8,this.NODE_IMG_WIDTH=2048,this._enableFont=r&&!0===r.enableFonts,this._enableHover=!1,this._enableAutoLink=!0,this._enabledForceLayout=!1,this._MAX_ADJ_MATRIX_WIDTH=2048,this._playAnimation=!1,this._loop=!1,this._animationFrames=500,this._geometryLength=void 0===r||r&&void 0===r.nodeDrawMode||r&&"plane"===r.nodeDrawMode?4:1,this.circleSegments=12,this.nodesTextPlanes=12,this.lineVertexCount=1,this._enableNeuronalNetwork=!1,this.batch_size=null,this.layerCount=0,this.afferentNodesCount=0,this.efferentNodesCount=0,this.trainTickCount=0,this.onAction=null,this.onTrained=null,this.afferentNeuron=[],this.efferentNeuron=[],this.v_val=0,this.return_v=!1,this._only2d=!1,this.multiplyOutput=1,this._nodesByName={},this._nodesById={},this._links={},this._customArgs={},this.arrAdjMatrix=null,this.arrAdjMatrixB=null,this.arrAdjMatrixC=null,this.currentTrainLayer=-3,this._ADJ_MATRIX_WIDTH=null,this._initTimestamp=0,this._currentFrame=0,this._endTimestamp=Date.now(),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames,this.readPixel=!1,this.selectedId=-1,this._initialPosDrag=null,this._onClickNode=null,this._onAnimationStep=null,this._onAnimationEnd=null,this.mesh_nodes=1===this._geometryLength?(new Mesh).loadPoint():(new Mesh).loadQuad(4,4),this.mesh_arrows=(new Mesh).loadTriangle({scale:1.75,side:.3}),this.mesh_nodesText=(new Mesh).loadQuad(4,4),this.objNodeImages={},this._stackNodesImg=[],this.nodesImgMask=null,this.nodesImgMaskLoaded=!1,this.nodesImgCrosshair=null,this.nodesImgCrosshairLoaded=!1,this.FONT_IMG_COLUMNS=7,this.disabVal=0,this.arrayNodeData=[],this.arrayNodeDataB=[],this.arrayNodeDataF=[],this.arrayNodeDataG=[],this.arrayNodeDataH=[],this.arrayNodePosXYZW=[],this.arrayNodeVertexPos=[],this.arrayNodeVertexNormal=[],this.arrayNodeVertexTexture=[],this.startIndexId=0,this.arrayNodeIndices=[],this.arrayNodeImgId=[],this.arrayNodeDir=[],this.currentNodeId=0,this.nodeArrayItemStart=0,this.linksObj=[],this.currentLinksObjItem=-1,this.currentLinkId=0,this.arrowsObj=[],this.currentArrowsObjItem=-1,this.currentArrowId=0,this.arrayNodeTextData=[],this.arrayNodeTextNodeName=[],this.arrayNodeTextPosXYZW=[],this.arrayNodeTextVertexPos=[],this.arrayNodeTextVertexNormal=[],this.arrayNodeTextVertexTexture=[],this.startIndexId_nodestext=0,this.arrayNodeTextIndices=[],this.arrayNodeText_itemStart=[],this.arrayNodeTextLetterId=[],this.currentNodeTextId=0,this.nodeTextArrayItemStart=0,this.layout=null,this.currHiddenNeuron=0,this.nodSep=5,this.nodes=new Node,this.nodes.setName("graph_nodes"),this._project.getActiveStage().addNode(this.nodes),this.nodes.addComponent(new ComponentTransform),this.comp_renderer_nodes=new Component_GPU,this.nodes.addComponent(this.comp_renderer_nodes);var o=new ComponentMouseEvents;this.nodes.addComponent(o),o.onmousedown(function(e){n.selectedId=-1,n.mouseDown()}),o.onmouseup(function(e){if(-1!==n.selectedId){var t=n._nodesById[n.selectedId];void 0!==t&&null!==t&&void 0!==t.onmouseup&&null!==t.onmouseup&&t.onmouseup(t,e)}n.mouseUp()}),o.onmousemove(function(e,t){n.makeDrag(e,t)}),o.onmousewheel(function(e){}),this.createLinksObjItem(),this.createArrowsObjItem(),this.nodesText=null,this.comp_renderer_nodesText=null,!0===this._enableFont&&(this.nodesText=new Node,this.nodesText.setName("graph_nodesText"),this._project.getActiveStage().addNode(this.nodesText),this.nodesText.addComponent(new ComponentTransform),this.comp_renderer_nodesText=new Component_GPU,this.nodesText.addComponent(this.comp_renderer_nodesText))}return i(e,[{key:"createLinksObjItem",value:function(){this.currentLinksObjItem++,this.linksObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayLinkData:[],arrayLinkDataC:[],arrayLinkNodeName:[],arrayLinkPosXYZW:[],arrayLinkVertexPos:[],startIndexId_link:0,arrayLinkIndices:[]}),this.linksObj[this.currentLinksObjItem].node.setName("graph_links"+this.currentLinksObjItem),this._project.getActiveStage().addNode(this.linksObj[this.currentLinksObjItem].node),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentTransform),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentRenderer)}},{key:"createArrowsObjItem",value:function(){this.currentArrowsObjItem++,this.arrowsObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayArrowData:[],arrayArrowDataC:[],arrayArrowNodeName:[],arrayArrowPosXYZW:[],arrayArrowVertexPos:[],arrayArrowVertexNormal:[],arrayArrowVertexTexture:[],startIndexId_arrow:0,arrayArrowIndices:[],arrowArrayItemStart:0}),this.arrowsObj[this.currentArrowsObjItem].node.setName("graph_arrows"+this.currentArrowsObjItem),this._project.getActiveStage().addNode(this.arrowsObj[this.currentArrowsObjItem].node),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentTransform),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentRenderer)}},{key:"onClickNode",value:function(e){this._onClickNode=e}},{key:"getBornDieTS",value:function(t,r){var n=this,o=void 0,a=void 0;if(null!=t)if(t.constructor===String)if("RANDOM"===t){var i=function(){for(var e=n._initTimestamp+Math.round(Math.random()*Math.max(0,n._animationFrames-20))*n._timeFrameIncrement,t=void 0;!((t=n._initTimestamp+Math.round(Math.random()*n._animationFrames)*n._timeFrameIncrement)>e););return{bornDate:e,dieDate:t}}();o=i.bornDate,a=i.dieDate}else o=e.datetimeToTimestamp(t),a=e.datetimeToTimestamp(r);else o=t,a=r;else o=1,a=0;return{bornDate:o,dieDate:a}}},{key:"showTimeline",value:function(e){var t=this,r=document.createElement("input");r.type="range",r.min="0",r.max=this._animationFrames.toString(),r.step="1",r.value="0",r.style.verticalAlign="middle",r.style.width="78%",e.innerText="",e.appendChild(r);r.addEventListener("input",function(e){var r=e.value;t.setFrame(r)}.bind(this,r))}},{key:"setTimelineDatetimeRange",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t.initDatetime),this._endTimestamp=e.datetimeToTimestamp(t.endDatetime),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeStart",value:function(){return this._initTimestamp}},{key:"setTimelineDatetimeRangeStart",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeEnd",value:function(){return this._endTimestamp}},{key:"setTimelineDatetimeRangeEnd",value:function(t){this._endTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineRangeDates",value:function(){return{initDate:this.timestampToDate(this._initTimestamp),endDate:this.timestampToDate(this._endTimestamp)}}},{key:"getTimelineFramesLength",value:function(){return this._animationFrames}},{key:"setTimelineFramesLength",value:function(e){this._animationFrames=e,this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"setTimelineTimestamp",value:function(e){this._currentFrame=Math.round((e-this._initTimestamp)/this._timeFrameIncrement)}},{key:"setFrame",value:function(e){this._currentFrame=e}},{key:"getFrame",value:function(e){return this._currentFrame}},{key:"playTimeline",value:function(e){this._playAnimation=!0,void 0!==e&&(this._loop=e)}},{key:"pauseTimeline",value:function(){this._playAnimation=!1}},{key:"onAnimationStep",value:function(e){this._onAnimationStep=e}},{key:"onAnimationEnd",value:function(e){this._onAnimationEnd=e}},{key:"getNodesCount",value:function(){return Object.keys(this._nodesByName).length}},{key:"getLinksCount",value:function(){return Object.keys(this._links).length}},{key:"getNodeByName",value:function(e){return this._nodesByName[e]}},{key:"getNodeById",value:function(e){return this._nodesById[e]}},{key:"selectNode",value:function(e){this.selectedId=e,this.makeDrag(null,$V3([0,0,0]))}},{key:"getSelectedId",value:function(){return this.selectedId}},{key:"enableHover",value:function(){this._enableHover=!0,this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1)}},{key:"enableAutoLink",value:function(){this._enableAutoLink=!0}},{key:"disableAutoLink",value:function(){this._enableAutoLink=!1}},{key:"only2d",value:function(e){this._only2d=e}},{key:"setFontsImage",value:function(e){var t=this;if(!0===this._enableFont){var r=new Image;r.onload=function(){t.comp_renderer_nodesText.setArg("fontsImg",function(){return r})},r.src=e}}},{key:"setNodeMesh",value:function(e){this.mesh_nodes=e}},{key:"exportFile",value:function(){var e="[",t="";for(var r in this._nodesByName)e+=t+JSON.stringify(this._nodesByName[r]),t=",",console.log(this._nodesByName[r]);e+="]|[",t="";for(var n in this._links)e+=t+JSON.stringify(this._links[n]),t=",",console.log(this._links[n]);e+="]",console.log(e)}},{key:"importFile",value:function(e){var t=e.split("|"),r=JSON.parse(t[0]),o=JSON.parse(t[1]);for(var a in r)this.addNode({name:r[a].name,data:r[a].name,label:r[a].label,position:r[a].pos,color:0===Math.floor(n%2)?"../_RESOURCES/lena_128x128.jpg":"../_RESOURCES/cartman08.jpg",layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:r[a].pos,initDir:[0,0,0,0],nodeColor:[Math.random(),Math.random(),Math.random(),1],nodeLock:0},onmouseup:function(e){}});for(var i in o){var s=o[i].origin_nodeName,u=o[i].target_nodeName;this.addLink({origin:s,target:u,directed:!0})}}},{key:"loadRBFromFile",value:function(e,t,r,n){var o=this,a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",function(e){console.log("RB file Loaded"),o.loadRBFromStr({data:e.target.responseText,generateBornAndDieDates:r,randomLinkWeights:n}),void 0!==t&&null!==t&&t()}),a.addEventListener("error",function(e){console.log(e)}),a.send(null)}},{key:"loadRBFromStr",value:function(e){var t=e.data,r=t.split("\r\n");1===r.length&&(r=t.split("\n"));var n=r[0].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==n[0]&&null!==n[0]&&n[0],void 0!==n[1]&&null!==n[1]&&n[1];console.log(n);var o=r[1].replace(/(\s|\t)+/gi," ").trim().split(" "),a=(void 0!==o[0]&&null!==o[0]&&parseInt(o[0]),void 0!==o[1]&&null!==o[1]?parseInt(o[1]):null),i=void 0!==o[2]&&null!==o[2]?parseInt(o[2]):null;void 0!==o[3]&&null!==o[3]&&parseInt(o[3]),void 0!==o[4]&&null!==o[4]&&parseInt(o[4]);console.log(o);var s=r[2].replace(/(\s|\t)+/gi," ").trim().split(" "),u=(void 0!==s[0]&&null!==s[0]&&s[0],void 0!==s[1]&&null!==s[1]?parseInt(s[1]):null);void 0!==s[2]&&null!==s[2]&&parseInt(s[2]),void 0!==s[3]&&null!==s[3]&&parseInt(s[3]),void 0!==s[4]&&null!==s[4]&&parseInt(s[4]);console.log(s);var l=r[3].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==l[0]&&null!==l[0]&&l[0],void 0!==l[1]&&null!==l[1]&&l[1],void 0!==l[2]&&null!==l[2]&&l[2],void 0!==l[3]&&null!==l[3]&&l[3];console.log(l);for(var d=0;d<u;d++){var c=[500*Math.random()-250,500*Math.random()-250,500*Math.random()-250,1],h=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0};this.addNode({name:d.toString(),data:d.toString(),label:d.toString(),position:c,color:!1===this._enableNeuronalNetwork?"../_RESOURCES/UV.jpg":"../_RESOURCES/white.jpg",bornDate:h.bornDate,dieDate:h.dieDate,layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:c,initDir:[0,0,0,0],nodeColor:[1,1,1,1],nodeLock:0},onmouseup:function(e){}})}for(var f="",p=4;p<4+a;p++)f+=r[p];var m=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(m),f="";for(var g=4+a;g<4+a+i;g++)f+=r[g];var _=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(_);for(var v=0,x=0,N=m.length;x<N;x++){for(var A=parseInt(m[x])-1,y=0,C=parseInt(m[x+1])-1-A;y<C;y++){var D=parseInt(_[A+y])-1,I=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0},b=void 0!==e.randomLinkWeights&&null!==e.randomLinkWeights&&!0===e.randomLinkWeights?"RANDOM":null;this.addLink({origin:D.toString(),target:v.toString(),directed:!0,bornDate:I.bornDate,dieDate:I.dieDate,weight:b})}v++}}},{key:"clear",value:function(){var e=function(e){var t=e.gpufG.getAllArgs();for(var r in t)t[r]instanceof WebCLGLBuffer==!0&&"RGB"!==r&&t[r].remove()};e(this.comp_renderer_nodes);for(var t=0;t<this.linksObj.length;t++)e(this.linksObj[t].componentRenderer);for(var r=0;r<this.arrowsObj.length;r++)e(this.arrowsObj[r].componentRenderer);!0===this._enableFont&&e(this.comp_renderer_nodesText),this._project.getActiveStage().removeNode(this.nodes);for(var n=0;n<this.linksObj.length;n++)this._project.getActiveStage().removeNode(this.linksObj[n].node);for(var o=0;o<this.arrowsObj.length;o++)this._project.getActiveStage().removeNode(this.arrowsObj[o].node);this._project.getActiveStage().removeNode(this.nodesText)}},{key:"applyLayout",value:function(e){this.layout=e;var t=function(e,t){for(var r=0,n=t.length;r<n;r++)e[t[r].trim().split(" ")[1]]={arg:t[r].trim(),nodes_array_value:[],links_array_value:[],arrows_array_value:[],nodestext_array_value:[]};return e};this.layout.argsDirection=void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection?this.layout.argsDirection.split(","):null,this.layout.argsObject=void 0!==this.layout.argsObject&&null!==this.layout.argsObject?this.layout.argsObject.split(","):null,this._customArgs={},null!=this.layout.argsDirection&&(this._customArgs=t(this._customArgs,this.layout.argsDirection)),null!=this.layout.argsObject&&(this._customArgs=t(this._customArgs,this.layout.argsObject))}},{key:"createWebGLBuffers",value:function(){var e=this,t={"float4* posXYZW":function(){return null},"float4* dataB":function(){return null},"float4* dataF":function(){return null},"float4* dataG":function(){return null},"float4* dataH":function(){return null},"float4*attr data":function(){return null},"float4*attr dataC":function(){return null},"float4*attr nodeVertexPos":function(){return null},"float4*attr nodeVertexNormal":function(){return null},"float4*attr nodeVertexTexture":function(){return null},"float*attr letterId":function(){return null},"float*attr nodeImgId":function(){return null},indices:function(){return null},"float4* adjacencyMatrix":function(){return null},"float4* adjacencyMatrixB":function(){return null},"float4* adjacencyMatrixC":function(){return null},"float widthAdjMatrix":function(){return null},"float nodesCount":function(){return null},"float currentTimestamp":function(){return null},"mat4 PMatrix":function(){return null},"mat4 cameraWMatrix":function(){return null},"mat4 nodeWMatrix":function(){return null},"float isNode":function(){return null},"float isLink":function(){return null},"float isArrow":function(){return null},"float isNodeText":function(){return null},"float bufferNodesWidth":function(){return null},"float bufferLinksWidth":function(){return null},"float bufferArrowsWidth":function(){return null},"float bufferTextsWidth":function(){return null},"float idToDrag":function(){return null},"float idToHover":function(){return null},"float enableForceLayout":function(){return null},"float enableForceLayoutCollision":function(){return null},"float enableNeuronalNetwork":function(){return null},"float afferentNodesCount":function(){return null},"float efferentNodesCount":function(){return null},"float efferentStart":function(){return null},"float currentTrainLayer":function(){return null},"float multiplyOutput":function(){return null},"float only2d":function(){return null},"float nodeImgColumns":function(){return null},"float fontImgColumns":function(){return null},"float4* fontsImg":function(){return null},"float4* nodesImg":function(){return null},"float4* nodesImgCrosshair":function(){return null}},r=0===this.afferentNodesCount?1:this.afferentNodesCount,n=0===this.efferentNodesCount?1:this.efferentNodesCount;if(t["float afferentNodesA["+r+"]"]=function(){return null},t["float efferentNodesA["+n+"]"]=function(){return null},t["float afferentNodesB["+r+"]"]=function(){return null},t["float efferentNodesB["+n+"]"]=function(){return null},t["float afferentNodesC["+r+"]"]=function(){return null},t["float efferentNodesC["+n+"]"]=function(){return null},t["float afferentNodesD["+r+"]"]=function(){return null},t["float efferentNodesD["+n+"]"]=function(){return null},t["float afferentNodesE["+r+"]"]=function(){return null},t["float efferentNodesE["+n+"]"]=function(){return null},t["float afferentNodesF["+r+"]"]=function(){return null},t["float efferentNodesF["+n+"]"]=function(){return null},t["float afferentNodesG["+r+"]"]=function(){return null},t["float efferentNodesG["+n+"]"]=function(){return null},void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection)for(var o=0;o<this.layout.argsDirection.length;o++)t[this.layout.argsDirection[o]]=function(){return null};if(void 0!==this.layout.argsObject&&null!==this.layout.argsObject)for(var a=0;a<this.layout.argsObject.length;a++)t[this.layout.argsObject[a]]=function(){return null};for(var i={"float4* dir":function(){return null},"float nodesCount":function(){return null},"float enableDrag":function(){return null},"float initialPosX":function(){return null},"float initialPosY":function(){return null},"float initialPosZ":function(){return null},"float MouseDragTranslationX":function(){return null},"float MouseDragTranslationY":function(){return null},"float MouseDragTranslationZ":function(){return null}},c=0;c<this.linksObj.length;c++)this.linksObj[c].componentRenderer.setGPUFor(this.linksObj[c].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"LINKS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.linksObj[c].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));for(var h=0;h<this.arrowsObj.length;h++)this.arrowsObj[h].componentRenderer.setGPUFor(this.arrowsObj[h].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"ARROWS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.arrowsObj[h].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));var f=Object.create(t);for(var p in i)f[p]=i[p];this.comp_renderer_nodes.setGPUFor(this.comp_renderer_nodes.gl,f,{type:"KERNEL",name:"NODES_KERNEL_DIR",viewSource:!1,config:s.KERNEL_DIR.getSrc(this.layout.codeDirection,this._geometryLength,this.currentNodeId-this.efferentNodesCount,this.efferentNodesCount,this._enableNeuronalNetwork),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"KERNEL",name:"NODES_KERNEL_ADJMATRIX_UPDATE",viewSource:!1,config:u.KERNEL_ADJMATRIX_UPDATE.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"GRAPHIC",name:"NODES_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA},{type:"GRAPHIC",name:"NODES_VFP_NODEPICKDRAG",viewSource:!1,config:d.VFP_NODEPICKDRAG.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ZERO});var m=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU);this.comp_renderer_nodes.getComponentBufferArg("RGB",m),this.comp_renderer_nodes.gpufG.onPreProcessKernel(0,function(){var t=e._initTimestamp+e._currentFrame*e._timeFrameIncrement;e.comp_renderer_nodes.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var r=0;r<e.linksObj.length;r++)e.linksObj[r].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var n=0;n<e.arrowsObj.length;n++)e.arrowsObj[n].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));!0===e._playAnimation&&(e._currentFrame++,void 0!==e._onAnimationStep&&null!==e._onAnimationStep&&e._onAnimationStep(e._currentFrame),e._currentFrame===e._animationFrames&&(e._currentFrame=0,!1===e._loop&&(e.pauseTimeline(),void 0!==e._onAnimationEnd&&null!==e._onAnimationEnd&&e._onAnimationEnd()))),e.comp_renderer_nodes.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var o=0;o<e.linksObj.length;o++)e.linksObj[o].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var a=0;a<e.arrowsObj.length;a++)e.arrowsObj[a].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});e.comp_renderer_nodes.setArg("only2d",function(){return!0===e._only2d?1:0})}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.disableKernel(1),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(1,function(){e.procSelectedOrHover()}),this.comp_renderer_nodes.gpufG.disableGraphic(1),!0===this._enableFont&&(this.comp_renderer_nodesText.setGPUFor(this.comp_renderer_nodesText.gl,Object.create(t),{type:"GRAPHIC",name:"NODESTEXT_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.comp_renderer_nodesText.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU))),this.enableHov(-1),this.updateNodes(),this.updateLinks()}},{key:"mouseDown",value:function(){!1===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"mouseUp",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0});if(!0===this._enableFont&&this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),-1===this.selectedId){this.comp_renderer_nodes.setArg("idToDrag",function(){return-1});for(var r=0;r<this.linksObj.length;r++)this.linksObj[r].componentRenderer.setArg("idToDrag",function(){return-1});for(var n=0;n<this.arrowsObj.length;n++)this.arrowsObj[n].componentRenderer.setArg("idToDrag",function(){return-1});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToDrag",function(){return-1})}!0===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"procSelectedOrHover",value:function(){if(!1===this._enableHover)!0===this.readPixel&&(this.readPixel=!1,this.readPix(),this.comp_renderer_nodes.gpufG.disableGraphic(1));else{var e=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!0===e.isLeftBtnActive()&&(this.readPixel=!1),this.readPix(),!0===e.isLeftBtnActive()&&this.comp_renderer_nodes.gpufG.disableGraphic(1)}}},{key:"readPix",value:function(){var e=new Uint8Array(4),t=this._sce.getEvents().getMousePosition();this._gl.readPixels(t.x,this._sce.getCanvas().height-t.y,1,1,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);var r=this._utils.unpack([e[0]/255,e[1]/255,e[2]/255,e[3]/255]);if(this.selectedId=Math.round(1e6*r)-1,-1!==this.selectedId&&this.selectedId<this.currentNodeId){var n=this._nodesById[this.selectedId];void 0!==n&&null!==n&&void 0!==n.onmousedown&&null!==n.onmousedown&&n.onmousedown(n),void 0!==n&&null!==n&&void 0!==this._onClickNode&&null!==this._onClickNode&&this._onClickNode(n);var o=this.comp_renderer_nodes.gpufG.readArg("posXYZW"),a=o[4*this._nodesById[this.selectedId].itemStart],i=o[4*this._nodesById[this.selectedId].itemStart+1],s=o[4*this._nodesById[this.selectedId].itemStart+2];this._initialPosDrag=$V3([a,i,s]),this.makeDrag(null,$V3([0,0,0]))}}},{key:"makeDrag",value:function(e,t){var r=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!1===this._enableHover?!0===r.isLeftBtnActive()&&(-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):!0===r.isLeftBtnActive()?(this.enableHov(-1),-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):this.enableHov(this.selectedId)}},{key:"enableHov",value:function(e){this.comp_renderer_nodes.setArg("idToHover",function(){return e});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg("idToHover",function(){return e});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg("idToHover",function(){return e});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToHover",function(){return e})}},{key:"enableDrag",value:function(e,t){var r=this,n=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION),o=this._initialPosDrag.add(t.x(2*n.getFov()/this._sce.getCanvas().width));this.comp_renderer_nodes.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodes.setArg("idToDrag",function(){return e}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodes.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodes.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodes.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.setArg("enableDrag",function(){return 1}),this.linksObj[a].componentRenderer.setArg("idToDrag",function(){return e}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.linksObj[a].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.linksObj[a].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.linksObj[a].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.setArg("enableDrag",function(){return 1}),this.arrowsObj[i].componentRenderer.setArg("idToDrag",function(){return e}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.arrowsObj[i].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.arrowsObj[i].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.arrowsObj[i].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return e}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodesText.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodesText.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodesText.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]}))}},{key:"disableDrag",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodes.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("idToDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("idToDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return 0}))}},{key:"enableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!0,this.disableAutoLink(),this.applyLayout({argsDirection:"float4* dest,float* enableDestination",codeDirection:"if(enableDestination[x] == 1.0) {\n                    vec3 destinationPos = dest[x].xyz;\n                    vec3 dirDestination = normalize(destinationPos-currentPos);\n                    float distan = abs(distance(currentPos,destinationPos));\n                    float dirDestWeight = sqrt(distan);\n                    currentDir = (currentDir+(dirDestination*dirDestWeight))*dirDestWeight*0.1;\n                }",argsObject:"float4*attr nodeColor",codeObject:"if(isArrow == 1.0 && currentLineVertex == 1.0) nodeVertexColor = vec4(0.3, 0.2, 0.2, 1.0);if(isArrow == 1.0 && currentLineVertex == 0.0) nodeVertexColor = vec4(1.0, 0.0, 0.0, 0.0);"})}},{key:"disableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!1}},{key:"addNeuron",value:function(e,t){var r=[1e3*Math.random()-500,1e3*Math.random()-500,1e3*Math.random()-500,1],n=void 0!==t&&null!==t?t:[0,0,0,1],o=void 0!==t&&null!==t?1:0;this.addNode({name:e,data:e,label:e.toString(),position:r,color:"../_RESOURCES/white.jpg",layoutNodeArgumentData:{nodeColor:[1,1,1,1],enableDestination:o,dest:n},onmouseup:function(e){}})}},{key:"addAfferentNeuron",value:function(e,t){this.afferentNeuron.push(e),this.addNeuron(e,t)}},{key:"addEfferentNeuron",value:function(e,t){this.efferentNeuron.push(e),this.addNeuron(e,t)}},{key:"createNeuronLayer",value:function(e,t,r,n){for(var o=[],a=0;a<e;a++)for(var i=0;i<t;i++){var s=[r[0]+(a-e/2)*n,r[1],r[2]+(i-t/2)*n,r[3]];this.addNeuron(this.currHiddenNeuron.toString(),s),o.push(this.currHiddenNeuron),this.currHiddenNeuron++}return o}},{key:"createXYNeuronsFromImage",value:function(e){for(var t=[],r=0;r<e.w;r++)for(var n=0;n<e.h;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.neuron+r+"_"+n,o),t.push(e.neuron+r+"_"+n)}return t}},{key:"createConvXYNeuronsFromXYNeurons",value:function(e){for(var t=[],r=0;r<e.w-2;r++)for(var n=0;n<e.h-2;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.idTarget+r+"_"+n,o),t.push(e.idTarget+r+"_"+n);for(var a=0,i=r;i<r+3;i++)for(var s=n;s<n+3;s++)this.addSinapsis({neuronNameA:e.idOrigin+i+"_"+s,neuronNameB:e.idTarget+r+"_"+n,activationFunc:e.activationFunc,multiplier:e.convMatrix[a],layerNum:0}),a++}return t}},{key:"addSinapsis",value:function(e){var t=this,r=function e(){if(!0===t.return_v)return t.return_v=!1,t.v_val;var r=2*Math.random()-1,n=2*Math.random()-1,o=r*r+n*n;if(0===o||o>1)return e();var a=Math.sqrt(-2*Math.log(o)/o);return t.v_val=n*a,t.return_v=!0,r*a},n=Math.sqrt(.02),o=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,a=void 0!==e.weight&&null!==e.weight?e.weight:function(e,t){return e+r()*t}(0,n),i=void 0!==e.multiplier&&null!==e.multiplier?e.multiplier:1;this.addLink({origin:e.neuronNameA,target:e.neuronNameB,directed:!0,showArrow:!1,activationFunc:o,weight:a,linkMultiplier:i,layerNum:e.layerNum})}},{key:"connectNeuronWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuron.toString(),neuronNameB:e.neuronLayer[t].toString(),activationFunc:e.activationFunc,weight:e.weight,multiplier:e.multiplier,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuron",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuronLayer[t].toString(),neuronNameB:e.neuron,activationFunc:1,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayerOrigin.length;t++){var r=e.neuronLayerOrigin[t];this.connectNeuronWithNeuronLayer({neuron:r.toString(),neuronLayer:e.neuronLayerTarget,layerNum:e.layerNum})}}},{key:"forward",value:function(e){var t=this;this.onAction=e.onAction;for(var r=e.state.slice(0),n=e.state.length;n<this.afferentNodesCount;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.afferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("afferentNodes"+o[a++],function(){return r.slice(e,e+t.afferentNodesCount)})}(i);for(var u=0;u<this.layerCount;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this._sce.getLoadedProject().getActiveStage().tick(),null!==this.onAction){for(var l=[["dataB",2],["dataF",0],["dataF",2],["dataG",0],["dataG",2],["dataH",0],["dataH",2]],d=[[]],c=0,h=0;h<this.efferentNodesCount*this.batch_size;h++){d[c].length===this.efferentNodesCount&&(d.push([]),c++);var f=this.getNeuronOutput(this.efferentNeuron[d[c].length],l[c]);isNaN(f[2]),d[c].push({output:f[l[c][1]]})}this.onAction(d)}}},{key:"train",value:function(e){var t=this;this.onTrained=e.onTrained;for(var r=e.arrReward.slice(0),n=e.arrReward.length;n<this.efferentNodesCount*this.batch_size;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.efferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("efferentNodes"+o[a++],function(){return r.slice(e,e+t.efferentNodesCount)})}(i);for(var u=0;u<this.layerCount-1;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this.comp_renderer_nodes.gpufG.enableKernel(1),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return 10}),this._sce.getLoadedProject().getActiveStage().tick(),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return-3}),this.comp_renderer_nodes.gpufG.disableKernel(1),null!==this.onTrained){for(var l=[],d=0;d<this.efferentNodesCount;d++);this.onTrained(l)}}},{key:"getNeuronOutput",value:function(e,t){var r=this.comp_renderer_nodes.gpufG.readArg(t[0]),n=4*this._nodesByName[e].itemStart;return[r[n],r[n+1],r[n+2],r[n+3]]}},{key:"setLayoutArgumentData",value:function(e){this._customArgs[e.argName].nodes_array_value=e.value,this._customArgs[e.argName].links_array_value=e.value,this._customArgs[e.argName].arrows_array_value=e.value,this._customArgs[e.argName].nodestext_array_value=e.value,this.comp_renderer_nodes.setArg(e.argName,function(){return e.value});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg(e.argName,function(){return e.value});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg(e.argName,function(){return e.value});!0===this._enableFont&&this.comp_renderer_nodesText.setArg(e.argName,function(){return e.value})}},{key:"getLayoutNodeArgumentData",value:function(e){for(var t=this._nodesByName[e.nodeName],r=this._customArgs[e.argName].arg.split("*")[0],n=0;n<this.arrayNodeData.length/4;n++)if(void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*n]===t.nodeId){var o=this._customArgs[e.argName].nodes_array_value;if("float"===r){var a=n;if(void 0!==o[a]&&null!==o[a])return o[a]}else{var i=4*n;if(void 0!==o[i]&&null!==o[i])return[o[i],o[i+1],o[i+2],o[i+3]]}}}},{key:"setLayoutNodeArgumentData",value:function(e){for(var t=this,r=this._nodesByName[e.nodeName],n=this._customArgs[e.argName].arg.split("*")[0],o=function(e,r,n,o,a){if("float"===e)t._customArgs[r][n][o]=a;else{var i=4*o;t._customArgs[r][n][i]=a[0],t._customArgs[r][n][i+1]=a[1],t._customArgs[r][n][i+2]=a[2],t._customArgs[r][n][i+3]=a[3]}},a=0;a<this.arrayNodeData.length/4;a++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*a]===r.nodeId)o(n,e.argName,"nodes_array_value",a,e.value);else{var i="float"===n?a:4*a;void 0===this._customArgs[e.argName].nodes_array_value[i]&&null===this._customArgs[e.argName].nodes_array_value[i]&&!1===e.update&&("float"===n?o(n,e.argName,"nodes_array_value",a,0):o(n,e.argName,"nodes_array_value",a,[0,0,0,0]))}this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value});for(var s=0;s<this.linksObj.length;s++){for(var u=0;u<this.linksObj[s].arrayLinkData.length/4;u++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.linksObj[s].arrayLinkData[4*u]===r.nodeId)o(n,e.argName,"links_array_value",u,e.value);else{var l="float"===n?u:4*u;void 0===this._customArgs[e.argName].links_array_value[l]&&null===this._customArgs[e.argName].links_array_value[l]&&!1===e.update&&("float"===n?o(n,e.argName,"links_array_value",u,0):o(n,e.argName,"links_array_value",u,[0,0,0,0]))}this.linksObj[s].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}for(var d=0;d<this.arrowsObj.length;d++){for(var c=0;c<this.arrowsObj[d].arrayArrowData.length/4;c++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrowsObj[d].arrayArrowData[4*c]===r.nodeId)o(n,e.argName,"arrows_array_value",c,e.value);else{var h="float"===n?c:4*c;void 0===this._customArgs[e.argName].arrows_array_value[h]&&null===this._customArgs[e.argName].arrows_array_value[h]&&!1===e.update&&("float"===n?o(n,e.argName,"arrows_array_value",c,0):o(n,e.argName,"arrows_array_value",c,[0,0,0,0]))}this.arrowsObj[d].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){for(var f=0;f<this.arrayNodeTextData.length/4;f++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeTextData[4*f]===r.nodeId)o(n,e.argName,"nodestext_array_value",f,e.value);else{var p="float"===n?f:4*f;void 0===this._customArgs[e.argName].nodestext_array_value[p]&&null===this._customArgs[e.argName].nodestext_array_value[p]&&!1===e.update&&("float"===n?o(n,e.argName,"nodestext_array_value",f,0):o(n,e.argName,"nodestext_array_value",f,[0,0,0,0]))}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"setLayoutNodeArgumentArrayData",value:function(e){var t=this,r=this._customArgs[e.argName].arg.split("*")[0],n=-1,o=0,a=0,i=0,s=0;this._customArgs[e.argName].nodes_array_value=[];for(var u=0;u<this.arrayNodeData.length/4;u++)n!==this.arrayNodeData[4*u]?(n=this.arrayNodeData[4*u],"float"===r?(o=e.value[n],this._customArgs[e.argName].nodes_array_value.push(o)):(o=e.value[4*n],a=e.value[4*n+1],i=e.value[4*n+2],s=e.value[4*n+3],this._customArgs[e.argName].nodes_array_value.push(o,a,i,s))):"float"===r?this._customArgs[e.argName].nodes_array_value.push(o):this._customArgs[e.argName].nodes_array_value.push(o,a,i,s);this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value}),this._customArgs[e.argName].links_array_value=[];for(var l=0;l<this.linksObj.length;l++){for(var d=0;d<this.linksObj[l].arrayLinkNodeName.length;d++){var c=this.linksObj[l].arrayLinkNodeName[d],h=this._nodesByName[c].itemStart;"float"===r?this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[h]):this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[4*h],this._customArgs[e.argName].nodes_array_value[4*h+1],this._customArgs[e.argName].nodes_array_value[4*h+2],this._customArgs[e.argName].nodes_array_value[4*h+3])}this.linksObj[l].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}this._customArgs[e.argName].arrows_array_value=[];for(var f=0;f<this.arrowsObj.length;f++){for(var p=0;p<this.arrowsObj[f].arrayArrowNodeName.length;p++){var m=this.arrowsObj[f].arrayArrowNodeName[p],g=this._nodesByName[m].itemStart;"float"===r?this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[g]):this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[4*g],this._customArgs[e.argName].nodes_array_value[4*g+1],this._customArgs[e.argName].nodes_array_value[4*g+2],this._customArgs[e.argName].nodes_array_value[4*g+3])}this.arrowsObj[f].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){this._customArgs[e.argName].nodestext_array_value=[];for(var _=0;_<this.arrayNodeTextNodeName.length;_++){var v=this.arrayNodeTextNodeName[_],x=this._nodesByName[v].itemStart;"float"===r?this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[x]):this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[4*x],this._customArgs[e.argName].nodes_array_value[4*x+1],this._customArgs[e.argName].nodes_array_value[4*x+2],this._customArgs[e.argName].nodes_array_value[4*x+3])}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"addNode",value:function(e){if(!1===this._nodesByName.hasOwnProperty(e.name)){var t=this.createNode(e);return this._nodesByName[e.name]=t,this._nodesById[t.nodeId]=t,void 0!==t.label&&null!==t.label&&!0===this._enableFont&&this.createNodeText(t),console.log("%cnode "+Object.keys(this._nodesByName).length+" ("+e.name+")","color:green"),e.name}return console.log("node "+e.name+" already exists"),!1}},{key:"createNode",value:function(e){var t=this.nodeArrayItemStart,r=void 0!==e.position&&null!==e.position?e.position:[100*Math.random()-50,100*Math.random()-50,100*Math.random()-50,1],n=e.color,o=-1;if(void 0!==n&&null!==n&&n.constructor===String){if(!1===this.objNodeImages.hasOwnProperty(n)){var a=Object.keys(this.objNodeImages).length;this.objNodeImages[n]=a,this.addNodesImage(n,a)}o=this.objNodeImages[n]}for(var i=0;i<this.mesh_nodes.vertexArray.length/4;i++){var s=4*i,u=this.getBornDieTS(e.bornDate,e.dieDate);if(this.arrayNodeData.push(this.currentNodeId,0,u.bornDate,u.dieDate),this.arrayNodeDataB.push(u.bornDate,u.dieDate,0,0),this.arrayNodeDataF.push(0,0,0,0),this.arrayNodeDataG.push(0,0,0,0),this.arrayNodeDataH.push(0,0,0,0),this.arrayNodePosXYZW.push(r[0],r[1],r[2],r[3]),this.arrayNodeDir.push(0,0,0,1),this.arrayNodeVertexPos.push(this.mesh_nodes.vertexArray[s],this.mesh_nodes.vertexArray[s+1],this.mesh_nodes.vertexArray[s+2],1),this.arrayNodeVertexNormal.push(this.mesh_nodes.normalArray[s],this.mesh_nodes.normalArray[s+1],this.mesh_nodes.normalArray[s+2],1),this.arrayNodeVertexTexture.push(this.mesh_nodes.textureArray[s],this.mesh_nodes.textureArray[s+1],this.mesh_nodes.textureArray[s+2],1),this.arrayNodeImgId.push(o),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var l in this._customArgs){var d=this._customArgs[l].arg.split("*");d.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(l)&&void 0!==e.layoutNodeArgumentData[l]&&null!==e.layoutNodeArgumentData[l]&&("float"===d[0]?this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l]):"float4"===d[0]&&this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l][0],e.layoutNodeArgumentData[l][1],e.layoutNodeArgumentData[l][2],e.layoutNodeArgumentData[l][3]))}this.nodeArrayItemStart++}for(var c=0,h=0;h<this.mesh_nodes.indexArray.length;h++){var f=h;this.arrayNodeIndices.push(this.startIndexId+this.mesh_nodes.indexArray[f]),this.mesh_nodes.indexArray[f]>c&&(c=this.mesh_nodes.indexArray[f])}return this.startIndexId+=c+1,e.nodeId=this.currentNodeId++,e.itemStart=t,e}},{key:"createNodeText",value:function(e){for(var t=function(e){return{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,"Ñ":14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26," ":27,0:28,1:29,2:30,3:31,4:32,5:33,6:34,7:35,8:36,9:37}[e]},r=0;r<this.nodesTextPlanes;r++){var n=null;void 0!==e.label&&null!==e.label&&void 0!==e.label[r]&&null!==e.label[r]&&(n=t(e.label[r].toUpperCase())),null===n&&(n=t(" "));for(var o=0;o<this.mesh_nodesText.vertexArray.length/4;o++){var a=4*o;if(this.arrayNodeTextData.push(e.nodeId,0,0,0),this.arrayNodeTextPosXYZW.push(0,0,0,1),this.arrayNodeTextVertexPos.push(this.mesh_nodesText.vertexArray[a]+5*r,this.mesh_nodesText.vertexArray[a+1],this.mesh_nodesText.vertexArray[a+2],1),this.arrayNodeTextVertexNormal.push(this.mesh_nodesText.normalArray[a],this.mesh_nodesText.normalArray[a+1],this.mesh_nodesText.normalArray[a+2],1),this.arrayNodeTextVertexTexture.push(this.mesh_nodesText.textureArray[a],this.mesh_nodesText.textureArray[a+1],this.mesh_nodesText.textureArray[a+2],1),this.arrayNodeTextNodeName.push(e.name),this.arrayNodeText_itemStart.push(e.itemStart),this.arrayNodeTextLetterId.push(n),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.layoutNodeArgumentData[i]&&null!==e.layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i][0],e.layoutNodeArgumentData[i][1],e.layoutNodeArgumentData[i][2],e.layoutNodeArgumentData[i][3]))}this.nodeTextArrayItemStart++}}for(var u=0,l=0;l<this.nodesTextPlanes;l++)for(var d=0;d<this.mesh_nodesText.indexArray.length;d++){var c=d,h=4*l,f=this.mesh_nodesText.indexArray[c]+h;this.arrayNodeTextIndices.push(this.startIndexId_nodestext+f),f>u&&(u=f)}this.startIndexId_nodestext+=u+1,this.currentNodeTextId++}},{key:"addNodesImage",value:function(e,t){this._stackNodesImg.push({url:e,locationIdx:t})}},{key:"generateNodesImage",value:function(){var e=this;!1===this.nodesImgMaskLoaded?(this.nodesImgMask=new Image,this.nodesImgMask.onload=function(){e.nodesImgMaskLoaded=!0,e.generateNodesImage()},this.nodesImgMask.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgMask.png"):!1===this.nodesImgCrosshairLoaded?(this.nodesImgCrosshair=new Image,this.nodesImgCrosshair.onload=function(){e.nodesImgCrosshairLoaded=!0,e.generateNodesImage()},this.nodesImgCrosshair.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgCrosshair.png"):new c.ProccessImg({stackNodesImg:this._stackNodesImg,NODE_IMG_WIDTH:this.NODE_IMG_WIDTH,NODE_IMG_COLUMNS:this.NODE_IMG_COLUMNS,nodesImgMask:this.nodesImgMask,nodesImgCrosshair:this.nodesImgCrosshair,onend:function(t){e.comp_renderer_nodes.setArg("nodesImg",function(){return t.nodesImg}),e.comp_renderer_nodes.setArg("nodesImgCrosshair",function(){return t.nodesImgCrosshair})}})}},{key:"addLink",value:function(e){var t=!0;if(void 0===this._nodesByName[e.origin]&&null===this._nodesByName[e.origin]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.origin+" not exists","color:red"),t=!1),void 0===this._nodesByName[e.target]&&null===this._nodesByName[e.target]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.target+" not exists","color:red"),t=!1),e.origin===e.target&&!1===this._enableAutoLink&&(console.log("%cDiscarting autolink "+e.origin+"->"+e.target,"color:orange"),t=!1),!0===t){console.log("%clink "+e.origin+"->"+e.target,"color:green"),e.origin_nodeName=e.origin.toString(),e.target_nodeName=e.target.toString(),e.origin_nodeId=this._nodesByName[e.origin].nodeId,e.target_nodeId=this._nodesByName[e.target].nodeId,e.origin_itemStart=this._nodesByName[e.origin].itemStart,e.target_itemStart=this._nodesByName[e.target].itemStart,e.origin_layoutNodeArgumentData=this._nodesByName[e.origin].layoutNodeArgumentData,e.target_layoutNodeArgumentData=this._nodesByName[e.target].layoutNodeArgumentData;var r=this.getBornDieTS(e.bornDate,e.dieDate);e.bornDate=r.bornDate,e.dieDate=r.dieDate,e.activationFunc=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,e.weight=void 0!==e.weight&&null!==e.weight&&e.weight.constructor===String?Math.random():e.weight||1,e.linkMultiplier=void 0!==e.linkMultiplier&&null!==e.linkMultiplier?e.linkMultiplier:1;for(var n=1;;){if(!0!==(this._links.hasOwnProperty(e.origin+"->"+e.target+"_"+n)||this._links.hasOwnProperty(e.target+"->"+e.origin+"_"+n)))break;n++}e.repeatId=n,void 0!==(e=this.createLink(e)).directed&&null!==e.directed&&!0===e.directed&&(void 0!==e.showArrow&&null!==e.showArrow&&!1===e.showArrow||this.createArrow(e)),this._links[e.origin+"->"+e.target+"_"+n]=e;for(var o=0;o<this.arrayNodeData.length/4;o++){var a=4*o;this.arrayNodeData[a]===this._nodesByName[e.origin].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1),this.arrayNodeData[a]===this._nodesByName[e.target].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1)}}}},{key:"createLink",value:function(e){this.currentLinkId%6e4==0&&this.createLinksObjItem();for(var t=0;t<2*this.lineVertexCount;t++)if(this.linksObj[this.currentLinksObjItem].arrayLinkData.push(e.origin_nodeId,e.target_nodeId,Math.ceil(t/2),e.repeatId),this.linksObj[this.currentLinksObjItem].arrayLinkDataC.push(e.bornDate,e.dieDate,e.weight,0),Math.ceil(t/2)!==this.lineVertexCount-1?this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.origin_nodeName):this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.target_nodeName),this.linksObj[this.currentLinksObjItem].arrayLinkPosXYZW.push(0,0,0,1),this.linksObj[this.currentLinksObjItem].arrayLinkVertexPos.push(0,0,0,1),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var r in this._customArgs){var n=this._customArgs[r].arg.split("*");n.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(r)&&void 0!==e.origin_layoutNodeArgumentData[r]&&null!==e.origin_layoutNodeArgumentData[r]&&("float"===n[0]?this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r]):"float4"===n[0]&&this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r][0],e.origin_layoutNodeArgumentData[r][1],e.origin_layoutNodeArgumentData[r][2],e.origin_layoutNodeArgumentData[r][3]))}for(var o=0;o<2*this.lineVertexCount;o++)this.linksObj[this.currentLinksObjItem].arrayLinkIndices.push(this.linksObj[this.currentLinksObjItem].startIndexId_link++);return this.currentLinkId+=2,e.linkId=this.currentLinkId-2,e}},{key:"createArrow",value:function(e){this.currentArrowId%2e4==0&&this.createArrowsObjItem(),void 0!==e&&null!==e&&void 0!==e.node&&null!==e.node&&(this.mesh_arrows=e.node);for(var t=0;t<2;t++){for(var r=0;r<this.mesh_arrows.vertexArray.length/4;r++){var n=4*r;if(0===t&&this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart,this.arrowsObj[this.currentArrowsObjItem].arrayArrowPosXYZW.push(0,0,0,1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexPos.push(this.mesh_arrows.vertexArray[n],this.mesh_arrows.vertexArray[n+1],this.mesh_arrows.vertexArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexNormal.push(this.mesh_arrows.normalArray[n],this.mesh_arrows.normalArray[n+1],this.mesh_arrows.normalArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexTexture.push(this.mesh_arrows.textureArray[n],this.mesh_arrows.textureArray[n+1],this.mesh_arrows.textureArray[n+2],1),0===t){if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.origin_nodeId,e.target_nodeId,0,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.origin_nodeName),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var o in this._customArgs){var a=this._customArgs[o].arg.split("*");a.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(o)&&void 0!==e.origin_layoutNodeArgumentData[o]&&null!==e.origin_layoutNodeArgumentData[o]&&("float"===a[0]?this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o]):"float4"===a[0]&&this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o][0],e.origin_layoutNodeArgumentData[o][1],e.origin_layoutNodeArgumentData[o][2],e.origin_layoutNodeArgumentData[o][3]))}}else if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.target_nodeId,e.origin_nodeId,1,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.target_nodeName),void 0!==e.target_layoutNodeArgumentData&&null!==e.target_layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.target_layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.target_layoutNodeArgumentData[i]&&null!==e.target_layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i][0],e.target_layoutNodeArgumentData[i][1],e.target_layoutNodeArgumentData[i][2],e.target_layoutNodeArgumentData[i][3]))}this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart++}for(var u=0,l=0;l<this.mesh_arrows.indexArray.length;l++){var d=l;this.arrowsObj[this.currentArrowsObjItem].arrayArrowIndices.push(this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+this.mesh_arrows.indexArray[d]),this.mesh_arrows.indexArray[d]>u&&(u=this.mesh_arrows.indexArray[d])}this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+=u+1,this.currentArrowId++}}},{key:"updateNodes",value:function(){var e=this;console.log(this.currentNodeId+" nodes"),this._ADJ_MATRIX_WIDTH=this._MAX_ADJ_MATRIX_WIDTH,this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var n=0;n<this.linksObj.length;n++)this.linksObj[n].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);for(var o=0;o<this.arrowsObj.length;o++)this.arrowsObj[o].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var s=0;s<this.linksObj.length;s++)this.linksObj[s].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var u=0;u<this.arrowsObj.length;u++)this.arrowsObj[u].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData}),this.comp_renderer_nodes.setArg("dataB",function(){return e.arrayNodeDataB}),this.comp_renderer_nodes.setArg("dataF",function(){return e.arrayNodeDataF}),this.comp_renderer_nodes.setArg("dataG",function(){return e.arrayNodeDataG}),this.comp_renderer_nodes.setArg("dataH",function(){return e.arrayNodeDataH}),void 0!==this.comp_renderer_nodes.getBuffers().posXYZW&&null!==this.comp_renderer_nodes.getBuffers().posXYZW&&(this.arrayNodePosXYZW=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("posXYZW"))),this.comp_renderer_nodes.setArg("posXYZW",function(){return e.arrayNodePosXYZW}),this.comp_renderer_nodes.setArg("nodeVertexPos",function(){return e.arrayNodeVertexPos}),this.comp_renderer_nodes.setArg("nodeVertexNormal",function(){return e.arrayNodeVertexNormal}),this.comp_renderer_nodes.setArg("nodeVertexTexture",function(){return e.arrayNodeVertexTexture}),this.comp_renderer_nodes.setArg("nodesCount",function(){return e.currentNodeId}),this._MAX_ADJ_MATRIX_WIDTH=this.currentNodeId,this.comp_renderer_nodes.setArg("nodeImgColumns",function(){return e.NODE_IMG_COLUMNS}),this.comp_renderer_nodes.setArg("nodeImgId",function(){return e.arrayNodeImgId}),this.comp_renderer_nodes.setArg("indices",function(){return e.arrayNodeIndices}),void 0!==this.comp_renderer_nodes.getBuffers().dir&&null!==this.comp_renderer_nodes.getBuffers().dir&&(this.arrayNodeDir=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("dir"))),this.comp_renderer_nodes.setArg("dir",function(){return e.arrayNodeDir}),this.comp_renderer_nodes.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodes.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodes.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return e.currentTrainLayer}),this.comp_renderer_nodes.setArg("afferentNodesCount",function(){return e.afferentNodesCount}),this.comp_renderer_nodes.setArg("efferentNodesCount",function(){return e.efferentNodesCount}),this.comp_renderer_nodes.setArg("efferentStart",function(){return e.currentNodeId-e.efferentNodesCount}),this.comp_renderer_nodes.setArg("afferentNodesA",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesA",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesB",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesB",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesC",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesC",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesD",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesD",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesE",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesE",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesF",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesF",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesG",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesG",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("isNode",function(){return 1}),this.comp_renderer_nodes.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W});for(var l in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodes.setArg(t,function(){return e._customArgs[t].nodes_array_value})}(l);this.generateNodesImage(),!0===this._enableFont&&this.updateNodesText()}},{key:"updateNodesText",value:function(){var e=this;this.comp_renderer_nodesText.setArg("data",function(){return e.arrayNodeTextData}),this.comp_renderer_nodesText.getComponentBufferArg("posXYZW",this.comp_renderer_nodes),this.comp_renderer_nodesText.setArg("nodeVertexPos",function(){return e.arrayNodeTextVertexPos}),this.comp_renderer_nodesText.setArg("nodeVertexNormal",function(){return e.arrayNodeTextVertexNormal}),this.comp_renderer_nodesText.setArg("nodeVertexTexture",function(){return e.arrayNodeTextVertexTexture}),this.comp_renderer_nodesText.setArg("fontImgColumns",function(){return e.FONT_IMG_COLUMNS}),this.comp_renderer_nodesText.setArg("letterId",function(){return e.arrayNodeTextLetterId}),this.comp_renderer_nodesText.setArg("indices",function(){return e.arrayNodeTextIndices}),this.comp_renderer_nodesText.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodesText.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodesText.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodesText.setArg("isNodeText",function(){return 1}),this.comp_renderer_nodesText.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),this.comp_renderer_nodesText.setArg("bufferTextsWidth",function(){return e.comp_renderer_nodesText.getBuffers().data.W});for(var t in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodesText.setArg(t,function(){return e._customArgs[t].nodestext_array_value})}(t)}},{key:"updateLinks",value:function(){var e=this;console.log(Object.keys(this._links).length+" links"),this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData});for(var t=0;t<this.linksObj.length;t++)!function(t){e.linksObj[t].componentRenderer.setArg("data",function(){return e.linksObj[t].arrayLinkData}),e.linksObj[t].componentRenderer.setArg("dataC",function(){return e.linksObj[t].arrayLinkDataC}),e.linksObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.linksObj[t].arrayLinkVertexPos}),e.linksObj[t].componentRenderer.setArg("indices",function(){return e.linksObj[t].arrayLinkIndices}),e.linksObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.linksObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.linksObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.linksObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.linksObj[t].componentRenderer.setArg("isLink",function(){return 1}),e.linksObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.linksObj[t].componentRenderer.setArg("bufferLinksWidth",function(){return e.linksObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.linksObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].links_array_value})}(r)}(t);this.updateArrows(),Object.keys(this._links).length>0&&this.updateAdjMat()}},{key:"updateArrows",value:function(){for(var e=this,t=0;t<this.arrowsObj.length;t++)!function(t){e.arrowsObj[t].componentRenderer.setArg("data",function(){return e.arrowsObj[t].arrayArrowData}),e.arrowsObj[t].componentRenderer.setArg("dataC",function(){return e.arrowsObj[t].arrayArrowDataC}),e.arrowsObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.arrowsObj[t].arrayArrowVertexPos}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexNormal",function(){return e.arrowsObj[t].arrayArrowVertexNormal}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexTexture",function(){return e.arrowsObj[t].arrayArrowVertexTexture}),e.arrowsObj[t].componentRenderer.setArg("indices",function(){return e.arrowsObj[t].arrayArrowIndices}),e.arrowsObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.arrowsObj[t].componentRenderer.setArg("isArrow",function(){return 1}),e.arrowsObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.arrowsObj[t].componentRenderer.setArg("bufferArrowsWidth",function(){return e.arrowsObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.arrowsObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].arrows_array_value})}(r)}(t)}},{key:"updateAdjMat",value:function(){var e=this,t=function(t,r,n,o,a,i,s,u,l,d){var c=4*r;e.arrAdjMatrix[c]=a,e.arrAdjMatrix[c+1]=i,e.arrAdjMatrix[c+2]=!0===t?e.disabVal:s,e.arrAdjMatrix[c+3]=!0===t?1:.5,e.arrAdjMatrixB[c]=u,e.arrAdjMatrixB[c+1]=l,e.arrAdjMatrixB[c+2]=n,e.arrAdjMatrixB[c+3]=o,e.arrAdjMatrixC[c]=0,e.arrAdjMatrixC[c+1]=d,e.arrAdjMatrixC[c+2]=0,e.arrAdjMatrixC[c+3]=0};this.arrAdjMatrix=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixB=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixC=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4);for(var r in this._links){var n=this._links[r].origin_nodeId,o=this._links[r].target_nodeId,a=o*this._ADJ_MATRIX_WIDTH+n,i=n*this._ADJ_MATRIX_WIDTH+o;t(!0,a,o,n,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,-99),t(!1,i,n,o,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,this._links[r].layerNum)}this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return e.arrAdjMatrix}),this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return e.arrAdjMatrixB}),this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return e.arrAdjMatrixC})}},{key:"adjacencyMatrixToImage",value:function(e,t,r){var n=this;!function(e,t,o){var a=Utils.getCanvasFromUint8Array(e,t,o);n._utils.getImageFromCanvas(a,function(e){r(e)})}(function(e){for(var t=new Uint8Array(4*e.length),r=0;r<e.length;r++){var n=4*r;t[n]=255*e[r],t[n+1]=255*e[r],t[n+2]=255*e[r],t[n+3]=255}return t}(e),t,t)}},{key:"enableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 1});this._enabledForceLayout=!0}},{key:"disableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 0});this._enabledForceLayout=!1}},{key:"enableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 1})}},{key:"disableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 0})}},{key:"enableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 1});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 1})}},{key:"disableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 0})}}],[{key:"datetimeToTimestamp",value:function(e){return Date.parse(e)}},{key:"timestampToDate",value:function(e){var t=new Date(e);return(t=t.toISOString().split("T")[0].split("-"))[2]+"/"+t[1]+"/"+t[0]}}]),e}();o.Graph=h,t.exports.Graph=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./KERNEL_ADJMATRIX_UPDATE.class":3,"./KERNEL_DIR.class":4,"./ProccessImg.class":5,"./VFP_NODE.class":6,"./VFP_NODEPICKDRAG.class":7,scejs:1}],3:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.KERNEL_ADJMATRIX_UPDATE=function(){function e(){n(this,e)}return o(e,null,[{key:"getSrc",value:function(e){return["x",["adjacencyMatrix"],"","vec4 adjMat = adjacencyMatrix[x]; \n            vec4 adjMatB = adjacencyMatrixB[x]; \n            vec4 adjMatC = adjacencyMatrixC[x]; \n\n            float linkBornDate = adjMat.x;\n            float linkDieDate = adjMat.y;\n            float linkWeight = adjMat.z;\n            float linkTypeParent = adjMat.w;\n\n            float id = adjMatB.z;\n            float idInv = adjMatB.w;\n            float linkLayerNum = adjMatC.y;\n\n           if(linkTypeParent == 0.5) {\n                vec2 xGeometryCurrentChild = get_global_id(id, bufferNodesWidth, "+e.toFixed(1)+");\n                vec2 xGeometryParent = get_global_id(idInv, bufferNodesWidth, "+e.toFixed(1)+");\n\n                float childGOutputA = dataB[xGeometryCurrentChild].z;\n                float parentGErrorA = dataB[xGeometryParent].w;\n                \n                float childGOutputB = dataF[xGeometryCurrentChild].x;\n                float parentGErrorB = dataF[xGeometryParent].y;\n                \n                float childGOutputC = dataF[xGeometryCurrentChild].z;\n                float parentGErrorC = dataF[xGeometryParent].w;\n                \n                float childGOutputD = dataG[xGeometryCurrentChild].x;\n                float parentGErrorD = dataG[xGeometryParent].y;\n                \n                float childGOutputE = dataG[xGeometryCurrentChild].z;\n                float parentGErrorE = dataG[xGeometryParent].w;\n                \n                float childGOutputF = dataH[xGeometryCurrentChild].x;\n                float parentGErrorF = dataH[xGeometryParent].y;\n                \n                float childGOutputG = dataH[xGeometryCurrentChild].z;\n                float parentGErrorG = dataH[xGeometryParent].w;                \n            \n                if(linkLayerNum > 0.0) {                        \n                    float learningRate = 0.01;\n                    float l2_decay = 0.01;\n                    float cpu_batch_repeats = 7.0;\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputA*parentGErrorA))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputB*parentGErrorB))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputC*parentGErrorC))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputD*parentGErrorD))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputE*parentGErrorE))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputF*parentGErrorF))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputG*parentGErrorG))/(7.0*cpu_batch_repeats));\n                }\n            }\n            \n            return [vec4(linkBornDate, linkDieDate, linkWeight, linkTypeParent)];\n            "]}}]),e}();e.KERNEL_ADJMATRIX_UPDATE=a,t.exports.KERNEL_ADJMATRIX_UPDATE=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.KERNEL_DIR=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("./graphUtil"),s=r.KERNEL_DIR=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t,r,n,o){var a=null,s=null;return!0===o?(a=["dir","posXYZW","dataB","dataF","dataG","dataH"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0), currentDataB, currentDataF, currentDataG, currentDataH];"):(a=["dir","posXYZW"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0)];"),["x",a,i.GraphUtils.adjMatrix_ForceLayout_GLSLFunctionString(t,r,n),"float nodeId = data[x].x;\n                    float numOfConnections = data[x].y;\n                    vec2 xGeometry = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n\n\n                    vec3 currentPos = posXYZW[xGeometry].xyz;\n\n                    float bornDate = dataB[xGeometry].x;\n                    float dieDate = dataB[xGeometry].y;\n\n                    vec3 currentDir = dir[xGeometry].xyz;\n\n\n                    vec4 currentDataB = dataB[xGeometry];\n                    vec4 currentDataF = dataF[xGeometry];\n                    vec4 currentDataG = dataG[xGeometry];\n                    vec4 currentDataH = dataH[xGeometry];\n\n                    currentDir = vec3(0.0, 0.0, 0.0);\n\n                    if(enableForceLayout == 1.0) {\n                        idAdjMatrixResponse adjM = idAdjMatrix_ForceLayout(nodeId, currentPos, currentDir, numOfConnections, currentTimestamp, bornDate, dieDate, enableNeuronalNetwork);\n                        currentDir = (adjM.collisionExists == 1.0) ? adjM.force : currentDir+(adjM.force*1.0);\n\n                        if(enableNeuronalNetwork == 1.0 && currentTrainLayer == -3.0) {\n                            currentDataB = vec4(currentDataB.x, currentDataB.y, adjM.netFOutputA, adjM.netErrorWeightA);\n                            currentDataF = vec4(adjM.netFOutputB, adjM.netErrorWeightB, adjM.netFOutputC, adjM.netErrorWeightC);\n                            currentDataG = vec4(adjM.netFOutputD, adjM.netErrorWeightD, adjM.netFOutputE, adjM.netErrorWeightE);\n                            currentDataH = vec4(adjM.netFOutputF, adjM.netErrorWeightF, adjM.netFOutputG, adjM.netErrorWeightG);\n                        }\n                    }\n\n                    "+(void 0!==e?e:"")+"\n\n                    if(enableDrag == 1.0) {\n                        if(nodeId == idToDrag) {\n                            currentPos = vec3(MouseDragTranslationX, MouseDragTranslationY, MouseDragTranslationZ);\n                        }\n                    }\n\n                    currentPos += currentDir;\n                    if(only2d == 1.0) {\n                        currentPos.y = 0.0;\n                    }\n\n                    "+s]}}]),e}();n.KERNEL_DIR=s,t.exports.KERNEL_DIR=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":9}],5:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ProccessImg=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.ProccessImg=function(){function e(t){o(this,e),this.stackNodesImg=t.stackNodesImg,this.drawedImages=0,this.output={nodesImg:null,nodesImgCrosshair:null};var r=t.NODE_IMG_WIDTH;this.NODE_IMG_COLUMNS=t.NODE_IMG_COLUMNS,this.NODE_IMG_SPRITE_WIDTH=r/this.NODE_IMG_COLUMNS;var n=t.nodesImgMask;this.datMask=Utils.getUint8ArrayFromHTMLImageElement(n);var a=t.nodesImgCrosshair;this.datCrosshair=Utils.getUint8ArrayFromHTMLImageElement(a),this.canvasNodeImg=document.createElement("canvas"),this.canvasNodeImg.width=r,this.canvasNodeImg.height=r,this.ctxNodeImg=this.canvasNodeImg.getContext("2d"),this.canvasNodeImgCrosshair=document.createElement("canvas"),this.canvasNodeImgCrosshair.width=r,this.canvasNodeImgCrosshair.height=r,this.ctxNodeImgCrosshair=this.canvasNodeImgCrosshair.getContext("2d");var i=document.createElement("canvas");i.width=this.NODE_IMG_SPRITE_WIDTH,i.height=this.NODE_IMG_SPRITE_WIDTH;for(var s=i.getContext("2d"),u=0;u<this.stackNodesImg.length;u++){var l=this.stackNodesImg[u],d=new Image;d.onload=function(e,r){s.clearRect(0,0,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH);var n=this.NODE_IMG_SPRITE_WIDTH/4;s.drawImage(e,0,0,e.width,e.height,n,n,this.NODE_IMG_SPRITE_WIDTH/2,this.NODE_IMG_SPRITE_WIDTH/2),(new Utils).getImageFromCanvas(i,function(e,r){e.image=Utils.getUint8ArrayFromHTMLImageElement(r);for(var n=!0,o=0;o<this.stackNodesImg.length;o++)if(null==this.stackNodesImg[o].image){n=!1;break}!0===n&&this.generateAll(t)}.bind(this,r))}.bind(this,d,l),d.src=l.url}}return a(e,[{key:"generateAll",value:function(e){for(var t=function(t,r,n){var o=this,a=function(e,t){var r=e/t,n=parseFloat(parseInt(r));return{col:Utils.fract(r)*t,row:n}}.bind(this),i=function(e){var t=function(e,t,r){this.output[t]=r,null!=this.output.nodesImg&&null!=this.output.nodesImgCrosshair&&e(this.output)}.bind(this,e);(new Utils).getImageFromCanvas(this.canvasNodeImg,function(e){t("nodesImg",e)}.bind(this)),(new Utils).getImageFromCanvas(this.canvasNodeImgCrosshair,function(e){t("nodesImgCrosshair",e)}.bind(this))}.bind(this,e.onend);(new Utils).getImageFromCanvas(Utils.getCanvasFromUint8Array(n,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH),function(e){var n=a(t.locationIdx,o.NODE_IMG_COLUMNS);r.drawImage(e,n.col*o.NODE_IMG_SPRITE_WIDTH,n.row*o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH),o.drawedImages++,o.drawedImages===2*o.stackNodesImg.length&&i()})}.bind(this),r=0;r<this.stackNodesImg.length;r++){for(var n=this.stackNodesImg[r],o=this.stackNodesImg[r].image,a=0;a<this.datMask.length/4;a++){var i=4*a;o[i+3]>0&&(o[i+3]=this.datMask[i+3])}t(n,this.ctxNodeImg,o);for(var s=0;s<this.datCrosshair.length/4;s++){var u=4*s;o[u]=(this.datCrosshair[u]*this.datCrosshair[u+3]+o[u]*(255-this.datCrosshair[u+3]))/255,o[u+1]=(this.datCrosshair[u+1]*this.datCrosshair[u+3]+o[u+1]*(255-this.datCrosshair[u+3]))/255,o[u+2]=(this.datCrosshair[u+2]*this.datCrosshair[u+3]+o[u+2]*(255-this.datCrosshair[u+3]))/255,o[u+3]=(this.datCrosshair[u+3]*this.datCrosshair[u+3]+o[u+3]*(255-this.datCrosshair[u+3]))/255}t(n,this.ctxNodeImgCrosshair,o)}}}]),e}();n.ProccessImg=i,t.exports.ProccessImg=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],6:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODE=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./graphUtil"),s=r.VFP_NODE=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t){return[["RGB"],"varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\nvec2 get2Dfrom1D(float idx, float columns) {float n = idx/columns;float row = float(int(n));float col = fract(n)*columns;float ts = 1.0/columns;return vec2(ts*col, ts*row);}mat4 lookAt(vec3 eye, vec3 center, vec3 up) {vec3 zaxis = normalize(center - eye);vec3 xaxis = normalize(cross(up, zaxis));vec3 yaxis = cross(zaxis, xaxis);mat4 matrix;matrix[0][0] = xaxis.x;matrix[1][0] = yaxis.x;matrix[2][0] = zaxis.x;matrix[3][0] = 0.0;matrix[0][1] = xaxis.y;matrix[1][1] = yaxis.y;matrix[2][1] = zaxis.y;matrix[3][1] = 0.0;matrix[0][2] = xaxis.z;matrix[1][2] = yaxis.z;matrix[2][2] = zaxis.z;matrix[3][2] = 0.0;matrix[0][3] = -dot(xaxis, eye);matrix[1][3] = -dot(yaxis, eye);matrix[2][3] = -dot(zaxis, eye);matrix[3][3] = 1.0;return matrix;}mat4 transpose(mat4 m) {return mat4(  m[0][0], m[1][0], m[2][0], m[3][0],m[0][1], m[1][1], m[2][1], m[3][1],m[0][2], m[1][2], m[2][2], m[3][2],m[0][3], m[1][3], m[2][3], m[3][3]);}mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}"+i.GraphUtils.adjMatrix_Autolink_GLSLFunctionString(t)+Utils.degToRadGLSLFunctionString()+Utils.radToDegGLSLFunctionString()+Utils.cartesianToSphericalGLSLFunctionString()+Utils.sphericalToCartesianGLSLFunctionString()+Utils.getVectorGLSLFunctionString()+"vec3 getVV(vec3 crB, float acum) {vec3 ob = cartesianToSpherical(crB);float angleLat = ob.y;float angleLng = ob.z;float desvLat = 0.0;float desvLng = 10.0;angleLng += (acum*desvLng);return sphericalToCartesian(vec3(1.0, angleLat, angleLng));}float getOddEven(float repeatId) {return (ceil(fract(repeatId/2.0)) == 0.0) ? 1.0*floor(repeatId/2.0) : -1.0*floor(repeatId/2.0);}vec3 getFirstDispl(float nodeId, vec4 currentPosition, float repeatId) {float repeatDistribution = -0.1;vec4 adjMatrix = idAdjMatrix_Autolink(nodeId, currentPosition.xyz);vec3 initialVec = normalize(posXYZW[adjMatrix.xy].xyz-currentPosition.xyz)*vec3(1.0, -1.0, 1.0);float totalAngleRelations = adjMatrix.z;initialVec = getVV(initialVec, (totalAngleRelations/2.0)*repeatDistribution);return getVV(initialVec, getOddEven(repeatId)*totalAngleRelations*0.01);}float checkLinkArrowVisibility(float currentTimestamp, float bornDate, float dieDate, float bornDateOpposite, float dieDateOpposite, float linkBornDate, float linkDieDate) {float visible =1.0;if(dieDate != 0.0) {if((currentTimestamp < bornDate || currentTimestamp > dieDate) || (currentTimestamp < bornDateOpposite || currentTimestamp > dieDateOpposite)) {visible = 0.0;} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}return visible;}","float nodeId = data[].x;float nodeIdOpposite = data[].y;float currentLineVertex = data[].z;float repeatId = data[].w;vec2 xGeometryNode = get_global_id(nodeId, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryNode_opposite = get_global_id(nodeIdOpposite, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryLinks = get_global_id(nodeId, bufferLinksWidth, 2.0);vec2 xGeometryLinks_opposite = get_global_id(nodeIdOpposite, bufferLinksWidth, 2.0);vec2 xGeometryArrows = get_global_id(nodeId, bufferArrowsWidth, 3.0);vec2 xGeometryArrows_opposite = get_global_id(nodeIdOpposite, bufferArrowsWidth, 3.0);vec2 xGeometryText = get_global_id(nodeId, bufferTextsWidth, 4.0*12.0);vec2 xGeometryText_opposite = get_global_id(nodeIdOpposite, bufferTextsWidth, 4.0*12.0);vec4 nodeVertexPosition = nodeVertexPos[];\nvec4 nodeVertexTex = nodeVertexTexture[];\nfloat linkBornDate = dataC[].x;float linkDieDate = dataC[].y;float bornDate = dataB[xGeometryNode].x;float dieDate = dataB[xGeometryNode].y;float foutput = dataB[xGeometryNode].z;float error = dataF[xGeometryNode].x;float bornDateOpposite = dataB[xGeometryNode_opposite].x;float dieDateOpposite = dataB[xGeometryNode_opposite].y;vec4 currentPosition = posXYZW[xGeometryNode];\nvec3 oppositePosition = posXYZW[xGeometryNode_opposite].xyz;\nvec4 nodeVertexColor = vec4(1.0, 1.0, 1.0, 1.0);\nvec4 nodeVertexColorNetError = vec4(1.0, 1.0, 1.0, 1.0);\nvec3 dir = oppositePosition-vec3(currentPosition.x, currentPosition.y, currentPosition.z);float dist = length(dir);float vertexCount = 1.0;float lineIncrements = dist/vertexCount;vec3 dirN = normalize(dir);vec3 cr = cross(dirN, vec3(0.0, 1.0, 0.0));float currentLineVertexSQRT = abs( currentLineVertex-(vertexCount/2.0) )/(vertexCount/2.0);currentLineVertexSQRT = sqrt(1.0-currentLineVertexSQRT);vVertexUV = vec2(-1.0, -1.0);vDist = max(0.3, 1.0-(distance(currentPosition.xyz, oppositePosition)*0.01));\nmat4 nodepos = nodeWMatrix;if(isNode == 1.0) {vVisibility = 1.0;currentPosition += vec4(0.0, 0.1, 0.0, 1.0);mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;float nodeImgId = nodeImgId[];if(nodeImgId != -1.0) {vUseTex = 1.0;vVertexUV = get2Dfrom1D(nodeImgId, nodeImgColumns)+vec2(nodeVertexTexture.x/nodeImgColumns,nodeVertexTexture.y/nodeImgColumns);}if(dieDate != 0.0 && (currentTimestamp < bornDate || currentTimestamp > dieDate)) vVisibility = 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(0.0, 0.0, 0.0, 1.0);if(foutput > 0.0) nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);else if(foutput < 0.0) nodeVertexColor = vec4(abs(foutput), 0.0, 0.0, 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}if(isLink == 1.0) {if(xGeometryLinks != xGeometryLinks_opposite) {currentPosition += vec4(dirN*(lineIncrements*currentLineVertex), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) currentPosition += vec4(cr*currentLineVertexSQRT*getOddEven(repeatId)*4.0, 1.0);} else {float currentLineVertexMM = abs( currentLineVertex-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPosition += vec4(initialVec*(5.0*currentLineVertexMM), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPosition += vec4((crB*sig)*currentLineVertexMMB*1.0, 1.0);}}vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}}if(isArrow == 1.0) {vec3 currentPositionTMP;if(xGeometryArrows != xGeometryArrows_opposite) {float currentLineVertexU = vertexCount-1.0;currentPositionTMP = oppositePosition+((dirN*-1.0)*(lineIncrements*currentLineVertexU));currentPositionTMP -= cr*(currentLineVertexSQRT*getOddEven(repeatId)*4.0);} else {float currentLineVertexU = vertexCount-1.0;float currentLineVertexMM = abs( currentLineVertexU-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPositionTMP = oppositePosition+(initialVec*(5.0*currentLineVertexMM));if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPositionTMP += (crB*sig)*currentLineVertexMMB*1.0;}}mat4 pp = lookAt(currentPositionTMP, vec3(currentPosition.x, currentPosition.y, currentPosition.z), vec3(0.0, 1.0, 0.0));pp = transpose(pp);nodepos[0][0] = pp[0][0];nodepos[0][1] = pp[1][0];nodepos[0][2] = pp[2][0];nodepos[1][0] = pp[0][1];nodepos[1][1] = pp[1][1];nodepos[1][2] = pp[2][1];nodepos[2][0] = pp[0][2];nodepos[2][1] = pp[1][2];nodepos[2][2] = pp[2][2];dir = currentPositionTMP-vec3(currentPosition.x, currentPosition.y, currentPosition.z);currentPosition += vec4(normalize(dir),1.0)*2.0;vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;}if(isNodeText == 1.0) {float letId = letterId[];\nmat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;vVertexUV = get2Dfrom1D(letId, fontImgColumns)+vec2(nodeVertexTexture.x/fontImgColumns,nodeVertexTexture.y/fontImgColumns);nodeVertexPosition = vec4(nodeVertexPosition.x*0.1, nodeVertexPosition.y*0.1, nodeVertexPosition.z*0.1, 1.0);currentPosition.z += 2.5;vVisibility = 1.0;vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}nodepos[3][0] = currentPosition.x;nodepos[3][1] = currentPosition.y;nodepos[3][2] = currentPosition.z;mat4 nodeposG = nodeWMatrix;vWNMatrix = nodeposG * nodeVertexNormal[];\nvUseCrosshair = 0.0;vIstarget = (currentLineVertex == 1.0) ? 1.0 : 0.0;"+e+"vVertexColor = nodeVertexColor;vVertexColorNetError = nodeVertexColorNetError;vUV = nodeVertexTexture;vNodeId = nodeId;\nvNodeIdOpposite = nodeIdOpposite;\ngl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPosition;\n","varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\n","vec4 color = vVertexColor;\nvec4 colorB = vVertexColorNetError;\nvec4 colorOrange = vec4(255.0/255.0, 131.0/255.0, 0.0/255.0, 1.0);vec4 colorOrangeDark = vec4(255.0/255.0, 80.0/255.0, 0.0/255.0, 1.0);vec4 colorPurple = vec4(132.0/255.0, 0.0/255.0, 255.0/255.0, 1.0);vec4 fcolor = vec4(0.0, 0.0, 0.0, 1.0);if(isNode == 1.0) {if(vUseTex == 1.0) {vec4 tex;if(vUseCrosshair == 1.0) {tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsSelected == 1.0) {color = colorOrangeDark;tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsHover == 1.0) {color = colorPurple;tex = nodesImg[vVertexUV.xy];} else {tex = nodesImg[vVertexUV.xy];}color = "+i.GraphUtils.nodesDrawMode(t)+";\n}if(color.a < 0.1) discard;fcolor = color;\nif(enableNeuronalNetwork == 1.0) {if(vUV.y > (0.7)) fcolor = colorB;\n}} else if(isLink == 1.0) {if(vIsSelected == 1.0) color = colorOrange;else if(vIsHover == 1.0) color = colorPurple;if(enableNeuronalNetwork == 1.0) {vec2 xAdjMatCurrent = get_global_id(vec2(vNodeIdOpposite, vNodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nvec4 pixAdjMatCCurrent = adjacencyMatrixC[xAdjMatCurrent];\nif(pixAdjMatACurrent.z > 0.0) fcolor = vec4(0.0, pixAdjMatACurrent.z, 0.0, 1.0);\nelse fcolor = vec4(abs(pixAdjMatACurrent.z), 0.0, 0.0, 1.0);\nif(multiplyOutput == 1.0) fcolor *= vec4(color.xyz, 1.0);\n} else fcolor = vec4(color.xyz, 1.0);\n} else if(isArrow == 1.0) {if(vIstarget == 1.0) {if(vIsSelected == 1.0) {color = vec4(colorOrange.rgb*vDist, 1.0);\n} else if(vIsHover == 1.0) {color = vec4(colorPurple.rgb*vDist, 1.0);\n}} else {color = vec4(1.0, 0.0, 0.0, 0.0);}fcolor = color;\n} else if(isNodeText == 1.0) {fcolor = fontsImg[vVertexUV.xy];\n}if(vVisibility == 0.0) discard;return [fcolor];"]}}]),e}();n.VFP_NODE=s,t.exports.VFP_NODE=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":9,scejs:1}],7:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODEPICKDRAG=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.VFP_NODEPICKDRAG=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e){return[[void 0],"varying vec4 vColor;\n"+Utils.packGLSLFunctionString()+"mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}","vec2 xGeometry = get_global_id(data[].x, uBufferWidth, "+e.toFixed(1)+");vec4 nodePosition = posXYZW[xGeometry];\nfloat bornDate = dataB[xGeometry].x;float dieDate = dataB[xGeometry].y;mat4 nodepos = nodeWMatrix;mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;nodepos[3][0] = nodePosition.x;nodepos[3][1] = nodePosition.y;nodepos[3][2] = nodePosition.z;vColor = vec4(1.0, 1.0, 1.0, 1.0);int mak = 0;if(dieDate != 0.0) {if(currentTimestamp > bornDate && currentTimestamp < dieDate) mak = 1;} else mak = 1;if(mak == 1) {vColor = pack((data[].x+1.0)/1000000.0);}if(vColor.x == 1.0 && vColor.y == 1.0 && vColor.z == 1.0 && vColor.w == 1.0) nodepos[3][0] = 10000.0;gl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPos[];\ngl_PointSize = 10.0;\n","varying vec4 vColor;\n","return [vColor];\n"]}}]),e}();n.VFP_NODEPICKDRAG=i,t.exports.VFP_NODEPICKDRAG=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],8:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.GBrain=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./Graph.class"),s=r.GBrain=function(){function e(t){o(this,e),this.project=null,this.graph=null,this.inputCount=0,this.outputCount=0,this.neuronLayers=[],this.batch_size=7,this.ini(t)}return a(e,[{key:"ini",value:function(e){var t=new SCE;t.initialize(e),this.project=new Project,t.loadProject(this.project);var r=new Stage;this.project.addStage(r),this.project.setActiveStage(r);var n=new SimpleCamera(t);n.setView(Constants.VIEW_TYPES.TOP),n.setVelocity(1),t.setDimensions(e.dimensions.width,e.dimensions.height),this.graph=new i.Graph(t,{enableFonts:!0}),this.graph.enableNeuronalNetwork(),this.graph.layerCount=0,this.graph.batch_size=this.batch_size;(new Mesh).loadPoint();this.graph.setFontsImage(t.sceDirectory+"/Prefabs/Graph/fonts.png")}},{key:"makeLayers",value:function(e){for(var t=this,r=-30,n={input:function(e){for(var n=e.depth/2*-10,o=0;o<e.depth;o++)t.graph.afferentNodesCount++,t.graph.addAfferentNeuron("input"+t.inputCount,[r,0,n,1]),t.inputCount++,n+=10;t.graph.layerCount++,r+=30},fc:function(e){var n=t.graph.createNeuronLayer(1,e.num_neurons,[r,0,0,1],5);if(t.neuronLayers.push(n),1===t.graph.layerCount)for(var o=0;o<t.inputCount;o++)t.graph.connectNeuronWithNeuronLayer({neuron:"input"+o,neuronLayer:t.neuronLayers[t.neuronLayers.length-1],activationFunc:0,weight:null,multiplier:1,layerNum:t.graph.layerCount-1});else t.graph.connectNeuronLayerWithNeuronLayer({neuronLayerOrigin:t.neuronLayers[t.neuronLayers.length-2],neuronLayerTarget:t.neuronLayers[t.neuronLayers.length-1],layerNum:t.graph.layerCount-1});t.graph.layerCount++,r+=30},regression:function(e){for(var n=e.num_neurons/2*-30,o=0;o<e.num_neurons;o++)t.graph.efferentNodesCount++,t.graph.addEfferentNeuron("output"+t.outputCount,[r,0,n,1]),t.graph.connectNeuronLayerWithNeuron({neuronLayer:t.neuronLayers[t.neuronLayers.length-1],neuron:"output"+t.outputCount,layerNum:t.graph.layerCount-1}),t.outputCount++,n+=30;t.graph.layerCount++}},o=0;o<e.length;o++){var a=e[o];n[a.type](a)}this.graph.createWebGLBuffers(),this.graph.enableForceLayout()}},{key:"forward",value:function(e,t){this.graph.forward({state:e,onAction:function(e){t(e)}})}},{key:"train",value:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var o=0;o<this.outputCount/this.batch_size;o++)o===e[n].dim?r.push(e[n].val):r.push(0);this.graph.train({arrReward:r,onTrained:function(e){t(e)}})}},{key:"enableShowOutputWeighted",value:function(){this.graph.enableShowOutputWeighted()}},{key:"disableShowOutputWeighted",value:function(){this.graph.disableShowOutputWeighted()}},{key:"tick",value:function(){this.project.getActiveStage().tick()}}]),e}();n.GBrain=s,t.exports.GBrain=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Graph.class":2,scejs:1}],9:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[8]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(o){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.Graph=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var s=e("./KERNEL_DIR.class"),u=e("./KERNEL_ADJMATRIX_UPDATE.class"),l=e("./VFP_NODE.class"),d=e("./VFP_NODEPICKDRAG.class"),c=e("./ProccessImg.class"),h=r.Graph=function(){function e(t,r){var n=this;a(this,e),this._sce=t,this._project=this._sce.getLoadedProject(),this._gl=this._project.getActiveStage().getWebGLContext(),this._utils=new Utils,this.MAX_ITEMS_PER_ARRAY=4294967295,this.NODE_IMG_COLUMNS=8,this.NODE_IMG_WIDTH=2048,this._enableFont=r&&!0===r.enableFonts,this._enableHover=!1,this._enableAutoLink=!0,this._enabledForceLayout=!1,this._MAX_ADJ_MATRIX_WIDTH=2048,this._playAnimation=!1,this._loop=!1,this._animationFrames=500,this._geometryLength=void 0===r||r&&void 0===r.nodeDrawMode||r&&"plane"===r.nodeDrawMode?4:1,this.circleSegments=12,this.nodesTextPlanes=12,this.lineVertexCount=1,this._enableNeuronalNetwork=!1,this.batch_size=null,this.layerCount=0,this.afferentNodesCount=0,this.efferentNodesCount=0,this.trainTickCount=0,this.onAction=null,this.onTrained=null,this.afferentNeuron=[],this.efferentNeuron=[],this.v_val=0,this.return_v=!1,this._only2d=!1,this.multiplyOutput=1,this._nodesByName={},this._nodesById={},this._links={},this._customArgs={},this.arrAdjMatrix=null,this.arrAdjMatrixB=null,this.arrAdjMatrixC=null,this.currentTrainLayer=-3,this._ADJ_MATRIX_WIDTH=null,this._initTimestamp=0,this._currentFrame=0,this._endTimestamp=Date.now(),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames,this.readPixel=!1,this.selectedId=-1,this._initialPosDrag=null,this._onClickNode=null,this._onAnimationStep=null,this._onAnimationEnd=null,this.mesh_nodes=1===this._geometryLength?(new Mesh).loadPoint():(new Mesh).loadQuad(4,4),this.mesh_arrows=(new Mesh).loadTriangle({scale:1.75,side:.3}),this.mesh_nodesText=(new Mesh).loadQuad(4,4),this.objNodeImages={},this._stackNodesImg=[],this.nodesImgMask=null,this.nodesImgMaskLoaded=!1,this.nodesImgCrosshair=null,this.nodesImgCrosshairLoaded=!1,this.FONT_IMG_COLUMNS=7,this.disabVal=0,this.arrayNodeData=[],this.arrayNodeDataB=[],this.arrayNodeDataF=[],this.arrayNodeDataG=[],this.arrayNodeDataH=[],this.arrayNodePosXYZW=[],this.arrayNodeVertexPos=[],this.arrayNodeVertexNormal=[],this.arrayNodeVertexTexture=[],this.startIndexId=0,this.arrayNodeIndices=[],this.arrayNodeImgId=[],this.arrayNodeDir=[],this.currentNodeId=0,this.nodeArrayItemStart=0,this.linksObj=[],this.currentLinksObjItem=-1,this.currentLinkId=0,this.arrowsObj=[],this.currentArrowsObjItem=-1,this.currentArrowId=0,this.arrayNodeTextData=[],this.arrayNodeTextNodeName=[],this.arrayNodeTextPosXYZW=[],this.arrayNodeTextVertexPos=[],this.arrayNodeTextVertexNormal=[],this.arrayNodeTextVertexTexture=[],this.startIndexId_nodestext=0,this.arrayNodeTextIndices=[],this.arrayNodeText_itemStart=[],this.arrayNodeTextLetterId=[],this.currentNodeTextId=0,this.nodeTextArrayItemStart=0,this.layout=null,this.currHiddenNeuron=0,this.nodSep=5,this.nodes=new Node,this.nodes.setName("graph_nodes"),this._project.getActiveStage().addNode(this.nodes),this.nodes.addComponent(new ComponentTransform),this.comp_renderer_nodes=new Component_GPU,this.nodes.addComponent(this.comp_renderer_nodes);var o=new ComponentMouseEvents;this.nodes.addComponent(o),o.onmousedown(function(e){n.selectedId=-1,n.mouseDown()}),o.onmouseup(function(e){if(-1!==n.selectedId){var t=n._nodesById[n.selectedId];void 0!==t&&null!==t&&void 0!==t.onmouseup&&null!==t.onmouseup&&t.onmouseup(t,e)}n.mouseUp()}),o.onmousemove(function(e,t){n.makeDrag(e,t)}),o.onmousewheel(function(e){}),this.createLinksObjItem(),this.createArrowsObjItem(),this.nodesText=null,this.comp_renderer_nodesText=null,!0===this._enableFont&&(this.nodesText=new Node,this.nodesText.setName("graph_nodesText"),this._project.getActiveStage().addNode(this.nodesText),this.nodesText.addComponent(new ComponentTransform),this.comp_renderer_nodesText=new Component_GPU,this.nodesText.addComponent(this.comp_renderer_nodesText))}return i(e,[{key:"createLinksObjItem",value:function(){this.currentLinksObjItem++,this.linksObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayLinkData:[],arrayLinkDataC:[],arrayLinkNodeName:[],arrayLinkPosXYZW:[],arrayLinkVertexPos:[],startIndexId_link:0,arrayLinkIndices:[]}),this.linksObj[this.currentLinksObjItem].node.setName("graph_links"+this.currentLinksObjItem),this._project.getActiveStage().addNode(this.linksObj[this.currentLinksObjItem].node),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentTransform),this.linksObj[this.currentLinksObjItem].node.addComponent(this.linksObj[this.currentLinksObjItem].componentRenderer)}},{key:"createArrowsObjItem",value:function(){this.currentArrowsObjItem++,this.arrowsObj.push({node:new Node,componentTransform:new ComponentTransform,componentRenderer:new Component_GPU,arrayArrowData:[],arrayArrowDataC:[],arrayArrowNodeName:[],arrayArrowPosXYZW:[],arrayArrowVertexPos:[],arrayArrowVertexNormal:[],arrayArrowVertexTexture:[],startIndexId_arrow:0,arrayArrowIndices:[],arrowArrayItemStart:0}),this.arrowsObj[this.currentArrowsObjItem].node.setName("graph_arrows"+this.currentArrowsObjItem),this._project.getActiveStage().addNode(this.arrowsObj[this.currentArrowsObjItem].node),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentTransform),this.arrowsObj[this.currentArrowsObjItem].node.addComponent(this.arrowsObj[this.currentArrowsObjItem].componentRenderer)}},{key:"onClickNode",value:function(e){this._onClickNode=e}},{key:"getBornDieTS",value:function(t,r){var n=this,o=void 0,a=void 0;if(null!=t)if(t.constructor===String)if("RANDOM"===t){var i=function(){for(var e=n._initTimestamp+Math.round(Math.random()*Math.max(0,n._animationFrames-20))*n._timeFrameIncrement,t=void 0;!((t=n._initTimestamp+Math.round(Math.random()*n._animationFrames)*n._timeFrameIncrement)>e););return{bornDate:e,dieDate:t}}();o=i.bornDate,a=i.dieDate}else o=e.datetimeToTimestamp(t),a=e.datetimeToTimestamp(r);else o=t,a=r;else o=1,a=0;return{bornDate:o,dieDate:a}}},{key:"showTimeline",value:function(e){var t=this,r=document.createElement("input");r.type="range",r.min="0",r.max=this._animationFrames.toString(),r.step="1",r.value="0",r.style.verticalAlign="middle",r.style.width="78%",e.innerText="",e.appendChild(r);r.addEventListener("input",function(e){var r=e.value;t.setFrame(r)}.bind(this,r))}},{key:"setTimelineDatetimeRange",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t.initDatetime),this._endTimestamp=e.datetimeToTimestamp(t.endDatetime),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeStart",value:function(){return this._initTimestamp}},{key:"setTimelineDatetimeRangeStart",value:function(t){this._initTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineTimestampRangeEnd",value:function(){return this._endTimestamp}},{key:"setTimelineDatetimeRangeEnd",value:function(t){this._endTimestamp=e.datetimeToTimestamp(t),this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"getTimelineRangeDates",value:function(){return{initDate:this.timestampToDate(this._initTimestamp),endDate:this.timestampToDate(this._endTimestamp)}}},{key:"getTimelineFramesLength",value:function(){return this._animationFrames}},{key:"setTimelineFramesLength",value:function(e){this._animationFrames=e,this._timeFrameIncrement=(this._endTimestamp-this._initTimestamp)/this._animationFrames}},{key:"setTimelineTimestamp",value:function(e){this._currentFrame=Math.round((e-this._initTimestamp)/this._timeFrameIncrement)}},{key:"setFrame",value:function(e){this._currentFrame=e}},{key:"getFrame",value:function(e){return this._currentFrame}},{key:"playTimeline",value:function(e){this._playAnimation=!0,void 0!==e&&(this._loop=e)}},{key:"pauseTimeline",value:function(){this._playAnimation=!1}},{key:"onAnimationStep",value:function(e){this._onAnimationStep=e}},{key:"onAnimationEnd",value:function(e){this._onAnimationEnd=e}},{key:"getNodesCount",value:function(){return Object.keys(this._nodesByName).length}},{key:"getLinksCount",value:function(){return Object.keys(this._links).length}},{key:"getNodeByName",value:function(e){return this._nodesByName[e]}},{key:"getNodeById",value:function(e){return this._nodesById[e]}},{key:"selectNode",value:function(e){this.selectedId=e,this.makeDrag(null,$V3([0,0,0]))}},{key:"getSelectedId",value:function(){return this.selectedId}},{key:"enableHover",value:function(){this._enableHover=!0,this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1)}},{key:"enableAutoLink",value:function(){this._enableAutoLink=!0}},{key:"disableAutoLink",value:function(){this._enableAutoLink=!1}},{key:"only2d",value:function(e){this._only2d=e}},{key:"setFontsImage",value:function(e){var t=this;if(!0===this._enableFont){var r=new Image;r.onload=function(){t.comp_renderer_nodesText.setArg("fontsImg",function(){return r})},r.src=e}}},{key:"setNodeMesh",value:function(e){this.mesh_nodes=e}},{key:"exportFile",value:function(){var e="[",t="";for(var r in this._nodesByName)e+=t+JSON.stringify(this._nodesByName[r]),t=",",console.log(this._nodesByName[r]);e+="]|[",t="";for(var n in this._links)e+=t+JSON.stringify(this._links[n]),t=",",console.log(this._links[n]);e+="]",console.log(e)}},{key:"importFile",value:function(e){var t=e.split("|"),r=JSON.parse(t[0]),o=JSON.parse(t[1]);for(var a in r)this.addNode({name:r[a].name,data:r[a].name,label:r[a].label,position:r[a].pos,color:0===Math.floor(n%2)?"../_RESOURCES/lena_128x128.jpg":"../_RESOURCES/cartman08.jpg",layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:r[a].pos,initDir:[0,0,0,0],nodeColor:[Math.random(),Math.random(),Math.random(),1],nodeLock:0},onmouseup:function(e){}});for(var i in o){var s=o[i].origin_nodeName,u=o[i].target_nodeName;this.addLink({origin:s,target:u,directed:!0})}}},{key:"loadRBFromFile",value:function(e,t,r,n){var o=this,a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",function(e){console.log("RB file Loaded"),o.loadRBFromStr({data:e.target.responseText,generateBornAndDieDates:r,randomLinkWeights:n}),void 0!==t&&null!==t&&t()}),a.addEventListener("error",function(e){console.log(e)}),a.send(null)}},{key:"loadRBFromStr",value:function(e){var t=e.data,r=t.split("\r\n");1===r.length&&(r=t.split("\n"));var n=r[0].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==n[0]&&null!==n[0]&&n[0],void 0!==n[1]&&null!==n[1]&&n[1];console.log(n);var o=r[1].replace(/(\s|\t)+/gi," ").trim().split(" "),a=(void 0!==o[0]&&null!==o[0]&&parseInt(o[0]),void 0!==o[1]&&null!==o[1]?parseInt(o[1]):null),i=void 0!==o[2]&&null!==o[2]?parseInt(o[2]):null;void 0!==o[3]&&null!==o[3]&&parseInt(o[3]),void 0!==o[4]&&null!==o[4]&&parseInt(o[4]);console.log(o);var s=r[2].replace(/(\s|\t)+/gi," ").trim().split(" "),u=(void 0!==s[0]&&null!==s[0]&&s[0],void 0!==s[1]&&null!==s[1]?parseInt(s[1]):null);void 0!==s[2]&&null!==s[2]&&parseInt(s[2]),void 0!==s[3]&&null!==s[3]&&parseInt(s[3]),void 0!==s[4]&&null!==s[4]&&parseInt(s[4]);console.log(s);var l=r[3].replace(/(\s|\t)+/gi," ").trim().split(" ");void 0!==l[0]&&null!==l[0]&&l[0],void 0!==l[1]&&null!==l[1]&&l[1],void 0!==l[2]&&null!==l[2]&&l[2],void 0!==l[3]&&null!==l[3]&&l[3];console.log(l);for(var d=0;d<u;d++){var c=[500*Math.random()-250,500*Math.random()-250,500*Math.random()-250,1],h=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0};this.addNode({name:d.toString(),data:d.toString(),label:d.toString(),position:c,color:!1===this._enableNeuronalNetwork?"../_RESOURCES/UV.jpg":"../_RESOURCES/white.jpg",bornDate:h.bornDate,dieDate:h.dieDate,layoutNodeArgumentData:{ndirect:[0,0,0,1],particlePolarity:0,dest:[0,0,0,0],initPos:c,initDir:[0,0,0,0],nodeColor:[1,1,1,1],nodeLock:0},onmouseup:function(e){}})}for(var f="",p=4;p<4+a;p++)f+=r[p];var m=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(m),f="";for(var g=4+a;g<4+a+i;g++)f+=r[g];var _=f.replace(/(\s|\t)+/gi," ").trim().split(" ");console.log(_);for(var v=0,x=0,N=m.length;x<N;x++){for(var A=parseInt(m[x])-1,y=0,C=parseInt(m[x+1])-1-A;y<C;y++){var D=parseInt(_[A+y])-1,I=void 0!==e.generateBornAndDieDates&&null!==e.generateBornAndDieDates&&!0===e.generateBornAndDieDates?{bornDate:"RANDOM",dieDate:"RANDOM"}:{bornDate:1,dieDate:0},b=void 0!==e.randomLinkWeights&&null!==e.randomLinkWeights&&!0===e.randomLinkWeights?"RANDOM":null;this.addLink({origin:D.toString(),target:v.toString(),directed:!0,bornDate:I.bornDate,dieDate:I.dieDate,weight:b})}v++}}},{key:"clear",value:function(){var e=function(e){var t=e.gpufG.getAllArgs();for(var r in t)t[r]instanceof WebCLGLBuffer==!0&&"RGB"!==r&&t[r].remove()};e(this.comp_renderer_nodes);for(var t=0;t<this.linksObj.length;t++)e(this.linksObj[t].componentRenderer);for(var r=0;r<this.arrowsObj.length;r++)e(this.arrowsObj[r].componentRenderer);!0===this._enableFont&&e(this.comp_renderer_nodesText),this._project.getActiveStage().removeNode(this.nodes);for(var n=0;n<this.linksObj.length;n++)this._project.getActiveStage().removeNode(this.linksObj[n].node);for(var o=0;o<this.arrowsObj.length;o++)this._project.getActiveStage().removeNode(this.arrowsObj[o].node);this._project.getActiveStage().removeNode(this.nodesText)}},{key:"applyLayout",value:function(e){this.layout=e;var t=function(e,t){for(var r=0,n=t.length;r<n;r++)e[t[r].trim().split(" ")[1]]={arg:t[r].trim(),nodes_array_value:[],links_array_value:[],arrows_array_value:[],nodestext_array_value:[]};return e};this.layout.argsDirection=void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection?this.layout.argsDirection.split(","):null,this.layout.argsObject=void 0!==this.layout.argsObject&&null!==this.layout.argsObject?this.layout.argsObject.split(","):null,this._customArgs={},null!=this.layout.argsDirection&&(this._customArgs=t(this._customArgs,this.layout.argsDirection)),null!=this.layout.argsObject&&(this._customArgs=t(this._customArgs,this.layout.argsObject))}},{key:"createWebGLBuffers",value:function(){var e=this,t={"float4* posXYZW":function(){return null},"float4* dataB":function(){return null},"float4* dataF":function(){return null},"float4* dataG":function(){return null},"float4* dataH":function(){return null},"float4*attr data":function(){return null},"float4*attr dataC":function(){return null},"float4*attr nodeVertexPos":function(){return null},"float4*attr nodeVertexNormal":function(){return null},"float4*attr nodeVertexTexture":function(){return null},"float*attr letterId":function(){return null},"float*attr nodeImgId":function(){return null},indices:function(){return null},"float4* adjacencyMatrix":function(){return null},"float4* adjacencyMatrixB":function(){return null},"float4* adjacencyMatrixC":function(){return null},"float widthAdjMatrix":function(){return null},"float nodesCount":function(){return null},"float currentTimestamp":function(){return null},"mat4 PMatrix":function(){return null},"mat4 cameraWMatrix":function(){return null},"mat4 nodeWMatrix":function(){return null},"float isNode":function(){return null},"float isLink":function(){return null},"float isArrow":function(){return null},"float isNodeText":function(){return null},"float bufferNodesWidth":function(){return null},"float bufferLinksWidth":function(){return null},"float bufferArrowsWidth":function(){return null},"float bufferTextsWidth":function(){return null},"float idToDrag":function(){return null},"float idToHover":function(){return null},"float enableForceLayout":function(){return null},"float enableForceLayoutCollision":function(){return null},"float enableNeuronalNetwork":function(){return null},"float afferentNodesCount":function(){return null},"float efferentNodesCount":function(){return null},"float efferentStart":function(){return null},"float currentTrainLayer":function(){return null},"float multiplyOutput":function(){return null},"float only2d":function(){return null},"float nodeImgColumns":function(){return null},"float fontImgColumns":function(){return null},"float4* fontsImg":function(){return null},"float4* nodesImg":function(){return null},"float4* nodesImgCrosshair":function(){return null}},r=0===this.afferentNodesCount?1:this.afferentNodesCount,n=0===this.efferentNodesCount?1:this.efferentNodesCount;if(t["float afferentNodesA["+r+"]"]=function(){return null},t["float efferentNodesA["+n+"]"]=function(){return null},t["float afferentNodesB["+r+"]"]=function(){return null},t["float efferentNodesB["+n+"]"]=function(){return null},t["float afferentNodesC["+r+"]"]=function(){return null},t["float efferentNodesC["+n+"]"]=function(){return null},t["float afferentNodesD["+r+"]"]=function(){return null},t["float efferentNodesD["+n+"]"]=function(){return null},t["float afferentNodesE["+r+"]"]=function(){return null},t["float efferentNodesE["+n+"]"]=function(){return null},t["float afferentNodesF["+r+"]"]=function(){return null},t["float efferentNodesF["+n+"]"]=function(){return null},t["float afferentNodesG["+r+"]"]=function(){return null},t["float efferentNodesG["+n+"]"]=function(){return null},void 0!==this.layout.argsDirection&&null!==this.layout.argsDirection)for(var o=0;o<this.layout.argsDirection.length;o++)t[this.layout.argsDirection[o]]=function(){return null};if(void 0!==this.layout.argsObject&&null!==this.layout.argsObject)for(var a=0;a<this.layout.argsObject.length;a++)t[this.layout.argsObject[a]]=function(){return null};for(var i={"float4* dir":function(){return null},"float nodesCount":function(){return null},"float enableDrag":function(){return null},"float initialPosX":function(){return null},"float initialPosY":function(){return null},"float initialPosZ":function(){return null},"float MouseDragTranslationX":function(){return null},"float MouseDragTranslationY":function(){return null},"float MouseDragTranslationZ":function(){return null}},c=0;c<this.linksObj.length;c++)this.linksObj[c].componentRenderer.setGPUFor(this.linksObj[c].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"LINKS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.linksObj[c].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));for(var h=0;h<this.arrowsObj.length;h++)this.arrowsObj[h].componentRenderer.setGPUFor(this.arrowsObj[h].componentRenderer.gl,Object.create(t),{type:"GRAPHIC",name:"ARROWS_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.arrowsObj[h].componentRenderer.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU));var f=Object.create(t);for(var p in i)f[p]=i[p];this.comp_renderer_nodes.setGPUFor(this.comp_renderer_nodes.gl,f,{type:"KERNEL",name:"NODES_KERNEL_DIR",viewSource:!1,config:s.KERNEL_DIR.getSrc(this.layout.codeDirection,this._geometryLength,this.currentNodeId-this.efferentNodesCount,this.efferentNodesCount,this._enableNeuronalNetwork),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"KERNEL",name:"NODES_KERNEL_ADJMATRIX_UPDATE",viewSource:!1,config:u.KERNEL_ADJMATRIX_UPDATE.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!1,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ONE},{type:"GRAPHIC",name:"NODES_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA},{type:"GRAPHIC",name:"NODES_VFP_NODEPICKDRAG",viewSource:!1,config:d.VFP_NODEPICKDRAG.getSrc(this._geometryLength),drawMode:1===this._geometryLength?0:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.ONE,blendDstMode:Constants.BLENDING_MODES.ZERO});var m=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU);this.comp_renderer_nodes.getComponentBufferArg("RGB",m),this.comp_renderer_nodes.gpufG.onPreProcessKernel(0,function(){var t=e._initTimestamp+e._currentFrame*e._timeFrameIncrement;e.comp_renderer_nodes.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var r=0;r<e.linksObj.length;r++)e.linksObj[r].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));for(var n=0;n<e.arrowsObj.length;n++)e.arrowsObj[n].componentRenderer.setArg("currentTimestamp",function(e){return e}.bind(e,t));!0===e._playAnimation&&(e._currentFrame++,void 0!==e._onAnimationStep&&null!==e._onAnimationStep&&e._onAnimationStep(e._currentFrame),e._currentFrame===e._animationFrames&&(e._currentFrame=0,!1===e._loop&&(e.pauseTimeline(),void 0!==e._onAnimationEnd&&null!==e._onAnimationEnd&&e._onAnimationEnd()))),e.comp_renderer_nodes.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var o=0;o<e.linksObj.length;o++)e.linksObj[o].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});for(var a=0;a<e.arrowsObj.length;a++)e.arrowsObj[a].componentRenderer.setArg("enableNeuronalNetwork",function(){return e._enableNeuronalNetwork});e.comp_renderer_nodes.setArg("only2d",function(){return!0===e._only2d?1:0})}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessKernel(1,function(){}),this.comp_renderer_nodes.gpufG.disableKernel(1),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(0,function(){}),this.comp_renderer_nodes.gpufG.onPreProcessGraphic(1,function(){}),this.comp_renderer_nodes.gpufG.onPostProcessGraphic(1,function(){e.procSelectedOrHover()}),this.comp_renderer_nodes.gpufG.disableGraphic(1),!0===this._enableFont&&(this.comp_renderer_nodesText.setGPUFor(this.comp_renderer_nodesText.gl,Object.create(t),{type:"GRAPHIC",name:"NODESTEXT_VFP_NODE",viewSource:!1,config:l.VFP_NODE.getSrc(this.layout.codeObject,this._geometryLength),drawMode:4,depthTest:!0,blend:!0,blendEquation:Constants.BLENDING_EQUATION_TYPES.FUNC_ADD,blendSrcMode:Constants.BLENDING_MODES.SRC_ALPHA,blendDstMode:Constants.BLENDING_MODES.ONE_MINUS_SRC_ALPHA}),this.comp_renderer_nodesText.getComponentBufferArg("RGB",this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.GPU))),this.enableHov(-1),this.updateNodes(),this.updateLinks()}},{key:"mouseDown",value:function(){!1===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"mouseUp",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0});if(!0===this._enableFont&&this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),-1===this.selectedId){this.comp_renderer_nodes.setArg("idToDrag",function(){return-1});for(var r=0;r<this.linksObj.length;r++)this.linksObj[r].componentRenderer.setArg("idToDrag",function(){return-1});for(var n=0;n<this.arrowsObj.length;n++)this.arrowsObj[n].componentRenderer.setArg("idToDrag",function(){return-1});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToDrag",function(){return-1})}!0===this._enableHover&&(this.readPixel=!0,this.comp_renderer_nodes.gpufG.enableGraphic(1))}},{key:"procSelectedOrHover",value:function(){if(!1===this._enableHover)!0===this.readPixel&&(this.readPixel=!1,this.readPix(),this.comp_renderer_nodes.gpufG.disableGraphic(1));else{var e=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!0===e.isLeftBtnActive()&&(this.readPixel=!1),this.readPix(),!0===e.isLeftBtnActive()&&this.comp_renderer_nodes.gpufG.disableGraphic(1)}}},{key:"readPix",value:function(){var e=new Uint8Array(4),t=this._sce.getEvents().getMousePosition();this._gl.readPixels(t.x,this._sce.getCanvas().height-t.y,1,1,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);var r=this._utils.unpack([e[0]/255,e[1]/255,e[2]/255,e[3]/255]);if(this.selectedId=Math.round(1e6*r)-1,-1!==this.selectedId&&this.selectedId<this.currentNodeId){var n=this._nodesById[this.selectedId];void 0!==n&&null!==n&&void 0!==n.onmousedown&&null!==n.onmousedown&&n.onmousedown(n),void 0!==n&&null!==n&&void 0!==this._onClickNode&&null!==this._onClickNode&&this._onClickNode(n);var o=this.comp_renderer_nodes.gpufG.readArg("posXYZW"),a=o[4*this._nodesById[this.selectedId].itemStart],i=o[4*this._nodesById[this.selectedId].itemStart+1],s=o[4*this._nodesById[this.selectedId].itemStart+2];this._initialPosDrag=$V3([a,i,s]),this.makeDrag(null,$V3([0,0,0]))}}},{key:"makeDrag",value:function(e,t){var r=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.CONTROLLER_TRANSFORM_TARGET);!1===this._enableHover?!0===r.isLeftBtnActive()&&(-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):!0===r.isLeftBtnActive()?(this.enableHov(-1),-1===this.selectedId?this.disableDrag():(this.enableDrag(this.selectedId,t),console.log("selectedId: "+this.selectedId))):this.enableHov(this.selectedId)}},{key:"enableHov",value:function(e){this.comp_renderer_nodes.setArg("idToHover",function(){return e});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg("idToHover",function(){return e});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg("idToHover",function(){return e});!0===this._enableFont&&this.comp_renderer_nodesText.setArg("idToHover",function(){return e})}},{key:"enableDrag",value:function(e,t){var r=this,n=this._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION),o=this._initialPosDrag.add(t.x(2*n.getFov()/this._sce.getCanvas().width));this.comp_renderer_nodes.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodes.setArg("idToDrag",function(){return e}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodes.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodes.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodes.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.setArg("enableDrag",function(){return 1}),this.linksObj[a].componentRenderer.setArg("idToDrag",function(){return e}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.linksObj[a].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.linksObj[a].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.linksObj[a].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.linksObj[a].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.setArg("enableDrag",function(){return 1}),this.arrowsObj[i].componentRenderer.setArg("idToDrag",function(){return e}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.arrowsObj[i].componentRenderer.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.arrowsObj[i].componentRenderer.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.arrowsObj[i].componentRenderer.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.arrowsObj[i].componentRenderer.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 1}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return e}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return o.e[0]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return o.e[1]}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return o.e[2]}),this.comp_renderer_nodesText.setArg("initialPosX",function(){return r._initialPosDrag.e[0]}),this.comp_renderer_nodesText.setArg("initialPosY",function(){return r._initialPosDrag.e[1]}),this.comp_renderer_nodesText.setArg("initialPosZ",function(){return r._initialPosDrag.e[2]}))}},{key:"disableDrag",value:function(){this.comp_renderer_nodes.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodes.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodes.setArg("MouseDragTranslationZ",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("idToDrag",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.linksObj[e].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("enableDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("idToDrag",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationX",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationY",function(){return 0}),this.arrowsObj[t].componentRenderer.setArg("MouseDragTranslationZ",function(){return 0});!0===this._enableFont&&(this.comp_renderer_nodesText.setArg("enableDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("idToDrag",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationX",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationY",function(){return 0}),this.comp_renderer_nodesText.setArg("MouseDragTranslationZ",function(){return 0}))}},{key:"enableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!0,this.disableAutoLink(),this.applyLayout({argsDirection:"float4* dest,float* enableDestination",codeDirection:"if(enableDestination[x] == 1.0) {\n                    vec3 destinationPos = dest[x].xyz;\n                    vec3 dirDestination = normalize(destinationPos-currentPos);\n                    float distan = abs(distance(currentPos,destinationPos));\n                    float dirDestWeight = sqrt(distan);\n                    currentDir = (currentDir+(dirDestination*dirDestWeight))*dirDestWeight*0.1;\n                }",argsObject:"float4*attr nodeColor",codeObject:"if(isArrow == 1.0 && currentLineVertex == 1.0) nodeVertexColor = vec4(0.3, 0.2, 0.2, 1.0);if(isArrow == 1.0 && currentLineVertex == 0.0) nodeVertexColor = vec4(1.0, 0.0, 0.0, 0.0);"})}},{key:"disableNeuronalNetwork",value:function(){this._enableNeuronalNetwork=!1}},{key:"addNeuron",value:function(e,t){var r=[1e3*Math.random()-500,1e3*Math.random()-500,1e3*Math.random()-500,1],n=void 0!==t&&null!==t?t:[0,0,0,1],o=void 0!==t&&null!==t?1:0;this.addNode({name:e,data:e,label:e.toString(),position:r,color:"../_RESOURCES/white.jpg",layoutNodeArgumentData:{nodeColor:[1,1,1,1],enableDestination:o,dest:n},onmouseup:function(e){}})}},{key:"addAfferentNeuron",value:function(e,t){this.afferentNeuron.push(e),this.addNeuron(e,t)}},{key:"addEfferentNeuron",value:function(e,t){this.efferentNeuron.push(e),this.addNeuron(e,t)}},{key:"createNeuronLayer",value:function(e,t,r,n){for(var o=[],a=0;a<e;a++)for(var i=0;i<t;i++){var s=[r[0]+(a-e/2)*n,r[1],r[2]+(i-t/2)*n,r[3]];this.addNeuron(this.currHiddenNeuron.toString(),s),o.push(this.currHiddenNeuron),this.currHiddenNeuron++}return o}},{key:"createXYNeuronsFromImage",value:function(e){for(var t=[],r=0;r<e.w;r++)for(var n=0;n<e.h;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.neuron+r+"_"+n,o),t.push(e.neuron+r+"_"+n)}return t}},{key:"createConvXYNeuronsFromXYNeurons",value:function(e){for(var t=[],r=0;r<e.w-2;r++)for(var n=0;n<e.h-2;n++){var o=[e.position[0]+(n-e.w/2)*this.nodSep,e.position[1],e.position[2]+(r-e.h/2)*this.nodSep,e.position[3]];this.addNeuron(e.idTarget+r+"_"+n,o),t.push(e.idTarget+r+"_"+n);for(var a=0,i=r;i<r+3;i++)for(var s=n;s<n+3;s++)this.addSinapsis({neuronNameA:e.idOrigin+i+"_"+s,neuronNameB:e.idTarget+r+"_"+n,activationFunc:e.activationFunc,multiplier:e.convMatrix[a],layerNum:0}),a++}return t}},{key:"addSinapsis",value:function(e){var t=this,r=function e(){if(!0===t.return_v)return t.return_v=!1,t.v_val;var r=2*Math.random()-1,n=2*Math.random()-1,o=r*r+n*n;if(0===o||o>1)return e();var a=Math.sqrt(-2*Math.log(o)/o);return t.v_val=n*a,t.return_v=!0,r*a},n=Math.sqrt(.02),o=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,a=void 0!==e.weight&&null!==e.weight?e.weight:function(e,t){return e+r()*t}(0,n),i=void 0!==e.multiplier&&null!==e.multiplier?e.multiplier:1;this.addLink({origin:e.neuronNameA,target:e.neuronNameB,directed:!0,showArrow:!1,activationFunc:o,weight:a,linkMultiplier:i,layerNum:e.layerNum})}},{key:"connectNeuronWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuron.toString(),neuronNameB:e.neuronLayer[t].toString(),activationFunc:e.activationFunc,weight:e.weight,multiplier:e.multiplier,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuron",value:function(e){for(var t=0;t<e.neuronLayer.length;t++)this.addSinapsis({neuronNameA:e.neuronLayer[t].toString(),neuronNameB:e.neuron,activationFunc:1,layerNum:e.layerNum})}},{key:"connectNeuronLayerWithNeuronLayer",value:function(e){for(var t=0;t<e.neuronLayerOrigin.length;t++){var r=e.neuronLayerOrigin[t];this.connectNeuronWithNeuronLayer({neuron:r.toString(),neuronLayer:e.neuronLayerTarget,layerNum:e.layerNum})}}},{key:"forward",value:function(e){var t=this;this.onAction=e.onAction;for(var r=e.state.slice(0),n=e.state.length;n<this.afferentNodesCount;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.afferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("afferentNodes"+o[a++],function(){return r.slice(e,e+t.afferentNodesCount)})}(i);for(var u=0;u<this.layerCount;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this._sce.getLoadedProject().getActiveStage().tick(),null!==this.onAction){for(var l=[["dataB",2],["dataF",0],["dataF",2],["dataG",0],["dataG",2],["dataH",0],["dataH",2]],d=[[]],c=0,h=0;h<this.efferentNodesCount*this.batch_size;h++){d[c].length===this.efferentNodesCount&&(d.push([]),c++);var f=this.getNeuronOutput(this.efferentNeuron[d[c].length],l[c]);isNaN(f[2]),d[c].push({output:f[l[c][1]]})}this.onAction(d)}}},{key:"train",value:function(e){var t=this;this.onTrained=e.onTrained;for(var r=e.arrReward.slice(0),n=e.arrReward.length;n<this.efferentNodesCount*this.batch_size;n++)r[n]=0;for(var o=["A","B","C","D","E","F","G"],a=0,i=0,s=r.length;i<s;i+=this.efferentNodesCount)!function(e,n){t.comp_renderer_nodes.setArg("efferentNodes"+o[a++],function(){return r.slice(e,e+t.efferentNodesCount)})}(i);for(var u=0;u<this.layerCount-1;u++)this.comp_renderer_nodes.gpufG.processKernel(this.comp_renderer_nodes.gpufG.kernels[0],!0,!0);if(this.comp_renderer_nodes.gpufG.enableKernel(1),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return 10}),this._sce.getLoadedProject().getActiveStage().tick(),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return-3}),this.comp_renderer_nodes.gpufG.disableKernel(1),null!==this.onTrained){for(var l=[],d=0;d<this.efferentNodesCount;d++);this.onTrained(l)}}},{key:"getNeuronOutput",value:function(e,t){var r=this.comp_renderer_nodes.gpufG.readArg(t[0]),n=4*this._nodesByName[e].itemStart;return[r[n],r[n+1],r[n+2],r[n+3]]}},{key:"setLayoutArgumentData",value:function(e){this._customArgs[e.argName].nodes_array_value=e.value,this._customArgs[e.argName].links_array_value=e.value,this._customArgs[e.argName].arrows_array_value=e.value,this._customArgs[e.argName].nodestext_array_value=e.value,this.comp_renderer_nodes.setArg(e.argName,function(){return e.value});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.setArg(e.argName,function(){return e.value});for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.setArg(e.argName,function(){return e.value});!0===this._enableFont&&this.comp_renderer_nodesText.setArg(e.argName,function(){return e.value})}},{key:"getLayoutNodeArgumentData",value:function(e){for(var t=this._nodesByName[e.nodeName],r=this._customArgs[e.argName].arg.split("*")[0],n=0;n<this.arrayNodeData.length/4;n++)if(void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*n]===t.nodeId){var o=this._customArgs[e.argName].nodes_array_value;if("float"===r){var a=n;if(void 0!==o[a]&&null!==o[a])return o[a]}else{var i=4*n;if(void 0!==o[i]&&null!==o[i])return[o[i],o[i+1],o[i+2],o[i+3]]}}}},{key:"setLayoutNodeArgumentData",value:function(e){for(var t=this,r=this._nodesByName[e.nodeName],n=this._customArgs[e.argName].arg.split("*")[0],o=function(e,r,n,o,a){if("float"===e)t._customArgs[r][n][o]=a;else{var i=4*o;t._customArgs[r][n][i]=a[0],t._customArgs[r][n][i+1]=a[1],t._customArgs[r][n][i+2]=a[2],t._customArgs[r][n][i+3]=a[3]}},a=0;a<this.arrayNodeData.length/4;a++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeData[4*a]===r.nodeId)o(n,e.argName,"nodes_array_value",a,e.value);else{var i="float"===n?a:4*a;void 0===this._customArgs[e.argName].nodes_array_value[i]&&null===this._customArgs[e.argName].nodes_array_value[i]&&!1===e.update&&("float"===n?o(n,e.argName,"nodes_array_value",a,0):o(n,e.argName,"nodes_array_value",a,[0,0,0,0]))}this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value});for(var s=0;s<this.linksObj.length;s++){for(var u=0;u<this.linksObj[s].arrayLinkData.length/4;u++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.linksObj[s].arrayLinkData[4*u]===r.nodeId)o(n,e.argName,"links_array_value",u,e.value);else{var l="float"===n?u:4*u;void 0===this._customArgs[e.argName].links_array_value[l]&&null===this._customArgs[e.argName].links_array_value[l]&&!1===e.update&&("float"===n?o(n,e.argName,"links_array_value",u,0):o(n,e.argName,"links_array_value",u,[0,0,0,0]))}this.linksObj[s].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}for(var d=0;d<this.arrowsObj.length;d++){for(var c=0;c<this.arrowsObj[d].arrayArrowData.length/4;c++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrowsObj[d].arrayArrowData[4*c]===r.nodeId)o(n,e.argName,"arrows_array_value",c,e.value);else{var h="float"===n?c:4*c;void 0===this._customArgs[e.argName].arrows_array_value[h]&&null===this._customArgs[e.argName].arrows_array_value[h]&&!1===e.update&&("float"===n?o(n,e.argName,"arrows_array_value",c,0):o(n,e.argName,"arrows_array_value",c,[0,0,0,0]))}this.arrowsObj[d].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){for(var f=0;f<this.arrayNodeTextData.length/4;f++)if(void 0===e.nodeName||null===e.nodeName||void 0!==e.nodeName&&null!==e.nodeName&&this.arrayNodeTextData[4*f]===r.nodeId)o(n,e.argName,"nodestext_array_value",f,e.value);else{var p="float"===n?f:4*f;void 0===this._customArgs[e.argName].nodestext_array_value[p]&&null===this._customArgs[e.argName].nodestext_array_value[p]&&!1===e.update&&("float"===n?o(n,e.argName,"nodestext_array_value",f,0):o(n,e.argName,"nodestext_array_value",f,[0,0,0,0]))}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"setLayoutNodeArgumentArrayData",value:function(e){var t=this,r=this._customArgs[e.argName].arg.split("*")[0],n=-1,o=0,a=0,i=0,s=0;this._customArgs[e.argName].nodes_array_value=[];for(var u=0;u<this.arrayNodeData.length/4;u++)n!==this.arrayNodeData[4*u]?(n=this.arrayNodeData[4*u],"float"===r?(o=e.value[n],this._customArgs[e.argName].nodes_array_value.push(o)):(o=e.value[4*n],a=e.value[4*n+1],i=e.value[4*n+2],s=e.value[4*n+3],this._customArgs[e.argName].nodes_array_value.push(o,a,i,s))):"float"===r?this._customArgs[e.argName].nodes_array_value.push(o):this._customArgs[e.argName].nodes_array_value.push(o,a,i,s);this.comp_renderer_nodes.setArg(e.argName,function(){return t._customArgs[e.argName].nodes_array_value}),this._customArgs[e.argName].links_array_value=[];for(var l=0;l<this.linksObj.length;l++){for(var d=0;d<this.linksObj[l].arrayLinkNodeName.length;d++){var c=this.linksObj[l].arrayLinkNodeName[d],h=this._nodesByName[c].itemStart;"float"===r?this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[h]):this._customArgs[e.argName].links_array_value.push(this._customArgs[e.argName].nodes_array_value[4*h],this._customArgs[e.argName].nodes_array_value[4*h+1],this._customArgs[e.argName].nodes_array_value[4*h+2],this._customArgs[e.argName].nodes_array_value[4*h+3])}this.linksObj[l].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].links_array_value})}this._customArgs[e.argName].arrows_array_value=[];for(var f=0;f<this.arrowsObj.length;f++){for(var p=0;p<this.arrowsObj[f].arrayArrowNodeName.length;p++){var m=this.arrowsObj[f].arrayArrowNodeName[p],g=this._nodesByName[m].itemStart;"float"===r?this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[g]):this._customArgs[e.argName].arrows_array_value.push(this._customArgs[e.argName].nodes_array_value[4*g],this._customArgs[e.argName].nodes_array_value[4*g+1],this._customArgs[e.argName].nodes_array_value[4*g+2],this._customArgs[e.argName].nodes_array_value[4*g+3])}this.arrowsObj[f].componentRenderer.setArg(e.argName,function(){return t._customArgs[e.argName].arrows_array_value})}if(!0===this._enableFont){this._customArgs[e.argName].nodestext_array_value=[];for(var _=0;_<this.arrayNodeTextNodeName.length;_++){var v=this.arrayNodeTextNodeName[_],x=this._nodesByName[v].itemStart;"float"===r?this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[x]):this._customArgs[e.argName].nodestext_array_value.push(this._customArgs[e.argName].nodes_array_value[4*x],this._customArgs[e.argName].nodes_array_value[4*x+1],this._customArgs[e.argName].nodes_array_value[4*x+2],this._customArgs[e.argName].nodes_array_value[4*x+3])}this.comp_renderer_nodesText.setArg(e.argName,function(){return t._customArgs[e.argName].nodestext_array_value})}}},{key:"addNode",value:function(e){if(!1===this._nodesByName.hasOwnProperty(e.name)){var t=this.createNode(e);return this._nodesByName[e.name]=t,this._nodesById[t.nodeId]=t,void 0!==t.label&&null!==t.label&&!0===this._enableFont&&this.createNodeText(t),console.log("%cnode "+Object.keys(this._nodesByName).length+" ("+e.name+")","color:green"),e.name}return console.log("node "+e.name+" already exists"),!1}},{key:"createNode",value:function(e){var t=this.nodeArrayItemStart,r=void 0!==e.position&&null!==e.position?e.position:[100*Math.random()-50,100*Math.random()-50,100*Math.random()-50,1],n=e.color,o=-1;if(void 0!==n&&null!==n&&n.constructor===String){if(!1===this.objNodeImages.hasOwnProperty(n)){var a=Object.keys(this.objNodeImages).length;this.objNodeImages[n]=a,this.addNodesImage(n,a)}o=this.objNodeImages[n]}for(var i=0;i<this.mesh_nodes.vertexArray.length/4;i++){var s=4*i,u=this.getBornDieTS(e.bornDate,e.dieDate);if(this.arrayNodeData.push(this.currentNodeId,0,u.bornDate,u.dieDate),this.arrayNodeDataB.push(u.bornDate,u.dieDate,0,0),this.arrayNodeDataF.push(0,0,0,0),this.arrayNodeDataG.push(0,0,0,0),this.arrayNodeDataH.push(0,0,0,0),this.arrayNodePosXYZW.push(r[0],r[1],r[2],r[3]),this.arrayNodeDir.push(0,0,0,1),this.arrayNodeVertexPos.push(this.mesh_nodes.vertexArray[s],this.mesh_nodes.vertexArray[s+1],this.mesh_nodes.vertexArray[s+2],1),this.arrayNodeVertexNormal.push(this.mesh_nodes.normalArray[s],this.mesh_nodes.normalArray[s+1],this.mesh_nodes.normalArray[s+2],1),this.arrayNodeVertexTexture.push(this.mesh_nodes.textureArray[s],this.mesh_nodes.textureArray[s+1],this.mesh_nodes.textureArray[s+2],1),this.arrayNodeImgId.push(o),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var l in this._customArgs){var d=this._customArgs[l].arg.split("*");d.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(l)&&void 0!==e.layoutNodeArgumentData[l]&&null!==e.layoutNodeArgumentData[l]&&("float"===d[0]?this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l]):"float4"===d[0]&&this._customArgs[l].nodes_array_value.push(e.layoutNodeArgumentData[l][0],e.layoutNodeArgumentData[l][1],e.layoutNodeArgumentData[l][2],e.layoutNodeArgumentData[l][3]))}this.nodeArrayItemStart++}for(var c=0,h=0;h<this.mesh_nodes.indexArray.length;h++){var f=h;this.arrayNodeIndices.push(this.startIndexId+this.mesh_nodes.indexArray[f]),this.mesh_nodes.indexArray[f]>c&&(c=this.mesh_nodes.indexArray[f])}return this.startIndexId+=c+1,e.nodeId=this.currentNodeId++,e.itemStart=t,e}},{key:"createNodeText",value:function(e){for(var t=function(e){return{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,"Ñ":14,O:15,P:16,Q:17,R:18,S:19,T:20,U:21,V:22,W:23,X:24,Y:25,Z:26," ":27,0:28,1:29,2:30,3:31,4:32,5:33,6:34,7:35,8:36,9:37}[e]},r=0;r<this.nodesTextPlanes;r++){var n=null;void 0!==e.label&&null!==e.label&&void 0!==e.label[r]&&null!==e.label[r]&&(n=t(e.label[r].toUpperCase())),null===n&&(n=t(" "));for(var o=0;o<this.mesh_nodesText.vertexArray.length/4;o++){var a=4*o;if(this.arrayNodeTextData.push(e.nodeId,0,0,0),this.arrayNodeTextPosXYZW.push(0,0,0,1),this.arrayNodeTextVertexPos.push(this.mesh_nodesText.vertexArray[a]+5*r,this.mesh_nodesText.vertexArray[a+1],this.mesh_nodesText.vertexArray[a+2],1),this.arrayNodeTextVertexNormal.push(this.mesh_nodesText.normalArray[a],this.mesh_nodesText.normalArray[a+1],this.mesh_nodesText.normalArray[a+2],1),this.arrayNodeTextVertexTexture.push(this.mesh_nodesText.textureArray[a],this.mesh_nodesText.textureArray[a+1],this.mesh_nodesText.textureArray[a+2],1),this.arrayNodeTextNodeName.push(e.name),this.arrayNodeText_itemStart.push(e.itemStart),this.arrayNodeTextLetterId.push(n),void 0!==e.layoutNodeArgumentData&&null!==e.layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.layoutNodeArgumentData[i]&&null!==e.layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].nodestext_array_value.push(e.layoutNodeArgumentData[i][0],e.layoutNodeArgumentData[i][1],e.layoutNodeArgumentData[i][2],e.layoutNodeArgumentData[i][3]))}this.nodeTextArrayItemStart++}}for(var u=0,l=0;l<this.nodesTextPlanes;l++)for(var d=0;d<this.mesh_nodesText.indexArray.length;d++){var c=d,h=4*l,f=this.mesh_nodesText.indexArray[c]+h;this.arrayNodeTextIndices.push(this.startIndexId_nodestext+f),f>u&&(u=f)}this.startIndexId_nodestext+=u+1,this.currentNodeTextId++}},{key:"addNodesImage",value:function(e,t){this._stackNodesImg.push({url:e,locationIdx:t})}},{key:"generateNodesImage",value:function(){var e=this;!1===this.nodesImgMaskLoaded?(this.nodesImgMask=new Image,this.nodesImgMask.onload=function(){e.nodesImgMaskLoaded=!0,e.generateNodesImage()},this.nodesImgMask.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgMask.png"):!1===this.nodesImgCrosshairLoaded?(this.nodesImgCrosshair=new Image,this.nodesImgCrosshair.onload=function(){e.nodesImgCrosshairLoaded=!0,e.generateNodesImage()},this.nodesImgCrosshair.src=this._sce.sceDirectory+"/Prefabs/Graph/nodesImgCrosshair.png"):new c.ProccessImg({stackNodesImg:this._stackNodesImg,NODE_IMG_WIDTH:this.NODE_IMG_WIDTH,NODE_IMG_COLUMNS:this.NODE_IMG_COLUMNS,nodesImgMask:this.nodesImgMask,nodesImgCrosshair:this.nodesImgCrosshair,onend:function(t){e.comp_renderer_nodes.setArg("nodesImg",function(){return t.nodesImg}),e.comp_renderer_nodes.setArg("nodesImgCrosshair",function(){return t.nodesImgCrosshair})}})}},{key:"addLink",value:function(e){var t=!0;if(void 0===this._nodesByName[e.origin]&&null===this._nodesByName[e.origin]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.origin+" not exists","color:red"),t=!1),void 0===this._nodesByName[e.target]&&null===this._nodesByName[e.target]&&(console.log("%clink "+e.origin+"->"+e.target+". Node "+e.target+" not exists","color:red"),t=!1),e.origin===e.target&&!1===this._enableAutoLink&&(console.log("%cDiscarting autolink "+e.origin+"->"+e.target,"color:orange"),t=!1),!0===t){console.log("%clink "+e.origin+"->"+e.target,"color:green"),e.origin_nodeName=e.origin.toString(),e.target_nodeName=e.target.toString(),e.origin_nodeId=this._nodesByName[e.origin].nodeId,e.target_nodeId=this._nodesByName[e.target].nodeId,e.origin_itemStart=this._nodesByName[e.origin].itemStart,e.target_itemStart=this._nodesByName[e.target].itemStart,e.origin_layoutNodeArgumentData=this._nodesByName[e.origin].layoutNodeArgumentData,e.target_layoutNodeArgumentData=this._nodesByName[e.target].layoutNodeArgumentData;var r=this.getBornDieTS(e.bornDate,e.dieDate);e.bornDate=r.bornDate,e.dieDate=r.dieDate,e.activationFunc=void 0!==e.activationFunc&&null!==e.activationFunc?e.activationFunc:1,e.weight=void 0!==e.weight&&null!==e.weight&&e.weight.constructor===String?Math.random():e.weight||1,e.linkMultiplier=void 0!==e.linkMultiplier&&null!==e.linkMultiplier?e.linkMultiplier:1;for(var n=1;;){if(!0!==(this._links.hasOwnProperty(e.origin+"->"+e.target+"_"+n)||this._links.hasOwnProperty(e.target+"->"+e.origin+"_"+n)))break;n++}e.repeatId=n,void 0!==(e=this.createLink(e)).directed&&null!==e.directed&&!0===e.directed&&(void 0!==e.showArrow&&null!==e.showArrow&&!1===e.showArrow||this.createArrow(e)),this._links[e.origin+"->"+e.target+"_"+n]=e;for(var o=0;o<this.arrayNodeData.length/4;o++){var a=4*o;this.arrayNodeData[a]===this._nodesByName[e.origin].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1),this.arrayNodeData[a]===this._nodesByName[e.target].nodeId&&(this.arrayNodeData[a+1]=this.arrayNodeData[a+1]+1)}}}},{key:"createLink",value:function(e){this.currentLinkId%6e4==0&&this.createLinksObjItem();for(var t=0;t<2*this.lineVertexCount;t++)if(this.linksObj[this.currentLinksObjItem].arrayLinkData.push(e.origin_nodeId,e.target_nodeId,Math.ceil(t/2),e.repeatId),this.linksObj[this.currentLinksObjItem].arrayLinkDataC.push(e.bornDate,e.dieDate,e.weight,0),Math.ceil(t/2)!==this.lineVertexCount-1?this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.origin_nodeName):this.linksObj[this.currentLinksObjItem].arrayLinkNodeName.push(e.target_nodeName),this.linksObj[this.currentLinksObjItem].arrayLinkPosXYZW.push(0,0,0,1),this.linksObj[this.currentLinksObjItem].arrayLinkVertexPos.push(0,0,0,1),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var r in this._customArgs){var n=this._customArgs[r].arg.split("*");n.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(r)&&void 0!==e.origin_layoutNodeArgumentData[r]&&null!==e.origin_layoutNodeArgumentData[r]&&("float"===n[0]?this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r]):"float4"===n[0]&&this._customArgs[r].links_array_value.push(e.origin_layoutNodeArgumentData[r][0],e.origin_layoutNodeArgumentData[r][1],e.origin_layoutNodeArgumentData[r][2],e.origin_layoutNodeArgumentData[r][3]))}for(var o=0;o<2*this.lineVertexCount;o++)this.linksObj[this.currentLinksObjItem].arrayLinkIndices.push(this.linksObj[this.currentLinksObjItem].startIndexId_link++);return this.currentLinkId+=2,e.linkId=this.currentLinkId-2,e}},{key:"createArrow",value:function(e){this.currentArrowId%2e4==0&&this.createArrowsObjItem(),void 0!==e&&null!==e&&void 0!==e.node&&null!==e.node&&(this.mesh_arrows=e.node);for(var t=0;t<2;t++){for(var r=0;r<this.mesh_arrows.vertexArray.length/4;r++){var n=4*r;if(0===t&&this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart,this.arrowsObj[this.currentArrowsObjItem].arrayArrowPosXYZW.push(0,0,0,1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexPos.push(this.mesh_arrows.vertexArray[n],this.mesh_arrows.vertexArray[n+1],this.mesh_arrows.vertexArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexNormal.push(this.mesh_arrows.normalArray[n],this.mesh_arrows.normalArray[n+1],this.mesh_arrows.normalArray[n+2],1),this.arrowsObj[this.currentArrowsObjItem].arrayArrowVertexTexture.push(this.mesh_arrows.textureArray[n],this.mesh_arrows.textureArray[n+1],this.mesh_arrows.textureArray[n+2],1),0===t){if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.origin_nodeId,e.target_nodeId,0,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.origin_nodeName),void 0!==e.origin_layoutNodeArgumentData&&null!==e.origin_layoutNodeArgumentData)for(var o in this._customArgs){var a=this._customArgs[o].arg.split("*");a.length>0&&!0===e.origin_layoutNodeArgumentData.hasOwnProperty(o)&&void 0!==e.origin_layoutNodeArgumentData[o]&&null!==e.origin_layoutNodeArgumentData[o]&&("float"===a[0]?this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o]):"float4"===a[0]&&this._customArgs[o].arrows_array_value.push(e.origin_layoutNodeArgumentData[o][0],e.origin_layoutNodeArgumentData[o][1],e.origin_layoutNodeArgumentData[o][2],e.origin_layoutNodeArgumentData[o][3]))}}else if(this.arrowsObj[this.currentArrowsObjItem].arrayArrowData.push(e.target_nodeId,e.origin_nodeId,1,e.repeatId),this.arrowsObj[this.currentArrowsObjItem].arrayArrowDataC.push(e.bornDate,e.dieDate,0,0),this.arrowsObj[this.currentArrowsObjItem].arrayArrowNodeName.push(e.target_nodeName),void 0!==e.target_layoutNodeArgumentData&&null!==e.target_layoutNodeArgumentData)for(var i in this._customArgs){var s=this._customArgs[i].arg.split("*");s.length>0&&!0===e.target_layoutNodeArgumentData.hasOwnProperty(i)&&void 0!==e.target_layoutNodeArgumentData[i]&&null!==e.target_layoutNodeArgumentData[i]&&("float"===s[0]?this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i]):"float4"===s[0]&&this._customArgs[i].arrows_array_value.push(e.target_layoutNodeArgumentData[i][0],e.target_layoutNodeArgumentData[i][1],e.target_layoutNodeArgumentData[i][2],e.target_layoutNodeArgumentData[i][3]))}this.arrowsObj[this.currentArrowsObjItem].arrowArrayItemStart++}for(var u=0,l=0;l<this.mesh_arrows.indexArray.length;l++){var d=l;this.arrowsObj[this.currentArrowsObjItem].arrayArrowIndices.push(this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+this.mesh_arrows.indexArray[d]),this.mesh_arrows.indexArray[d]>u&&(u=this.mesh_arrows.indexArray[d])}this.arrowsObj[this.currentArrowsObjItem].startIndexId_arrow+=u+1,this.currentArrowId++}}},{key:"updateNodes",value:function(){var e=this;console.log(this.currentNodeId+" nodes"),this._ADJ_MATRIX_WIDTH=this._MAX_ADJ_MATRIX_WIDTH,this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var t=0;t<this.linksObj.length;t++)this.linksObj[t].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);for(var r=0;r<this.arrowsObj.length;r++)this.arrowsObj[r].componentRenderer.getComponentBufferArg("adjacencyMatrix",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var n=0;n<this.linksObj.length;n++)this.linksObj[n].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);for(var o=0;o<this.arrowsObj.length;o++)this.arrowsObj[o].componentRenderer.getComponentBufferArg("adjacencyMatrixB",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return new Float32Array(e._ADJ_MATRIX_WIDTH*e._ADJ_MATRIX_WIDTH*4)});for(var a=0;a<this.linksObj.length;a++)this.linksObj[a].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);for(var i=0;i<this.arrowsObj.length;i++)this.arrowsObj[i].componentRenderer.getComponentBufferArg("adjacencyMatrixC",this.comp_renderer_nodes);this.comp_renderer_nodes.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var s=0;s<this.linksObj.length;s++)this.linksObj[s].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});for(var u=0;u<this.arrowsObj.length;u++)this.arrowsObj[u].componentRenderer.setArg("widthAdjMatrix",function(){return e._ADJ_MATRIX_WIDTH});this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData}),this.comp_renderer_nodes.setArg("dataB",function(){return e.arrayNodeDataB}),this.comp_renderer_nodes.setArg("dataF",function(){return e.arrayNodeDataF}),this.comp_renderer_nodes.setArg("dataG",function(){return e.arrayNodeDataG}),this.comp_renderer_nodes.setArg("dataH",function(){return e.arrayNodeDataH}),void 0!==this.comp_renderer_nodes.getBuffers().posXYZW&&null!==this.comp_renderer_nodes.getBuffers().posXYZW&&(this.arrayNodePosXYZW=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("posXYZW"))),this.comp_renderer_nodes.setArg("posXYZW",function(){return e.arrayNodePosXYZW}),this.comp_renderer_nodes.setArg("nodeVertexPos",function(){return e.arrayNodeVertexPos}),this.comp_renderer_nodes.setArg("nodeVertexNormal",function(){return e.arrayNodeVertexNormal}),this.comp_renderer_nodes.setArg("nodeVertexTexture",function(){return e.arrayNodeVertexTexture}),this.comp_renderer_nodes.setArg("nodesCount",function(){return e.currentNodeId}),this._MAX_ADJ_MATRIX_WIDTH=this.currentNodeId,this.comp_renderer_nodes.setArg("nodeImgColumns",function(){return e.NODE_IMG_COLUMNS}),this.comp_renderer_nodes.setArg("nodeImgId",function(){return e.arrayNodeImgId}),this.comp_renderer_nodes.setArg("indices",function(){return e.arrayNodeIndices}),void 0!==this.comp_renderer_nodes.getBuffers().dir&&null!==this.comp_renderer_nodes.getBuffers().dir&&(this.arrayNodeDir=Array.prototype.slice.call(this.comp_renderer_nodes.gpufG.readArg("dir"))),this.comp_renderer_nodes.setArg("dir",function(){return e.arrayNodeDir}),this.comp_renderer_nodes.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodes.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodes.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodes.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodes.setArg("currentTrainLayer",function(){return e.currentTrainLayer}),this.comp_renderer_nodes.setArg("afferentNodesCount",function(){return e.afferentNodesCount}),this.comp_renderer_nodes.setArg("efferentNodesCount",function(){return e.efferentNodesCount}),this.comp_renderer_nodes.setArg("efferentStart",function(){return e.currentNodeId-e.efferentNodesCount}),this.comp_renderer_nodes.setArg("afferentNodesA",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesA",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesB",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesB",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesC",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesC",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesD",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesD",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesE",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesE",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesF",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesF",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("afferentNodesG",function(){return new Float32Array(e.afferentNodesCount)}),this.comp_renderer_nodes.setArg("efferentNodesG",function(){return new Float32Array(e.efferentNodesCount)}),this.comp_renderer_nodes.setArg("isNode",function(){return 1}),this.comp_renderer_nodes.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W});for(var l in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodes.setArg(t,function(){return e._customArgs[t].nodes_array_value})}(l);this.generateNodesImage(),!0===this._enableFont&&this.updateNodesText()}},{key:"updateNodesText",value:function(){var e=this;this.comp_renderer_nodesText.setArg("data",function(){return e.arrayNodeTextData}),this.comp_renderer_nodesText.getComponentBufferArg("posXYZW",this.comp_renderer_nodes),this.comp_renderer_nodesText.setArg("nodeVertexPos",function(){return e.arrayNodeTextVertexPos}),this.comp_renderer_nodesText.setArg("nodeVertexNormal",function(){return e.arrayNodeTextVertexNormal}),this.comp_renderer_nodesText.setArg("nodeVertexTexture",function(){return e.arrayNodeTextVertexTexture}),this.comp_renderer_nodesText.setArg("fontImgColumns",function(){return e.FONT_IMG_COLUMNS}),this.comp_renderer_nodesText.setArg("letterId",function(){return e.arrayNodeTextLetterId}),this.comp_renderer_nodesText.setArg("indices",function(){return e.arrayNodeTextIndices}),this.comp_renderer_nodesText.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("PMatrix",!0),this.comp_renderer_nodesText.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("cameraWMatrix",!0),this.comp_renderer_nodesText.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),this.comp_renderer_nodesText.setArgUpdatable("nodeWMatrix",!0),this.comp_renderer_nodesText.setArg("isNodeText",function(){return 1}),this.comp_renderer_nodesText.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),this.comp_renderer_nodesText.setArg("bufferTextsWidth",function(){return e.comp_renderer_nodesText.getBuffers().data.W});for(var t in this._customArgs)!function(t){e._customArgs[t].arg.split("*").length>0&&e.comp_renderer_nodesText.setArg(t,function(){return e._customArgs[t].nodestext_array_value})}(t)}},{key:"updateLinks",value:function(){var e=this;console.log(Object.keys(this._links).length+" links"),this.comp_renderer_nodes.setArg("data",function(){return e.arrayNodeData});for(var t=0;t<this.linksObj.length;t++)!function(t){e.linksObj[t].componentRenderer.setArg("data",function(){return e.linksObj[t].arrayLinkData}),e.linksObj[t].componentRenderer.setArg("dataC",function(){return e.linksObj[t].arrayLinkDataC}),e.linksObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.linksObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.linksObj[t].arrayLinkVertexPos}),e.linksObj[t].componentRenderer.setArg("indices",function(){return e.linksObj[t].arrayLinkIndices}),e.linksObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.linksObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.linksObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.linksObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.linksObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.linksObj[t].componentRenderer.setArg("isLink",function(){return 1}),e.linksObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.linksObj[t].componentRenderer.setArg("bufferLinksWidth",function(){return e.linksObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.linksObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].links_array_value})}(r)}(t);this.updateArrows(),Object.keys(this._links).length>0&&this.updateAdjMat()}},{key:"updateArrows",value:function(){for(var e=this,t=0;t<this.arrowsObj.length;t++)!function(t){e.arrowsObj[t].componentRenderer.setArg("data",function(){return e.arrowsObj[t].arrayArrowData}),e.arrowsObj[t].componentRenderer.setArg("dataC",function(){return e.arrowsObj[t].arrayArrowDataC}),e.arrowsObj[t].componentRenderer.getComponentBufferArg("dataB",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.getComponentBufferArg("posXYZW",e.comp_renderer_nodes),e.arrowsObj[t].componentRenderer.setArg("nodeVertexPos",function(){return e.arrowsObj[t].arrayArrowVertexPos}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexNormal",function(){return e.arrowsObj[t].arrayArrowVertexNormal}),e.arrowsObj[t].componentRenderer.setArg("nodeVertexTexture",function(){return e.arrowsObj[t].arrayArrowVertexTexture}),e.arrowsObj[t].componentRenderer.setArg("indices",function(){return e.arrowsObj[t].arrayArrowIndices}),e.arrowsObj[t].componentRenderer.setArg("PMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.PROJECTION).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("PMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("cameraWMatrix",function(){return e._project.getActiveStage().getActiveCamera().getComponent(Constants.COMPONENT_TYPES.TRANSFORM_TARGET).getMatrix().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("cameraWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodeWMatrix",function(){return e.nodes.getComponent(Constants.COMPONENT_TYPES.TRANSFORM).getMatrixPosition().transpose().e}),e.arrowsObj[t].componentRenderer.setArgUpdatable("nodeWMatrix",!0),e.arrowsObj[t].componentRenderer.setArg("nodesCount",function(){return e.currentNodeId}),e.arrowsObj[t].componentRenderer.setArg("isArrow",function(){return 1}),e.arrowsObj[t].componentRenderer.setArg("bufferNodesWidth",function(){return e.comp_renderer_nodes.getBuffers().posXYZW.W}),e.arrowsObj[t].componentRenderer.setArg("bufferArrowsWidth",function(){return e.arrowsObj[t].componentRenderer.getBuffers().data.W});for(var r in e._customArgs)!function(r){e._customArgs[r].arg.split("*").length>0&&e.arrowsObj[t].componentRenderer.setArg(r,function(){return e._customArgs[r].arrows_array_value})}(r)}(t)}},{key:"updateAdjMat",value:function(){var e=this,t=function(t,r,n,o,a,i,s,u,l,d){var c=4*r;e.arrAdjMatrix[c]=a,e.arrAdjMatrix[c+1]=i,e.arrAdjMatrix[c+2]=!0===t?e.disabVal:s,e.arrAdjMatrix[c+3]=!0===t?1:.5,e.arrAdjMatrixB[c]=u,e.arrAdjMatrixB[c+1]=l,e.arrAdjMatrixB[c+2]=n,e.arrAdjMatrixB[c+3]=o,e.arrAdjMatrixC[c]=0,e.arrAdjMatrixC[c+1]=d,e.arrAdjMatrixC[c+2]=0,e.arrAdjMatrixC[c+3]=0};this.arrAdjMatrix=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixB=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4),this.arrAdjMatrixC=new Float32Array(this._ADJ_MATRIX_WIDTH*this._ADJ_MATRIX_WIDTH*4);for(var r in this._links){var n=this._links[r].origin_nodeId,o=this._links[r].target_nodeId,a=o*this._ADJ_MATRIX_WIDTH+n,i=n*this._ADJ_MATRIX_WIDTH+o;t(!0,a,o,n,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,-99),t(!1,i,n,o,this._links[r].bornDate,this._links[r].dieDate,this._links[r].weight,this._links[r].linkMultiplier,this._links[r].activationFunc,this._links[r].layerNum)}this.comp_renderer_nodes.setArg("adjacencyMatrix",function(){return e.arrAdjMatrix}),this.comp_renderer_nodes.setArg("adjacencyMatrixB",function(){return e.arrAdjMatrixB}),this.comp_renderer_nodes.setArg("adjacencyMatrixC",function(){return e.arrAdjMatrixC})}},{key:"adjacencyMatrixToImage",value:function(e,t,r){var n=this;!function(e,t,o){var a=Utils.getCanvasFromUint8Array(e,t,o);n._utils.getImageFromCanvas(a,function(e){r(e)})}(function(e){for(var t=new Uint8Array(4*e.length),r=0;r<e.length;r++){var n=4*r;t[n]=255*e[r],t[n+1]=255*e[r],t[n+2]=255*e[r],t[n+3]=255}return t}(e),t,t)}},{key:"enableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 1});this._enabledForceLayout=!0}},{key:"disableForceLayout",value:function(){this.comp_renderer_nodes.setArg("enableForceLayout",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("enableForceLayout",function(){return 0});this._enabledForceLayout=!1}},{key:"enableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 1})}},{key:"disableForceLayoutCollision",value:function(){this.comp_renderer_nodes.setArg("enableForceLayoutCollision",function(){return 0})}},{key:"enableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 1});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 1});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 1})}},{key:"disableShowOutputWeighted",value:function(){this.comp_renderer_nodes.setArg("multiplyOutput",function(){return 0});for(var e=0;e<this.linksObj.length;e++)this.linksObj[e].componentRenderer.setArg("multiplyOutput",function(){return 0});for(var t=0;t<this.arrowsObj.length;t++)this.arrowsObj[t].componentRenderer.setArg("multiplyOutput",function(){return 0})}}],[{key:"datetimeToTimestamp",value:function(e){return Date.parse(e)}},{key:"timestampToDate",value:function(e){var t=new Date(e);return(t=t.toISOString().split("T")[0].split("-"))[2]+"/"+t[1]+"/"+t[0]}}]),e}();o.Graph=h,t.exports.Graph=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./KERNEL_ADJMATRIX_UPDATE.class":3,"./KERNEL_DIR.class":4,"./ProccessImg.class":5,"./VFP_NODE.class":6,"./VFP_NODEPICKDRAG.class":7,scejs:1}],3:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.KERNEL_ADJMATRIX_UPDATE=function(){function e(){n(this,e)}return o(e,null,[{key:"getSrc",value:function(e){return["x",["adjacencyMatrix"],"","vec4 adjMat = adjacencyMatrix[x]; \n            vec4 adjMatB = adjacencyMatrixB[x]; \n            vec4 adjMatC = adjacencyMatrixC[x]; \n\n            float linkBornDate = adjMat.x;\n            float linkDieDate = adjMat.y;\n            float linkWeight = adjMat.z;\n            float linkTypeParent = adjMat.w;\n\n            float id = adjMatB.z;\n            float idInv = adjMatB.w;\n            float linkLayerNum = adjMatC.y;\n\n           if(linkTypeParent == 0.5) {\n                vec2 xGeometryCurrentChild = get_global_id(id, bufferNodesWidth, "+e.toFixed(1)+");\n                vec2 xGeometryParent = get_global_id(idInv, bufferNodesWidth, "+e.toFixed(1)+");\n\n                float childGOutputA = dataB[xGeometryCurrentChild].z;\n                float parentGErrorA = dataB[xGeometryParent].w;\n                \n                float childGOutputB = dataF[xGeometryCurrentChild].x;\n                float parentGErrorB = dataF[xGeometryParent].y;\n                \n                float childGOutputC = dataF[xGeometryCurrentChild].z;\n                float parentGErrorC = dataF[xGeometryParent].w;\n                \n                float childGOutputD = dataG[xGeometryCurrentChild].x;\n                float parentGErrorD = dataG[xGeometryParent].y;\n                \n                float childGOutputE = dataG[xGeometryCurrentChild].z;\n                float parentGErrorE = dataG[xGeometryParent].w;\n                \n                float childGOutputF = dataH[xGeometryCurrentChild].x;\n                float parentGErrorF = dataH[xGeometryParent].y;\n                \n                float childGOutputG = dataH[xGeometryCurrentChild].z;\n                float parentGErrorG = dataH[xGeometryParent].w;                \n            \n                if(linkLayerNum > 0.0) {                        \n                    float learningRate = 0.01;\n                    float l2_decay = 0.01;\n                    float cpu_batch_repeats = 7.0;\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputA*parentGErrorA))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputB*parentGErrorB))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputC*parentGErrorC))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputD*parentGErrorD))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputE*parentGErrorE))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputF*parentGErrorF))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputG*parentGErrorG))/(7.0*cpu_batch_repeats));\n                }\n            }\n            \n            return [vec4(linkBornDate, linkDieDate, linkWeight, linkTypeParent)];\n            "]}}]),e}();e.KERNEL_ADJMATRIX_UPDATE=a,t.exports.KERNEL_ADJMATRIX_UPDATE=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.KERNEL_DIR=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("./graphUtil"),s=r.KERNEL_DIR=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t,r,n,o){var a=null,s=null;return!0===o?(a=["dir","posXYZW","dataB","dataF","dataG","dataH"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0), currentDataB, currentDataF, currentDataG, currentDataH];"):(a=["dir","posXYZW"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0)];"),["x",a,i.GraphUtils.adjMatrix_ForceLayout_GLSLFunctionString(t,r,n),"float nodeId = data[x].x;\n                    float numOfConnections = data[x].y;\n                    vec2 xGeometry = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n\n\n                    vec3 currentPos = posXYZW[xGeometry].xyz;\n\n                    float bornDate = dataB[xGeometry].x;\n                    float dieDate = dataB[xGeometry].y;\n\n                    vec3 currentDir = dir[xGeometry].xyz;\n\n\n                    vec4 currentDataB = dataB[xGeometry];\n                    vec4 currentDataF = dataF[xGeometry];\n                    vec4 currentDataG = dataG[xGeometry];\n                    vec4 currentDataH = dataH[xGeometry];\n\n                    currentDir = vec3(0.0, 0.0, 0.0);\n\n                    if(enableForceLayout == 1.0) {\n                        idAdjMatrixResponse adjM = idAdjMatrix_ForceLayout(nodeId, currentPos, currentDir, numOfConnections, currentTimestamp, bornDate, dieDate, enableNeuronalNetwork);\n                        currentDir = (adjM.collisionExists == 1.0) ? adjM.force : currentDir+(adjM.force*1.0);\n\n                        if(enableNeuronalNetwork == 1.0 && currentTrainLayer == -3.0) {\n                            currentDataB = vec4(currentDataB.x, currentDataB.y, adjM.netFOutputA, adjM.netErrorWeightA);\n                            currentDataF = vec4(adjM.netFOutputB, adjM.netErrorWeightB, adjM.netFOutputC, adjM.netErrorWeightC);\n                            currentDataG = vec4(adjM.netFOutputD, adjM.netErrorWeightD, adjM.netFOutputE, adjM.netErrorWeightE);\n                            currentDataH = vec4(adjM.netFOutputF, adjM.netErrorWeightF, adjM.netFOutputG, adjM.netErrorWeightG);\n                        }\n                    }\n\n                    "+(void 0!==e?e:"")+"\n\n                    if(enableDrag == 1.0) {\n                        if(nodeId == idToDrag) {\n                            currentPos = vec3(MouseDragTranslationX, MouseDragTranslationY, MouseDragTranslationZ);\n                        }\n                    }\n\n                    currentPos += currentDir;\n                    if(only2d == 1.0) {\n                        currentPos.y = 0.0;\n                    }\n\n                    "+s]}}]),e}();n.KERNEL_DIR=s,t.exports.KERNEL_DIR=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":8}],5:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ProccessImg=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.ProccessImg=function(){function e(t){o(this,e),this.stackNodesImg=t.stackNodesImg,this.drawedImages=0,this.output={nodesImg:null,nodesImgCrosshair:null};var r=t.NODE_IMG_WIDTH;this.NODE_IMG_COLUMNS=t.NODE_IMG_COLUMNS,this.NODE_IMG_SPRITE_WIDTH=r/this.NODE_IMG_COLUMNS;var n=t.nodesImgMask;this.datMask=Utils.getUint8ArrayFromHTMLImageElement(n);var a=t.nodesImgCrosshair;this.datCrosshair=Utils.getUint8ArrayFromHTMLImageElement(a),this.canvasNodeImg=document.createElement("canvas"),this.canvasNodeImg.width=r,this.canvasNodeImg.height=r,this.ctxNodeImg=this.canvasNodeImg.getContext("2d"),this.canvasNodeImgCrosshair=document.createElement("canvas"),this.canvasNodeImgCrosshair.width=r,this.canvasNodeImgCrosshair.height=r,this.ctxNodeImgCrosshair=this.canvasNodeImgCrosshair.getContext("2d");var i=document.createElement("canvas");i.width=this.NODE_IMG_SPRITE_WIDTH,i.height=this.NODE_IMG_SPRITE_WIDTH;for(var s=i.getContext("2d"),u=0;u<this.stackNodesImg.length;u++){var l=this.stackNodesImg[u],d=new Image;d.onload=function(e,r){s.clearRect(0,0,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH);var n=this.NODE_IMG_SPRITE_WIDTH/4;s.drawImage(e,0,0,e.width,e.height,n,n,this.NODE_IMG_SPRITE_WIDTH/2,this.NODE_IMG_SPRITE_WIDTH/2),(new Utils).getImageFromCanvas(i,function(e,r){e.image=Utils.getUint8ArrayFromHTMLImageElement(r);for(var n=!0,o=0;o<this.stackNodesImg.length;o++)if(null==this.stackNodesImg[o].image){n=!1;break}!0===n&&this.generateAll(t)}.bind(this,r))}.bind(this,d,l),d.src=l.url}}return a(e,[{key:"generateAll",value:function(e){for(var t=function(t,r,n){var o=this,a=function(e,t){var r=e/t,n=parseFloat(parseInt(r));return{col:Utils.fract(r)*t,row:n}}.bind(this),i=function(e){var t=function(e,t,r){this.output[t]=r,null!=this.output.nodesImg&&null!=this.output.nodesImgCrosshair&&e(this.output)}.bind(this,e);(new Utils).getImageFromCanvas(this.canvasNodeImg,function(e){t("nodesImg",e)}.bind(this)),(new Utils).getImageFromCanvas(this.canvasNodeImgCrosshair,function(e){t("nodesImgCrosshair",e)}.bind(this))}.bind(this,e.onend);(new Utils).getImageFromCanvas(Utils.getCanvasFromUint8Array(n,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH),function(e){var n=a(t.locationIdx,o.NODE_IMG_COLUMNS);r.drawImage(e,n.col*o.NODE_IMG_SPRITE_WIDTH,n.row*o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH),o.drawedImages++,o.drawedImages===2*o.stackNodesImg.length&&i()})}.bind(this),r=0;r<this.stackNodesImg.length;r++){for(var n=this.stackNodesImg[r],o=this.stackNodesImg[r].image,a=0;a<this.datMask.length/4;a++){var i=4*a;o[i+3]>0&&(o[i+3]=this.datMask[i+3])}t(n,this.ctxNodeImg,o);for(var s=0;s<this.datCrosshair.length/4;s++){var u=4*s;o[u]=(this.datCrosshair[u]*this.datCrosshair[u+3]+o[u]*(255-this.datCrosshair[u+3]))/255,o[u+1]=(this.datCrosshair[u+1]*this.datCrosshair[u+3]+o[u+1]*(255-this.datCrosshair[u+3]))/255,o[u+2]=(this.datCrosshair[u+2]*this.datCrosshair[u+3]+o[u+2]*(255-this.datCrosshair[u+3]))/255,o[u+3]=(this.datCrosshair[u+3]*this.datCrosshair[u+3]+o[u+3]*(255-this.datCrosshair[u+3]))/255}t(n,this.ctxNodeImgCrosshair,o)}}}]),e}();n.ProccessImg=i,t.exports.ProccessImg=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],6:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODE=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./graphUtil"),s=r.VFP_NODE=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t){return[["RGB"],"varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\nvec2 get2Dfrom1D(float idx, float columns) {float n = idx/columns;float row = float(int(n));float col = fract(n)*columns;float ts = 1.0/columns;return vec2(ts*col, ts*row);}mat4 lookAt(vec3 eye, vec3 center, vec3 up) {vec3 zaxis = normalize(center - eye);vec3 xaxis = normalize(cross(up, zaxis));vec3 yaxis = cross(zaxis, xaxis);mat4 matrix;matrix[0][0] = xaxis.x;matrix[1][0] = yaxis.x;matrix[2][0] = zaxis.x;matrix[3][0] = 0.0;matrix[0][1] = xaxis.y;matrix[1][1] = yaxis.y;matrix[2][1] = zaxis.y;matrix[3][1] = 0.0;matrix[0][2] = xaxis.z;matrix[1][2] = yaxis.z;matrix[2][2] = zaxis.z;matrix[3][2] = 0.0;matrix[0][3] = -dot(xaxis, eye);matrix[1][3] = -dot(yaxis, eye);matrix[2][3] = -dot(zaxis, eye);matrix[3][3] = 1.0;return matrix;}mat4 transpose(mat4 m) {return mat4(  m[0][0], m[1][0], m[2][0], m[3][0],m[0][1], m[1][1], m[2][1], m[3][1],m[0][2], m[1][2], m[2][2], m[3][2],m[0][3], m[1][3], m[2][3], m[3][3]);}mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}"+i.GraphUtils.adjMatrix_Autolink_GLSLFunctionString(t)+Utils.degToRadGLSLFunctionString()+Utils.radToDegGLSLFunctionString()+Utils.cartesianToSphericalGLSLFunctionString()+Utils.sphericalToCartesianGLSLFunctionString()+Utils.getVectorGLSLFunctionString()+"vec3 getVV(vec3 crB, float acum) {vec3 ob = cartesianToSpherical(crB);float angleLat = ob.y;float angleLng = ob.z;float desvLat = 0.0;float desvLng = 10.0;angleLng += (acum*desvLng);return sphericalToCartesian(vec3(1.0, angleLat, angleLng));}float getOddEven(float repeatId) {return (ceil(fract(repeatId/2.0)) == 0.0) ? 1.0*floor(repeatId/2.0) : -1.0*floor(repeatId/2.0);}vec3 getFirstDispl(float nodeId, vec4 currentPosition, float repeatId) {float repeatDistribution = -0.1;vec4 adjMatrix = idAdjMatrix_Autolink(nodeId, currentPosition.xyz);vec3 initialVec = normalize(posXYZW[adjMatrix.xy].xyz-currentPosition.xyz)*vec3(1.0, -1.0, 1.0);float totalAngleRelations = adjMatrix.z;initialVec = getVV(initialVec, (totalAngleRelations/2.0)*repeatDistribution);return getVV(initialVec, getOddEven(repeatId)*totalAngleRelations*0.01);}float checkLinkArrowVisibility(float currentTimestamp, float bornDate, float dieDate, float bornDateOpposite, float dieDateOpposite, float linkBornDate, float linkDieDate) {float visible =1.0;if(dieDate != 0.0) {if((currentTimestamp < bornDate || currentTimestamp > dieDate) || (currentTimestamp < bornDateOpposite || currentTimestamp > dieDateOpposite)) {visible = 0.0;} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}return visible;}","float nodeId = data[].x;float nodeIdOpposite = data[].y;float currentLineVertex = data[].z;float repeatId = data[].w;vec2 xGeometryNode = get_global_id(nodeId, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryNode_opposite = get_global_id(nodeIdOpposite, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryLinks = get_global_id(nodeId, bufferLinksWidth, 2.0);vec2 xGeometryLinks_opposite = get_global_id(nodeIdOpposite, bufferLinksWidth, 2.0);vec2 xGeometryArrows = get_global_id(nodeId, bufferArrowsWidth, 3.0);vec2 xGeometryArrows_opposite = get_global_id(nodeIdOpposite, bufferArrowsWidth, 3.0);vec2 xGeometryText = get_global_id(nodeId, bufferTextsWidth, 4.0*12.0);vec2 xGeometryText_opposite = get_global_id(nodeIdOpposite, bufferTextsWidth, 4.0*12.0);vec4 nodeVertexPosition = nodeVertexPos[];\nvec4 nodeVertexTex = nodeVertexTexture[];\nfloat linkBornDate = dataC[].x;float linkDieDate = dataC[].y;float bornDate = dataB[xGeometryNode].x;float dieDate = dataB[xGeometryNode].y;float foutput = dataB[xGeometryNode].z;float error = dataF[xGeometryNode].x;float bornDateOpposite = dataB[xGeometryNode_opposite].x;float dieDateOpposite = dataB[xGeometryNode_opposite].y;vec4 currentPosition = posXYZW[xGeometryNode];\nvec3 oppositePosition = posXYZW[xGeometryNode_opposite].xyz;\nvec4 nodeVertexColor = vec4(1.0, 1.0, 1.0, 1.0);\nvec4 nodeVertexColorNetError = vec4(1.0, 1.0, 1.0, 1.0);\nvec3 dir = oppositePosition-vec3(currentPosition.x, currentPosition.y, currentPosition.z);float dist = length(dir);float vertexCount = 1.0;float lineIncrements = dist/vertexCount;vec3 dirN = normalize(dir);vec3 cr = cross(dirN, vec3(0.0, 1.0, 0.0));float currentLineVertexSQRT = abs( currentLineVertex-(vertexCount/2.0) )/(vertexCount/2.0);currentLineVertexSQRT = sqrt(1.0-currentLineVertexSQRT);vVertexUV = vec2(-1.0, -1.0);vDist = max(0.3, 1.0-(distance(currentPosition.xyz, oppositePosition)*0.01));\nmat4 nodepos = nodeWMatrix;if(isNode == 1.0) {vVisibility = 1.0;currentPosition += vec4(0.0, 0.1, 0.0, 1.0);mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;float nodeImgId = nodeImgId[];if(nodeImgId != -1.0) {vUseTex = 1.0;vVertexUV = get2Dfrom1D(nodeImgId, nodeImgColumns)+vec2(nodeVertexTexture.x/nodeImgColumns,nodeVertexTexture.y/nodeImgColumns);}if(dieDate != 0.0 && (currentTimestamp < bornDate || currentTimestamp > dieDate)) vVisibility = 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(0.0, 0.0, 0.0, 1.0);if(foutput > 0.0) nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);else if(foutput < 0.0) nodeVertexColor = vec4(abs(foutput), 0.0, 0.0, 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}if(isLink == 1.0) {if(xGeometryLinks != xGeometryLinks_opposite) {currentPosition += vec4(dirN*(lineIncrements*currentLineVertex), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) currentPosition += vec4(cr*currentLineVertexSQRT*getOddEven(repeatId)*4.0, 1.0);} else {float currentLineVertexMM = abs( currentLineVertex-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPosition += vec4(initialVec*(5.0*currentLineVertexMM), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPosition += vec4((crB*sig)*currentLineVertexMMB*1.0, 1.0);}}vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}}if(isArrow == 1.0) {vec3 currentPositionTMP;if(xGeometryArrows != xGeometryArrows_opposite) {float currentLineVertexU = vertexCount-1.0;currentPositionTMP = oppositePosition+((dirN*-1.0)*(lineIncrements*currentLineVertexU));currentPositionTMP -= cr*(currentLineVertexSQRT*getOddEven(repeatId)*4.0);} else {float currentLineVertexU = vertexCount-1.0;float currentLineVertexMM = abs( currentLineVertexU-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPositionTMP = oppositePosition+(initialVec*(5.0*currentLineVertexMM));if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPositionTMP += (crB*sig)*currentLineVertexMMB*1.0;}}mat4 pp = lookAt(currentPositionTMP, vec3(currentPosition.x, currentPosition.y, currentPosition.z), vec3(0.0, 1.0, 0.0));pp = transpose(pp);nodepos[0][0] = pp[0][0];nodepos[0][1] = pp[1][0];nodepos[0][2] = pp[2][0];nodepos[1][0] = pp[0][1];nodepos[1][1] = pp[1][1];nodepos[1][2] = pp[2][1];nodepos[2][0] = pp[0][2];nodepos[2][1] = pp[1][2];nodepos[2][2] = pp[2][2];dir = currentPositionTMP-vec3(currentPosition.x, currentPosition.y, currentPosition.z);currentPosition += vec4(normalize(dir),1.0)*2.0;vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;}if(isNodeText == 1.0) {float letId = letterId[];\nmat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;vVertexUV = get2Dfrom1D(letId, fontImgColumns)+vec2(nodeVertexTexture.x/fontImgColumns,nodeVertexTexture.y/fontImgColumns);nodeVertexPosition = vec4(nodeVertexPosition.x*0.1, nodeVertexPosition.y*0.1, nodeVertexPosition.z*0.1, 1.0);currentPosition.z += 2.5;vVisibility = 1.0;vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}nodepos[3][0] = currentPosition.x;nodepos[3][1] = currentPosition.y;nodepos[3][2] = currentPosition.z;mat4 nodeposG = nodeWMatrix;vWNMatrix = nodeposG * nodeVertexNormal[];\nvUseCrosshair = 0.0;vIstarget = (currentLineVertex == 1.0) ? 1.0 : 0.0;"+e+"vVertexColor = nodeVertexColor;vVertexColorNetError = nodeVertexColorNetError;vUV = nodeVertexTexture;vNodeId = nodeId;\nvNodeIdOpposite = nodeIdOpposite;\ngl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPosition;\n","varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\n","vec4 color = vVertexColor;\nvec4 colorB = vVertexColorNetError;\nvec4 colorOrange = vec4(255.0/255.0, 131.0/255.0, 0.0/255.0, 1.0);vec4 colorOrangeDark = vec4(255.0/255.0, 80.0/255.0, 0.0/255.0, 1.0);vec4 colorPurple = vec4(132.0/255.0, 0.0/255.0, 255.0/255.0, 1.0);vec4 fcolor = vec4(0.0, 0.0, 0.0, 1.0);if(isNode == 1.0) {if(vUseTex == 1.0) {vec4 tex;if(vUseCrosshair == 1.0) {tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsSelected == 1.0) {color = colorOrangeDark;tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsHover == 1.0) {color = colorPurple;tex = nodesImg[vVertexUV.xy];} else {tex = nodesImg[vVertexUV.xy];}color = "+i.GraphUtils.nodesDrawMode(t)+";\n}if(color.a < 0.1) discard;fcolor = color;\nif(enableNeuronalNetwork == 1.0) {if(vUV.y > (0.7)) fcolor = colorB;\n}} else if(isLink == 1.0) {if(vIsSelected == 1.0) color = colorOrange;else if(vIsHover == 1.0) color = colorPurple;if(enableNeuronalNetwork == 1.0) {vec2 xAdjMatCurrent = get_global_id(vec2(vNodeIdOpposite, vNodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nvec4 pixAdjMatCCurrent = adjacencyMatrixC[xAdjMatCurrent];\nif(pixAdjMatACurrent.z > 0.0) fcolor = vec4(0.0, pixAdjMatACurrent.z, 0.0, 1.0);\nelse fcolor = vec4(abs(pixAdjMatACurrent.z), 0.0, 0.0, 1.0);\nif(multiplyOutput == 1.0) fcolor *= vec4(color.xyz, 1.0);\n} else fcolor = vec4(color.xyz, 1.0);\n} else if(isArrow == 1.0) {if(vIstarget == 1.0) {if(vIsSelected == 1.0) {color = vec4(colorOrange.rgb*vDist, 1.0);\n} else if(vIsHover == 1.0) {color = vec4(colorPurple.rgb*vDist, 1.0);\n}} else {color = vec4(1.0, 0.0, 0.0, 0.0);}fcolor = color;\n} else if(isNodeText == 1.0) {fcolor = fontsImg[vVertexUV.xy];\n}if(vVisibility == 0.0) discard;return [fcolor];"]}}]),e}();n.VFP_NODE=s,t.exports.VFP_NODE=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":8,scejs:1}],7:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODEPICKDRAG=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.VFP_NODEPICKDRAG=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e){return[[void 0],"varying vec4 vColor;\n"+Utils.packGLSLFunctionString()+"mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}","vec2 xGeometry = get_global_id(data[].x, uBufferWidth, "+e.toFixed(1)+");vec4 nodePosition = posXYZW[xGeometry];\nfloat bornDate = dataB[xGeometry].x;float dieDate = dataB[xGeometry].y;mat4 nodepos = nodeWMatrix;mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;nodepos[3][0] = nodePosition.x;nodepos[3][1] = nodePosition.y;nodepos[3][2] = nodePosition.z;vColor = vec4(1.0, 1.0, 1.0, 1.0);int mak = 0;if(dieDate != 0.0) {if(currentTimestamp > bornDate && currentTimestamp < dieDate) mak = 1;} else mak = 1;if(mak == 1) {vColor = pack((data[].x+1.0)/1000000.0);}if(vColor.x == 1.0 && vColor.y == 1.0 && vColor.z == 1.0 && vColor.w == 1.0) nodepos[3][0] = 10000.0;gl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPos[];\ngl_PointSize = 10.0;\n","varying vec4 vColor;\n","return [vColor];\n"]}}]),e}();n.VFP_NODEPICKDRAG=i,t.exports.VFP_NODEPICKDRAG=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}],8:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={GBrain:"./gbrain",GBrainRL:"./gbrain-rl",Graph:"./Graph.class",GraphUtils:"./graphUtil",KERNEL_ADJMATRIX_UPDATE:"./KERNEL_ADJMATRIX_UPDATE.class.js",KERNEL_DIR:"./KERNEL_DIR.class.js",ProccessImg:"./ProccessImg.class.js",VFP_NODE:"./VFP_NODE.class.js",VFP_NODEPICKDRAG:"./VFP_NODEPICKDRAG.class.js"};for(var o in n)r[o]=e(n[o])},{}]},{},[1]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.KERNEL_ADJMATRIX_UPDATE=function(){function e(){n(this,e)}return o(e,null,[{key:"getSrc",value:function(e){return["x",["adjacencyMatrix"],"","vec4 adjMat = adjacencyMatrix[x]; \n            vec4 adjMatB = adjacencyMatrixB[x]; \n            vec4 adjMatC = adjacencyMatrixC[x]; \n\n            float linkBornDate = adjMat.x;\n            float linkDieDate = adjMat.y;\n            float linkWeight = adjMat.z;\n            float linkTypeParent = adjMat.w;\n\n            float id = adjMatB.z;\n            float idInv = adjMatB.w;\n            float linkLayerNum = adjMatC.y;\n\n           if(linkTypeParent == 0.5) {\n                vec2 xGeometryCurrentChild = get_global_id(id, bufferNodesWidth, "+e.toFixed(1)+");\n                vec2 xGeometryParent = get_global_id(idInv, bufferNodesWidth, "+e.toFixed(1)+");\n\n                float childGOutputA = dataB[xGeometryCurrentChild].z;\n                float parentGErrorA = dataB[xGeometryParent].w;\n                \n                float childGOutputB = dataF[xGeometryCurrentChild].x;\n                float parentGErrorB = dataF[xGeometryParent].y;\n                \n                float childGOutputC = dataF[xGeometryCurrentChild].z;\n                float parentGErrorC = dataF[xGeometryParent].w;\n                \n                float childGOutputD = dataG[xGeometryCurrentChild].x;\n                float parentGErrorD = dataG[xGeometryParent].y;\n                \n                float childGOutputE = dataG[xGeometryCurrentChild].z;\n                float parentGErrorE = dataG[xGeometryParent].w;\n                \n                float childGOutputF = dataH[xGeometryCurrentChild].x;\n                float parentGErrorF = dataH[xGeometryParent].y;\n                \n                float childGOutputG = dataH[xGeometryCurrentChild].z;\n                float parentGErrorG = dataH[xGeometryParent].w;                \n            \n                if(linkLayerNum > 0.0) {                        \n                    float learningRate = 0.01;\n                    float l2_decay = 0.01;\n                    float cpu_batch_repeats = 7.0;\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputA*parentGErrorA))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputB*parentGErrorB))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputC*parentGErrorC))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputD*parentGErrorD))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputE*parentGErrorE))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputF*parentGErrorF))/(7.0*cpu_batch_repeats));\n                    linkWeight += -learningRate*(((l2_decay*linkWeight)+(childGOutputG*parentGErrorG))/(7.0*cpu_batch_repeats));\n                }\n            }\n            \n            return [vec4(linkBornDate, linkDieDate, linkWeight, linkTypeParent)];\n            "]}}]),e}();e.KERNEL_ADJMATRIX_UPDATE=a,t.exports.KERNEL_ADJMATRIX_UPDATE=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.KERNEL_DIR=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("./graphUtil"),s=r.KERNEL_DIR=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t,r,n,o){var a=null,s=null;return!0===o?(a=["dir","posXYZW","dataB","dataF","dataG","dataH"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0), currentDataB, currentDataF, currentDataG, currentDataH];"):(a=["dir","posXYZW"],s="return [vec4(currentDir, 1.0), vec4(currentPos.x, currentPos.y, currentPos.z, 1.0)];"),["x",a,i.GraphUtils.adjMatrix_ForceLayout_GLSLFunctionString(t,r,n),"float nodeId = data[x].x;\n                    float numOfConnections = data[x].y;\n                    vec2 xGeometry = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n\n\n                    vec3 currentPos = posXYZW[xGeometry].xyz;\n\n                    float bornDate = dataB[xGeometry].x;\n                    float dieDate = dataB[xGeometry].y;\n\n                    vec3 currentDir = dir[xGeometry].xyz;\n\n\n                    vec4 currentDataB = dataB[xGeometry];\n                    vec4 currentDataF = dataF[xGeometry];\n                    vec4 currentDataG = dataG[xGeometry];\n                    vec4 currentDataH = dataH[xGeometry];\n\n                    currentDir = vec3(0.0, 0.0, 0.0);\n\n                    if(enableForceLayout == 1.0) {\n                        idAdjMatrixResponse adjM = idAdjMatrix_ForceLayout(nodeId, currentPos, currentDir, numOfConnections, currentTimestamp, bornDate, dieDate, enableNeuronalNetwork);\n                        currentDir = (adjM.collisionExists == 1.0) ? adjM.force : currentDir+(adjM.force*1.0);\n\n                        if(enableNeuronalNetwork == 1.0 && currentTrainLayer == -3.0) {\n                            currentDataB = vec4(currentDataB.x, currentDataB.y, adjM.netFOutputA, adjM.netErrorWeightA);\n                            currentDataF = vec4(adjM.netFOutputB, adjM.netErrorWeightB, adjM.netFOutputC, adjM.netErrorWeightC);\n                            currentDataG = vec4(adjM.netFOutputD, adjM.netErrorWeightD, adjM.netFOutputE, adjM.netErrorWeightE);\n                            currentDataH = vec4(adjM.netFOutputF, adjM.netErrorWeightF, adjM.netFOutputG, adjM.netErrorWeightG);\n                        }\n                    }\n\n                    "+(void 0!==e?e:"")+"\n\n                    if(enableDrag == 1.0) {\n                        if(nodeId == idToDrag) {\n                            currentPos = vec3(MouseDragTranslationX, MouseDragTranslationY, MouseDragTranslationZ);\n                        }\n                    }\n\n                    currentPos += currentDir;\n                    if(only2d == 1.0) {\n                        currentPos.y = 0.0;\n                    }\n\n                    "+s]}}]),e}();n.KERNEL_DIR=s,t.exports.KERNEL_DIR=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":2}],2:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ProccessImg=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.ProccessImg=function(){function e(t){o(this,e),this.stackNodesImg=t.stackNodesImg,this.drawedImages=0,this.output={nodesImg:null,nodesImgCrosshair:null};var r=t.NODE_IMG_WIDTH;this.NODE_IMG_COLUMNS=t.NODE_IMG_COLUMNS,this.NODE_IMG_SPRITE_WIDTH=r/this.NODE_IMG_COLUMNS;var n=t.nodesImgMask;this.datMask=Utils.getUint8ArrayFromHTMLImageElement(n);var a=t.nodesImgCrosshair;this.datCrosshair=Utils.getUint8ArrayFromHTMLImageElement(a),this.canvasNodeImg=document.createElement("canvas"),this.canvasNodeImg.width=r,this.canvasNodeImg.height=r,this.ctxNodeImg=this.canvasNodeImg.getContext("2d"),this.canvasNodeImgCrosshair=document.createElement("canvas"),this.canvasNodeImgCrosshair.width=r,this.canvasNodeImgCrosshair.height=r,this.ctxNodeImgCrosshair=this.canvasNodeImgCrosshair.getContext("2d");var i=document.createElement("canvas");i.width=this.NODE_IMG_SPRITE_WIDTH,i.height=this.NODE_IMG_SPRITE_WIDTH;for(var s=i.getContext("2d"),u=0;u<this.stackNodesImg.length;u++){var l=this.stackNodesImg[u],d=new Image;d.onload=function(e,r){s.clearRect(0,0,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH);var n=this.NODE_IMG_SPRITE_WIDTH/4;s.drawImage(e,0,0,e.width,e.height,n,n,this.NODE_IMG_SPRITE_WIDTH/2,this.NODE_IMG_SPRITE_WIDTH/2),(new Utils).getImageFromCanvas(i,function(e,r){e.image=Utils.getUint8ArrayFromHTMLImageElement(r);for(var n=!0,o=0;o<this.stackNodesImg.length;o++)if(null==this.stackNodesImg[o].image){n=!1;break}!0===n&&this.generateAll(t)}.bind(this,r))}.bind(this,d,l),d.src=l.url}}return a(e,[{key:"generateAll",value:function(e){for(var t=function(t,r,n){var o=this,a=function(e,t){var r=e/t,n=parseFloat(parseInt(r));return{col:Utils.fract(r)*t,row:n}}.bind(this),i=function(e){var t=function(e,t,r){this.output[t]=r,null!=this.output.nodesImg&&null!=this.output.nodesImgCrosshair&&e(this.output)}.bind(this,e);(new Utils).getImageFromCanvas(this.canvasNodeImg,function(e){t("nodesImg",e)}.bind(this)),(new Utils).getImageFromCanvas(this.canvasNodeImgCrosshair,function(e){t("nodesImgCrosshair",e)}.bind(this))}.bind(this,e.onend);(new Utils).getImageFromCanvas(Utils.getCanvasFromUint8Array(n,this.NODE_IMG_SPRITE_WIDTH,this.NODE_IMG_SPRITE_WIDTH),function(e){var n=a(t.locationIdx,o.NODE_IMG_COLUMNS);r.drawImage(e,n.col*o.NODE_IMG_SPRITE_WIDTH,n.row*o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH,o.NODE_IMG_SPRITE_WIDTH),o.drawedImages++,o.drawedImages===2*o.stackNodesImg.length&&i()})}.bind(this),r=0;r<this.stackNodesImg.length;r++){for(var n=this.stackNodesImg[r],o=this.stackNodesImg[r].image,a=0;a<this.datMask.length/4;a++){var i=4*a;o[i+3]>0&&(o[i+3]=this.datMask[i+3])}t(n,this.ctxNodeImg,o);for(var s=0;s<this.datCrosshair.length/4;s++){var u=4*s;o[u]=(this.datCrosshair[u]*this.datCrosshair[u+3]+o[u]*(255-this.datCrosshair[u+3]))/255,o[u+1]=(this.datCrosshair[u+1]*this.datCrosshair[u+3]+o[u+1]*(255-this.datCrosshair[u+3]))/255,o[u+2]=(this.datCrosshair[u+2]*this.datCrosshair[u+3]+o[u+2]*(255-this.datCrosshair[u+3]))/255,o[u+3]=(this.datCrosshair[u+3]*this.datCrosshair[u+3]+o[u+3]*(255-this.datCrosshair[u+3]))/255}t(n,this.ctxNodeImgCrosshair,o)}}}]),e}();n.ProccessImg=i,t.exports.ProccessImg=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}]},{},[2]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODE=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=e("./graphUtil"),s=r.VFP_NODE=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e,t){return[["RGB"],"varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\nvec2 get2Dfrom1D(float idx, float columns) {float n = idx/columns;float row = float(int(n));float col = fract(n)*columns;float ts = 1.0/columns;return vec2(ts*col, ts*row);}mat4 lookAt(vec3 eye, vec3 center, vec3 up) {vec3 zaxis = normalize(center - eye);vec3 xaxis = normalize(cross(up, zaxis));vec3 yaxis = cross(zaxis, xaxis);mat4 matrix;matrix[0][0] = xaxis.x;matrix[1][0] = yaxis.x;matrix[2][0] = zaxis.x;matrix[3][0] = 0.0;matrix[0][1] = xaxis.y;matrix[1][1] = yaxis.y;matrix[2][1] = zaxis.y;matrix[3][1] = 0.0;matrix[0][2] = xaxis.z;matrix[1][2] = yaxis.z;matrix[2][2] = zaxis.z;matrix[3][2] = 0.0;matrix[0][3] = -dot(xaxis, eye);matrix[1][3] = -dot(yaxis, eye);matrix[2][3] = -dot(zaxis, eye);matrix[3][3] = 1.0;return matrix;}mat4 transpose(mat4 m) {return mat4(  m[0][0], m[1][0], m[2][0], m[3][0],m[0][1], m[1][1], m[2][1], m[3][1],m[0][2], m[1][2], m[2][2], m[3][2],m[0][3], m[1][3], m[2][3], m[3][3]);}mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}"+i.GraphUtils.adjMatrix_Autolink_GLSLFunctionString(t)+Utils.degToRadGLSLFunctionString()+Utils.radToDegGLSLFunctionString()+Utils.cartesianToSphericalGLSLFunctionString()+Utils.sphericalToCartesianGLSLFunctionString()+Utils.getVectorGLSLFunctionString()+"vec3 getVV(vec3 crB, float acum) {vec3 ob = cartesianToSpherical(crB);float angleLat = ob.y;float angleLng = ob.z;float desvLat = 0.0;float desvLng = 10.0;angleLng += (acum*desvLng);return sphericalToCartesian(vec3(1.0, angleLat, angleLng));}float getOddEven(float repeatId) {return (ceil(fract(repeatId/2.0)) == 0.0) ? 1.0*floor(repeatId/2.0) : -1.0*floor(repeatId/2.0);}vec3 getFirstDispl(float nodeId, vec4 currentPosition, float repeatId) {float repeatDistribution = -0.1;vec4 adjMatrix = idAdjMatrix_Autolink(nodeId, currentPosition.xyz);vec3 initialVec = normalize(posXYZW[adjMatrix.xy].xyz-currentPosition.xyz)*vec3(1.0, -1.0, 1.0);float totalAngleRelations = adjMatrix.z;initialVec = getVV(initialVec, (totalAngleRelations/2.0)*repeatDistribution);return getVV(initialVec, getOddEven(repeatId)*totalAngleRelations*0.01);}float checkLinkArrowVisibility(float currentTimestamp, float bornDate, float dieDate, float bornDateOpposite, float dieDateOpposite, float linkBornDate, float linkDieDate) {float visible =1.0;if(dieDate != 0.0) {if((currentTimestamp < bornDate || currentTimestamp > dieDate) || (currentTimestamp < bornDateOpposite || currentTimestamp > dieDateOpposite)) {visible = 0.0;} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}} else {if(linkDieDate != 0.0) {if(currentTimestamp < linkBornDate || currentTimestamp > linkDieDate) {visible = 0.0;}}}return visible;}","float nodeId = data[].x;float nodeIdOpposite = data[].y;float currentLineVertex = data[].z;float repeatId = data[].w;vec2 xGeometryNode = get_global_id(nodeId, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryNode_opposite = get_global_id(nodeIdOpposite, bufferNodesWidth, "+t.toFixed(1)+");vec2 xGeometryLinks = get_global_id(nodeId, bufferLinksWidth, 2.0);vec2 xGeometryLinks_opposite = get_global_id(nodeIdOpposite, bufferLinksWidth, 2.0);vec2 xGeometryArrows = get_global_id(nodeId, bufferArrowsWidth, 3.0);vec2 xGeometryArrows_opposite = get_global_id(nodeIdOpposite, bufferArrowsWidth, 3.0);vec2 xGeometryText = get_global_id(nodeId, bufferTextsWidth, 4.0*12.0);vec2 xGeometryText_opposite = get_global_id(nodeIdOpposite, bufferTextsWidth, 4.0*12.0);vec4 nodeVertexPosition = nodeVertexPos[];\nvec4 nodeVertexTex = nodeVertexTexture[];\nfloat linkBornDate = dataC[].x;float linkDieDate = dataC[].y;float bornDate = dataB[xGeometryNode].x;float dieDate = dataB[xGeometryNode].y;float foutput = dataB[xGeometryNode].z;float error = dataF[xGeometryNode].x;float bornDateOpposite = dataB[xGeometryNode_opposite].x;float dieDateOpposite = dataB[xGeometryNode_opposite].y;vec4 currentPosition = posXYZW[xGeometryNode];\nvec3 oppositePosition = posXYZW[xGeometryNode_opposite].xyz;\nvec4 nodeVertexColor = vec4(1.0, 1.0, 1.0, 1.0);\nvec4 nodeVertexColorNetError = vec4(1.0, 1.0, 1.0, 1.0);\nvec3 dir = oppositePosition-vec3(currentPosition.x, currentPosition.y, currentPosition.z);float dist = length(dir);float vertexCount = 1.0;float lineIncrements = dist/vertexCount;vec3 dirN = normalize(dir);vec3 cr = cross(dirN, vec3(0.0, 1.0, 0.0));float currentLineVertexSQRT = abs( currentLineVertex-(vertexCount/2.0) )/(vertexCount/2.0);currentLineVertexSQRT = sqrt(1.0-currentLineVertexSQRT);vVertexUV = vec2(-1.0, -1.0);vDist = max(0.3, 1.0-(distance(currentPosition.xyz, oppositePosition)*0.01));\nmat4 nodepos = nodeWMatrix;if(isNode == 1.0) {vVisibility = 1.0;currentPosition += vec4(0.0, 0.1, 0.0, 1.0);mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;float nodeImgId = nodeImgId[];if(nodeImgId != -1.0) {vUseTex = 1.0;vVertexUV = get2Dfrom1D(nodeImgId, nodeImgColumns)+vec2(nodeVertexTexture.x/nodeImgColumns,nodeVertexTexture.y/nodeImgColumns);}if(dieDate != 0.0 && (currentTimestamp < bornDate || currentTimestamp > dieDate)) vVisibility = 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(0.0, 0.0, 0.0, 1.0);if(foutput > 0.0) nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);else if(foutput < 0.0) nodeVertexColor = vec4(abs(foutput), 0.0, 0.0, 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}if(isLink == 1.0) {if(xGeometryLinks != xGeometryLinks_opposite) {currentPosition += vec4(dirN*(lineIncrements*currentLineVertex), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) currentPosition += vec4(cr*currentLineVertexSQRT*getOddEven(repeatId)*4.0, 1.0);} else {float currentLineVertexMM = abs( currentLineVertex-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPosition += vec4(initialVec*(5.0*currentLineVertexMM), 1.0);if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPosition += vec4((crB*sig)*currentLineVertexMMB*1.0, 1.0);}}vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;if(enableNeuronalNetwork == 1.0) {nodeVertexColor = vec4(abs(foutput), abs(foutput), abs(foutput), 1.0);if(error > 0.0) nodeVertexColorNetError = vec4(0.0, abs(error), 0.0, 1.0);else if(error < 0.0) nodeVertexColorNetError = vec4(abs(error), 0.0, 0.0, 1.0);else nodeVertexColorNetError = vec4(0.0,0.0,0.0, 0.0);}}if(isArrow == 1.0) {vec3 currentPositionTMP;if(xGeometryArrows != xGeometryArrows_opposite) {float currentLineVertexU = vertexCount-1.0;currentPositionTMP = oppositePosition+((dirN*-1.0)*(lineIncrements*currentLineVertexU));currentPositionTMP -= cr*(currentLineVertexSQRT*getOddEven(repeatId)*4.0);} else {float currentLineVertexU = vertexCount-1.0;float currentLineVertexMM = abs( currentLineVertexU-(vertexCount/2.0) );currentLineVertexMM = (vertexCount/2.0)-currentLineVertexMM;vec3 initialVec = getFirstDispl(nodeId, currentPosition, repeatId);currentPositionTMP = oppositePosition+(initialVec*(5.0*currentLineVertexMM));if(currentLineVertex != 0.0 && currentLineVertex != vertexCount) {float sig = (currentLineVertex > (vertexCount/2.0)) ? 1.0 : -1.0;vec3 crB = cross(vec3(0.0, 1.0, 0.0), initialVec);float hhSCount = (vertexCount/2.0)/2.0;float currentLineVertexMMB = hhSCount-(abs(currentLineVertexMM-hhSCount));currentPositionTMP += (crB*sig)*currentLineVertexMMB*1.0;}}mat4 pp = lookAt(currentPositionTMP, vec3(currentPosition.x, currentPosition.y, currentPosition.z), vec3(0.0, 1.0, 0.0));pp = transpose(pp);nodepos[0][0] = pp[0][0];nodepos[0][1] = pp[1][0];nodepos[0][2] = pp[2][0];nodepos[1][0] = pp[0][1];nodepos[1][1] = pp[1][1];nodepos[1][2] = pp[2][1];nodepos[2][0] = pp[0][2];nodepos[2][1] = pp[1][2];nodepos[2][2] = pp[2][2];dir = currentPositionTMP-vec3(currentPosition.x, currentPosition.y, currentPosition.z);currentPosition += vec4(normalize(dir),1.0)*2.0;vVisibility = checkLinkArrowVisibility(currentTimestamp, bornDate, dieDate, bornDateOpposite, dieDateOpposite, linkBornDate, linkDieDate);vIsSelected = (idToDrag == data[].x || idToDrag == data[].y) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x || idToHover == data[].y) ? 1.0 : 0.0;}if(isNodeText == 1.0) {float letId = letterId[];\nmat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;vVertexUV = get2Dfrom1D(letId, fontImgColumns)+vec2(nodeVertexTexture.x/fontImgColumns,nodeVertexTexture.y/fontImgColumns);nodeVertexPosition = vec4(nodeVertexPosition.x*0.1, nodeVertexPosition.y*0.1, nodeVertexPosition.z*0.1, 1.0);currentPosition.z += 2.5;vVisibility = 1.0;vIsSelected = (idToDrag == data[].x) ? 1.0 : 0.0;vIsHover = (idToHover == data[].x) ? 1.0 : 0.0;}nodepos[3][0] = currentPosition.x;nodepos[3][1] = currentPosition.y;nodepos[3][2] = currentPosition.z;mat4 nodeposG = nodeWMatrix;vWNMatrix = nodeposG * nodeVertexNormal[];\nvUseCrosshair = 0.0;vIstarget = (currentLineVertex == 1.0) ? 1.0 : 0.0;"+e+"vVertexColor = nodeVertexColor;vVertexColorNetError = nodeVertexColorNetError;vUV = nodeVertexTexture;vNodeId = nodeId;\nvNodeIdOpposite = nodeIdOpposite;\ngl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPosition;\n","varying vec4 vVertexColor;\nvarying vec4 vVertexColorNetError;\nvarying vec4 vUV;\nvarying vec2 vVertexUV;\nvarying float vUseTex;\nvarying vec4 vWNMatrix;\nvarying float vNodeId;\nvarying float vNodeIdOpposite;\nvarying float vDist;\nvarying float vVisibility;\nvarying float vIsSelected;\nvarying float vIsHover;\nvarying float vUseCrosshair;\nvarying float vIstarget;\n","vec4 color = vVertexColor;\nvec4 colorB = vVertexColorNetError;\nvec4 colorOrange = vec4(255.0/255.0, 131.0/255.0, 0.0/255.0, 1.0);vec4 colorOrangeDark = vec4(255.0/255.0, 80.0/255.0, 0.0/255.0, 1.0);vec4 colorPurple = vec4(132.0/255.0, 0.0/255.0, 255.0/255.0, 1.0);vec4 fcolor = vec4(0.0, 0.0, 0.0, 1.0);if(isNode == 1.0) {if(vUseTex == 1.0) {vec4 tex;if(vUseCrosshair == 1.0) {tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsSelected == 1.0) {color = colorOrangeDark;tex = nodesImgCrosshair[vVertexUV.xy];} else if(vIsHover == 1.0) {color = colorPurple;tex = nodesImg[vVertexUV.xy];} else {tex = nodesImg[vVertexUV.xy];}color = "+i.GraphUtils.nodesDrawMode(t)+";\n}if(color.a < 0.1) discard;fcolor = color;\nif(enableNeuronalNetwork == 1.0) {if(vUV.y > (0.7)) fcolor = colorB;\n}} else if(isLink == 1.0) {if(vIsSelected == 1.0) color = colorOrange;else if(vIsHover == 1.0) color = colorPurple;if(enableNeuronalNetwork == 1.0) {vec2 xAdjMatCurrent = get_global_id(vec2(vNodeIdOpposite, vNodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nvec4 pixAdjMatCCurrent = adjacencyMatrixC[xAdjMatCurrent];\nif(pixAdjMatACurrent.z > 0.0) fcolor = vec4(0.0, pixAdjMatACurrent.z, 0.0, 1.0);\nelse fcolor = vec4(abs(pixAdjMatACurrent.z), 0.0, 0.0, 1.0);\nif(multiplyOutput == 1.0) fcolor *= vec4(color.xyz, 1.0);\n} else fcolor = vec4(color.xyz, 1.0);\n} else if(isArrow == 1.0) {if(vIstarget == 1.0) {if(vIsSelected == 1.0) {color = vec4(colorOrange.rgb*vDist, 1.0);\n} else if(vIsHover == 1.0) {color = vec4(colorPurple.rgb*vDist, 1.0);\n}} else {color = vec4(1.0, 0.0, 0.0, 0.0);}fcolor = color;\n} else if(isNodeText == 1.0) {fcolor = fontsImg[vVertexUV.xy];\n}if(vVisibility == 0.0) discard;return [fcolor];"]}}]),e}();n.VFP_NODE=s,t.exports.VFP_NODE=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./graphUtil":3,scejs:1}],3:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r.GraphUtils=function(){function e(){n(this,e)}return o(e,null,[{key:"nodesDrawMode",value:function(e){return 1===e?"vec4(color.rgb, 1.0)":"vec4(tex.rgb*color.rgb, tex.a)"}},{key:"adjMatrix_ForceLayout_GLSLFunctionString",value:function(t,r,n){return"vec3 sphericalColl(vec3 currentDir, vec3 currentDirB, vec3 dirToBN) {\n            vec3 currentDirN = normalize(currentDir);\n            float pPoint = abs(dot(currentDirN, dirToBN));\n            vec3 reflectV = reflect(currentDirN*-1.0, dirToBN);\n\n            vec3 currentDirBN = normalize(currentDirB);\n            float pPointB = abs(dot(currentDirBN, dirToBN));\n\n            vec3 repulsionForce = (reflectV*-1.0)* (((1.0-pPoint)*length(currentDir))+((pPointB)*length(currentDirB)));\n\n            return (repulsionForce.x > 0.0 && repulsionForce.y > 0.0 && repulsionForce.z > 0.0) ? repulsionForce : dirToBN*-0.1;\n        }\n\n        struct CalculationResponse {\n            vec3 atraction;\n            float acumAtraction;\n            vec3 repulsion;\n            float collisionExists;\n            float netChildInputSumA;\n            float netParentErrorWeightA;\n            float netChildInputSumB;\n            float netParentErrorWeightB;\n            float netChildInputSumC;\n            float netParentErrorWeightC;\n            float netChildInputSumD;\n            float netParentErrorWeightD;\n            float netChildInputSumE;\n            float netParentErrorWeightE;\n            float netChildInputSumF;\n            float netParentErrorWeightF;\n            float netChildInputSumG;\n            float netParentErrorWeightG;\n        };CalculationResponse calculate(float nodeId,\n                                        vec4 pixAdjMatACurrent, vec4 pixAdjMatAOpposite,\n                                        vec4 pixAdjMatBCurrent, vec4 pixAdjMatBOpposite,\n                                        vec2 xGeomCurrent, vec2 xGeomOpposite,\n                                        vec3 currentPos, vec3 currentDir,\n                                        vec3 atraction, float acumAtraction, vec3 repulsion,\n                                        float enableNeuronalNetwork,\n                                        float netChildInputSumA, float netParentErrorWeightA,\n                                        float netChildInputSumB, float netParentErrorWeightB,\n                                        float netChildInputSumC, float netParentErrorWeightC,\n                                        float netChildInputSumD, float netParentErrorWeightD,\n                                        float netChildInputSumE, float netParentErrorWeightE,\n                                        float netChildInputSumF, float netParentErrorWeightF,\n                                        float netChildInputSumG, float netParentErrorWeightG) {float currentBornDate = pixAdjMatACurrent.x;\n            float currentDieDate = pixAdjMatACurrent.y;\n            float currentWeight = pixAdjMatACurrent.z;\n            float currentIsParent = pixAdjMatACurrent.w;float oppositeBornDate = pixAdjMatAOpposite.x;\n            float oppositeDieDate = pixAdjMatAOpposite.y;\n            float oppositeWeight = pixAdjMatAOpposite.z;\n            float oppositeIsParent = pixAdjMatAOpposite.w;float currentLinkMultiplier = pixAdjMatBCurrent.x;\n            float currentActivationFn = pixAdjMatBCurrent.y;float oppositeLinkMultiplier = pixAdjMatBOpposite.x;\n            float oppositeActivationFn = pixAdjMatBOpposite.y;float oppositeNetOutputA = dataB[xGeomOpposite].z;\n            float oppositeNetErrorA = dataB[xGeomOpposite].w;\n\n            float oppositeNetOutputB = dataF[xGeomOpposite].x;\n            float oppositeNetErrorB = dataF[xGeomOpposite].y;\n        \n            float oppositeNetOutputC = dataF[xGeomOpposite].z;\n            float oppositeNetErrorC = dataF[xGeomOpposite].w;\n        \n            float oppositeNetOutputD = dataG[xGeomOpposite].x;\n            float oppositeNetErrorD = dataG[xGeomOpposite].y;\n        \n            float oppositeNetOutputE = dataG[xGeomOpposite].z;\n            float oppositeNetErrorE = dataG[xGeomOpposite].w;\n        \n            float oppositeNetOutputF = dataH[xGeomOpposite].x;\n            float oppositeNetErrorF = dataH[xGeomOpposite].y;\n        \n            float oppositeNetOutputG = dataH[xGeomOpposite].z;\n            float oppositeNetErrorG = dataH[xGeomOpposite].w;vec3 oppositePos = posXYZW[xGeomOpposite].xyz;\n            vec3 oppositeDir = dir[xGeomOpposite].xyz;vec3 dirToOpposite = (oppositePos-currentPos);\nvec3 dirToOppositeN = normalize(dirToOpposite);\nfloat dist = distance(oppositePos, currentPos);\nfloat distN = max(0.0,dist)/100000.0;float p = 1.0;if(currentDieDate != 0.0 && (currentTimestamp < currentBornDate || currentTimestamp > currentDieDate)) p = 0.0;if(oppositeDieDate != 0.0 && (currentTimestamp < oppositeBornDate || currentTimestamp > oppositeDieDate)) p = 0.0;if(p == 1.0) {float m1 = (enableNeuronalNetwork == 1.0) ? 0.0 : 400000.0;float m2 = (enableNeuronalNetwork == 1.0) ? 0.0 : 48.0;if(currentIsParent == 1.0) {netChildInputSumA += oppositeNetOutputA*oppositeWeight;netChildInputSumB += oppositeNetOutputB*oppositeWeight;netChildInputSumC += oppositeNetOutputC*oppositeWeight;netChildInputSumD += oppositeNetOutputD*oppositeWeight;netChildInputSumE += oppositeNetOutputE*oppositeWeight;netChildInputSumF += oppositeNetOutputF*oppositeWeight;netChildInputSumG += oppositeNetOutputG*oppositeWeight;atraction += dirToOppositeN*max(1.0, distN*abs(oppositeWeight)*(m1/2.0));\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(oppositeWeight)*(m2/2.0));\nacumAtraction += 1.0;\n} else if(currentIsParent == 0.5) {netParentErrorWeightA += oppositeNetErrorA*currentWeight;netParentErrorWeightB += oppositeNetErrorB*currentWeight;netParentErrorWeightC += oppositeNetErrorC*currentWeight;netParentErrorWeightD += oppositeNetErrorD*currentWeight;netParentErrorWeightE += oppositeNetErrorE*currentWeight;netParentErrorWeightF += oppositeNetErrorF*currentWeight;netParentErrorWeightG += oppositeNetErrorG*currentWeight;atraction += dirToOppositeN*max(1.0, distN*abs(currentWeight)*m1);\nrepulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*m2);\nacumAtraction += 1.0;\n}repulsion += -dirToOppositeN*max(1.0, (1.0-distN)*abs(currentWeight)*(m2/8.0));\nacumAtraction += 1.0;\n}float collisionExists = 0.0;\n            if(enableForceLayoutCollision == 1.0 && dist < 4.0) {\n                collisionExists = 1.0;\n                atraction = sphericalColl(currentDir, oppositeDir, dirToOppositeN);\n            }\n\n            return CalculationResponse(atraction, acumAtraction, repulsion, collisionExists,\n                                        netChildInputSumA, netParentErrorWeightA,\n                                        netChildInputSumB, netParentErrorWeightB,\n                                        netChildInputSumC, netParentErrorWeightC,\n                                        netChildInputSumD, netParentErrorWeightD,\n                                        netChildInputSumE, netParentErrorWeightE,\n                                        netChildInputSumF, netParentErrorWeightF,\n                                        netChildInputSumG, netParentErrorWeightG);\n        }\n        struct idAdjMatrixResponse {\n            vec3 force;\n            float collisionExists;\n            float netFOutputA;\n            float netErrorWeightA;\n            float netFOutputB;\n            float netErrorWeightB;\n            float netFOutputC;\n            float netErrorWeightC;\n            float netFOutputD;\n            float netErrorWeightD;\n            float netFOutputE;\n            float netErrorWeightE;\n            float netFOutputF;\n            float netErrorWeightF;\n            float netFOutputG;\n            float netErrorWeightG;\n        };\n        float tanh(float val) {\n            float tmp = exp(val);\n            float tanH = (tmp - 1.0 / tmp) / (tmp + 1.0 / tmp);\n            return tanH;\n        }\n        float sigm(float val) {\n            return (1.0 / (1.0 + exp(-val)));\n        }\n        idAdjMatrixResponse idAdjMatrix_ForceLayout(float nodeId, vec3 currentPos, vec3 currentDir, float numOfConnections, float currentTimestamp, float bornDate, float dieDate, float enableNeuronalNetwork) {\n            vec3 atraction = vec3(0.0, 0.0, 0.0);\n            float acumAtraction = 1.0;\n            vec3 repulsion = vec3(0.0, 0.0, 0.0);\n\n            float collisionExists = 0.0;\n            vec3 force = vec3(0.0, 0.0, 0.0);\n\n\n            float netChildInputSumA = 0.0;\n            float foutputA = 0.0;\n            float netParentErrorWeightA = 0.0;\n            \n            float netChildInputSumB = 0.0;\n            float foutputB = 0.0;\n            float netParentErrorWeightB = 0.0;\n            \n            float netChildInputSumC = 0.0;\n            float foutputC = 0.0;\n            float netParentErrorWeightC = 0.0;\n            \n            float netChildInputSumD = 0.0;\n            float foutputD = 0.0;\n            float netParentErrorWeightD = 0.0;\n            \n            float netChildInputSumE = 0.0;\n            float foutputE = 0.0;\n            float netParentErrorWeightE = 0.0;\n            \n            float netChildInputSumF = 0.0;\n            float foutputF = 0.0;\n            float netParentErrorWeightF = 0.0;\n            \n            float netChildInputSumG = 0.0;\n            float foutputG = 0.0;\n            float netParentErrorWeightG = 0.0;\n            \n\n            if(nodeId < nodesCount) {\n                float currentActivationFn = 0.0;\n                vec2 xGeomCurrent = get_global_id(nodeId, uBufferWidth, "+t.toFixed(1)+");\n                for(int n=0; n < 4096; n++) {\n                    if(float(n) >= nodesCount) {break;}\n                    if(float(n) != nodeId) {\n                        vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+t.toFixed(1)+");\n\n\n                        vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);\n                        vec2 xAdjMatOpposite = get_global_id(vec2(nodeId, float(n)), widthAdjMatrix);\n\n                        vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\n                        vec4 pixAdjMatAOpposite = adjacencyMatrix[xAdjMatOpposite];\n\n                        vec4 pixAdjMatBCurrent = adjacencyMatrixB[xAdjMatCurrent];\n                        vec4 pixAdjMatBOpposite = adjacencyMatrixB[xAdjMatOpposite];\n\n\n                        CalculationResponse calcResponse = calculate(nodeId,\n                                                                    pixAdjMatACurrent, pixAdjMatAOpposite,\n                                                                    pixAdjMatBCurrent, pixAdjMatBOpposite,\n                                                                    xGeomCurrent, xGeomOpposite,\n                                                                    currentPos, currentDir,\n                                                                    atraction, acumAtraction, repulsion,\n                                                                    enableNeuronalNetwork,\n                                                                    netChildInputSumA, netParentErrorWeightA,\n                                                                    netChildInputSumB, netParentErrorWeightB,\n                                                                    netChildInputSumC, netParentErrorWeightC,\n                                                                    netChildInputSumD, netParentErrorWeightD,\n                                                                    netChildInputSumE, netParentErrorWeightE,\n                                                                    netChildInputSumF, netParentErrorWeightF,\n                                                                    netChildInputSumG, netParentErrorWeightG);\n                        atraction = calcResponse.atraction;\n                        acumAtraction = calcResponse.acumAtraction;\n                        repulsion = calcResponse.repulsion;\n                        \n                        \n                        netChildInputSumA = calcResponse.netChildInputSumA;\n                        netParentErrorWeightA = calcResponse.netParentErrorWeightA;\n                        \n                        netChildInputSumB = calcResponse.netChildInputSumB;\n                        netParentErrorWeightB = calcResponse.netParentErrorWeightB;\n                        \n                        netChildInputSumC = calcResponse.netChildInputSumC;\n                        netParentErrorWeightC = calcResponse.netParentErrorWeightC;\n                        \n                        netChildInputSumD = calcResponse.netChildInputSumD;\n                        netParentErrorWeightD = calcResponse.netParentErrorWeightD;\n                        \n                        netChildInputSumE = calcResponse.netChildInputSumE;\n                        netParentErrorWeightE = calcResponse.netParentErrorWeightE;\n                        \n                        netChildInputSumF = calcResponse.netChildInputSumF;\n                        netParentErrorWeightF = calcResponse.netParentErrorWeightF;\n                        \n                        netChildInputSumG = calcResponse.netChildInputSumG;\n                        netParentErrorWeightG = calcResponse.netParentErrorWeightG;\n\n\n                        if(calcResponse.collisionExists == 1.0) {\n                            collisionExists = 1.0;\n                            force = calcResponse.atraction;\n                            break;\n                        }\n\n                        if(dieDate != 0.0) {\n                            if(currentTimestamp < bornDate || currentTimestamp > dieDate) {\n                                force = vec3(0.0, 0.0, 0.0);\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                if(collisionExists == 0.0) {\n                    force += (atraction/acumAtraction)*1.0;\n                    force += (repulsion/acumAtraction)*1.0;\n                }\n\n                if(enableNeuronalNetwork == 1.0) {\n                    "+e.efferentNodesStr(r,n)+"\n                }\n            }\n\n            return idAdjMatrixResponse(vec3(force), collisionExists,\n                                        foutputA, netParentErrorWeightA,\n                                        foutputB, netParentErrorWeightB,\n                                        foutputC, netParentErrorWeightC,\n                                        foutputD, netParentErrorWeightD,\n                                        foutputE, netParentErrorWeightE,\n                                        foutputF, netParentErrorWeightF,\n                                        foutputG, netParentErrorWeightG);\n        }"}},{key:"efferentNodesStr",value:function(e,t){var r="\n            if(nodeId < afferentNodesCount) {\n                for(float n=0.0; n < 1024.0; n+=1.0) {\n                    if(n >= afferentNodesCount) {\n                        break;\n                    }\n                    if(nodeId == n) {\n                        foutputA = afferentNodesA[int(n)];\n                        foutputB = afferentNodesB[int(n)];\n                        foutputC = afferentNodesC[int(n)];\n                        foutputD = afferentNodesD[int(n)];\n                        foutputE = afferentNodesE[int(n)];\n                        foutputF = afferentNodesF[int(n)];\n                        foutputG = afferentNodesG[int(n)];\n                        break;\n                    }\n                }\n            } else {\n                foutputA = max(0.0, netChildInputSumA); \n                foutputB = max(0.0, netChildInputSumB);\n                foutputC = max(0.0, netChildInputSumC);\n                foutputD = max(0.0, netChildInputSumD);\n                foutputE = max(0.0, netChildInputSumE);\n                foutputF = max(0.0, netChildInputSumF);\n                foutputG = max(0.0, netChildInputSumG);\n            }";r+="\n        if(nodeId == "+e.toFixed(1)+") {\n            netParentErrorWeightA = (efferentNodesA[0] != 0.0) ? netChildInputSumA-efferentNodesA[0] : 0.0;\n            \n            netParentErrorWeightB = (efferentNodesB[0] != 0.0) ? netChildInputSumB-efferentNodesB[0] : 0.0;\n            \n            netParentErrorWeightC = (efferentNodesC[0] != 0.0) ? netChildInputSumC-efferentNodesC[0] : 0.0;\n            \n            netParentErrorWeightD = (efferentNodesD[0] != 0.0) ? netChildInputSumD-efferentNodesD[0] : 0.0;\n            \n            netParentErrorWeightE = (efferentNodesE[0] != 0.0) ? netChildInputSumE-efferentNodesE[0] : 0.0;\n            \n            netParentErrorWeightF = (efferentNodesF[0] != 0.0) ? netChildInputSumF-efferentNodesF[0] : 0.0;\n            \n            netParentErrorWeightG = (efferentNodesG[0] != 0.0) ? netChildInputSumG-efferentNodesG[0] : 0.0;\n            \n        }";for(var n=e+1;n<e+t;n++)r+="\n            else if(nodeId == "+n.toFixed(1)+") {\n                netParentErrorWeightA = (efferentNodesA["+Math.round(n-e)+"] != 0.0) ? netChildInputSumA-efferentNodesA["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightB = (efferentNodesB["+Math.round(n-e)+"] != 0.0) ? netChildInputSumB-efferentNodesB["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightC = (efferentNodesC["+Math.round(n-e)+"] != 0.0) ? netChildInputSumC-efferentNodesC["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightD = (efferentNodesD["+Math.round(n-e)+"] != 0.0) ? netChildInputSumD-efferentNodesD["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightE = (efferentNodesE["+Math.round(n-e)+"] != 0.0) ? netChildInputSumE-efferentNodesE["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightF = (efferentNodesF["+Math.round(n-e)+"] != 0.0) ? netChildInputSumF-efferentNodesF["+Math.round(n-e)+"] : 0.0;\n                \n                netParentErrorWeightG = (efferentNodesG["+Math.round(n-e)+"] != 0.0) ? netChildInputSumG-efferentNodesG["+Math.round(n-e)+"] : 0.0;\n                \n            }";return r+="\n        else {\n            if(foutputA <= 0.0) {\n                netParentErrorWeightA = 0.0;\n            }\n            if(foutputB <= 0.0) {\n                netParentErrorWeightB = 0.0;\n            }\n            if(foutputC <= 0.0) {\n                netParentErrorWeightC = 0.0;\n            }\n            if(foutputD <= 0.0) {\n                netParentErrorWeightD = 0.0;\n            }\n            if(foutputE <= 0.0) {\n                netParentErrorWeightE = 0.0;\n            }\n            if(foutputF <= 0.0) {\n                netParentErrorWeightF = 0.0;\n            }\n            if(foutputG <= 0.0) {\n                netParentErrorWeightG = 0.0;\n            }\n        }"}},{key:"adjMatrix_Autolink_GLSLFunctionString",value:function(e){return"float GetAngle(vec3 A, vec3 B) {vec3 cr = cross(A, B);float d = dot(A, B);if(cr.y < 0.0) {if(d > 0.0) {d =        (1.0-d)*90.0;} else {d = 90.0+  (abs(d)*90.0);}} else {if(d > 0.0) {d = 270.0+ (d*90.0);} else {d = 180.0+ ((1.0-abs(d))*90.0);}}return d;}vec4 idAdjMatrix_Autolink(float nodeId, vec3 currentPos) {\nvec2 totalIDrelation = vec2(0.0, 0.0);float totalAngleRelations = 0.0;if(nodeId < nodesCount) {\nfor(int n=0; n < 4096; n++) {\nif(float(n) >= nodesCount) break;\nif(float(n) != nodeId) {vec2 xAdjMatCurrent = get_global_id(vec2(float(n), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent = adjacencyMatrix[xAdjMatCurrent];\nif(pixAdjMatACurrent.x > 0.0) {vec2 xGeomOpposite = get_global_id(float(n), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosB = posXYZW[xGeomOpposite].xyz;\nvec3 dirToBN = normalize(currentPosB-currentPos);\nvec2 IDrelation = vec2(0.0, 0.0);float angleRelations = 360.0;if(nodeId < nodesCount) {\nfor(int nB=0; nB < 4096; nB++) {\nif(float(nB) >= nodesCount) break;\nif(float(nB) != float(n) && float(nB) != nodeId) {vec2 xAdjMatCurrentB = get_global_id(vec2(float(nB), nodeId), widthAdjMatrix);vec4 pixAdjMatACurrent_B = adjacencyMatrix[xAdjMatCurrentB];\nif(pixAdjMatACurrent_B.x > 0.0) {vec2 xGeom_oppoB = get_global_id(float(nB), uBufferWidth, "+e.toFixed(1)+");\nvec3 currentPosBB = posXYZW[xGeom_oppoB].xyz;\nvec3 dirToBBN = normalize(currentPosBB-currentPos);\nfloat angle = GetAngle(dirToBN,dirToBBN);if(angle > 0.0 && angle < angleRelations) {IDrelation = xGeom_oppoB;angleRelations = angle;}}}}}if(angleRelations < 360.0 && angleRelations > totalAngleRelations) {totalIDrelation = IDrelation;totalAngleRelations = angleRelations;}}}}}return vec4(totalIDrelation, totalAngleRelations, 0.0);}"}}]),e}();e.GraphUtils=a,t.exports.GraphUtils=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[2]),function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[i]={exports:{}};t[i][0].call(d.exports,function(e){var r=t[i][1][e];return o(r||e)},d,d.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ArrayGenerator:"./ArrayGenerator.class",Component:"./Component.class.js",Component_GPU:"./Component_GPU.class.js",ComponentControllerTransformTarget:"./ComponentControllerTransformTarget.class.js",ComponentKeyboardEvents:"./ComponentKeyboardEvents.class.js",ComponentMouseEvents:"./ComponentMouseEvents.class.js",ComponentProjection:"./ComponentProjection.class.js",ComponentTransform:"./ComponentTransform.class.js",ComponentTransformTarget:"./ComponentTransformTarget.class.js",Constants:"./Constants.js",Mesh:"./Mesh.class.js",Node:"./Node.class.js",Project:"./Project.class.js",SCE:"./SCE.class.js",Stage:"./Stage.class.js",StormM16:"./StormMath.class.js",StormV3:"./StormMath.class.js",SystemEvents:"./SystemEvents.class.js",Utils:"./Utils.class.js",VFP_RGB:"./VFP_RGB.class.js",Grid:"./Prefabs/Grid/Grid.class.js",SimpleCamera:"./Prefabs/SimpleCamera/SimpleCamera.class.js",SimpleNode:"./Prefabs/SimpleNode/SimpleNode.class.js"};for(var o in n)r[o]=e(n[o])},{}],2:[function(e,t,r){(function(n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.VFP_NODEPICKDRAG=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("scejs");var i=r.VFP_NODEPICKDRAG=function(){function e(){o(this,e)}return a(e,null,[{key:"getSrc",value:function(e){return[[void 0],"varying vec4 vColor;\n"+Utils.packGLSLFunctionString()+"mat4 rotationMatrix(vec3 axis, float angle) {axis = normalize(axis);float s = sin(angle);float c = cos(angle);float oc = 1.0 - c;return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,0.0,                                0.0,                                0.0,                                1.0);}","vec2 xGeometry = get_global_id(data[].x, uBufferWidth, "+e.toFixed(1)+");vec4 nodePosition = posXYZW[xGeometry];\nfloat bornDate = dataB[xGeometry].x;float dieDate = dataB[xGeometry].y;mat4 nodepos = nodeWMatrix;mat4 mm = rotationMatrix(vec3(1.0,0.0,0.0), (3.1416/2.0)*3.0);nodepos = nodepos*mm;nodepos[3][0] = nodePosition.x;nodepos[3][1] = nodePosition.y;nodepos[3][2] = nodePosition.z;vColor = vec4(1.0, 1.0, 1.0, 1.0);int mak = 0;if(dieDate != 0.0) {if(currentTimestamp > bornDate && currentTimestamp < dieDate) mak = 1;} else mak = 1;if(mak == 1) {vColor = pack((data[].x+1.0)/1000000.0);}if(vColor.x == 1.0 && vColor.y == 1.0 && vColor.z == 1.0 && vColor.w == 1.0) nodepos[3][0] = 10000.0;gl_Position = PMatrix * cameraWMatrix * nodepos * nodeVertexPos[];\ngl_PointSize = 10.0;\n","varying vec4 vColor;\n","return [vColor];\n"]}}]),e}();n.VFP_NODEPICKDRAG=i,t.exports.VFP_NODEPICKDRAG=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{scejs:1}]},{},[2]);