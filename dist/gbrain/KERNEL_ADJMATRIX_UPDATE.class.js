(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
(function (global){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () {
    function defineProperties(target, props) {
        for (var i = 0; i < props.length; i++) {
            var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
        }
    }return function (Constructor, protoProps, staticProps) {
        if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
    };
}();

function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
    }
}

var KERNEL_ADJMATRIX_UPDATE = exports.KERNEL_ADJMATRIX_UPDATE = function () {
    function KERNEL_ADJMATRIX_UPDATE() {
        _classCallCheck(this, KERNEL_ADJMATRIX_UPDATE);
    }

    _createClass(KERNEL_ADJMATRIX_UPDATE, null, [{
        key: "getSrc",
        value: function getSrc(geometryLength) {
            return ["x", ["adjacencyMatrix", "adjacencyMatrixB"],
            // head
            "",

            // source
            "vec4 adjMat = adjacencyMatrix[x]; \n            vec4 adjMatB = adjacencyMatrixB[x];\n\n            float linkLayerNum = adjMat.x;\n            float weightQuadSum = adjMat.y;\n            float linkWeight = adjMat.z;\n            float linkTypeParent = adjMat.w;\n            \n            float weightAbsSum = adjMatB.x;\n            float costSum = adjMatB.y;\n            \n            if(linkTypeParent == 0.5 && linkLayerNum >= 0.0) {\n                float id = adjMatB.z;\n                float idInv = adjMatB.w;\n            \n                vec2 xGeometryCurrentChild = get_global_id(id, bufferNodesWidth, " + geometryLength.toFixed(1) + ");\n                vec2 xGeometryParent = get_global_id(idInv, bufferNodesWidth, " + geometryLength.toFixed(1) + (");\n\n                float childGDeltaA = dataB[xGeometryCurrentChild].y;\n                float childGOutputA = dataB[xGeometryCurrentChild].z;\n                float parentGOutputA = dataB[xGeometryParent].z;\n                float parentGInputsumA = dataB[xGeometryParent].w;\n                float parentGOutputDerivA = 1.0;\n                \n                float childGDeltaB = dataF[xGeometryCurrentChild].x;\n                float childGOutputB = dataF[xGeometryCurrentChild].y;\n                float parentGOutputB = dataF[xGeometryParent].y;\n                float parentGInputsumB = dataF[xGeometryParent].z;\n                float parentGOutputDerivB = 1.0;\n                \n                float childGDeltaC = dataF[xGeometryCurrentChild].w;\n                float childGOutputC = dataG[xGeometryCurrentChild].x;\n                float parentGOutputC = dataG[xGeometryParent].x;\n                float parentGInputsumC = dataG[xGeometryParent].y;\n                float parentGOutputDerivC = 1.0;\n                \n                float childGDeltaD = dataG[xGeometryCurrentChild].z;\n                float childGOutputD = dataG[xGeometryCurrentChild].w;\n                float parentGOutputD = dataG[xGeometryParent].w;\n                float parentGInputsumD = dataH[xGeometryParent].x;\n                float parentGOutputDerivD = 1.0;\n                \n                float childGDeltaE = dataH[xGeometryCurrentChild].y;\n                float childGOutputE = dataH[xGeometryCurrentChild].z;\n                float parentGOutputE = dataH[xGeometryParent].z;\n                float parentGInputsumE = dataH[xGeometryParent].w;\n                float parentGOutputDerivE = 1.0;\n            \n                float lr = learningRate;\n                float l1_decay = 0.0;\n                float l2_decay = 0.01;\n                float gpu_batch_size =5.0;\n                \n                \n                if(linkLayerNum < layerCount-2.0) { \n                    parentGOutputDerivA = (parentGInputsumA <= 0.0) ? 0.01 : 1.0;                    \n                    parentGOutputDerivB = (parentGInputsumB <= 0.0) ? 0.01 : 1.0;\n                    parentGOutputDerivC = (parentGInputsumC <= 0.0) ? 0.01 : 1.0;\n                    parentGOutputDerivD = (parentGInputsumD <= 0.0) ? 0.01 : 1.0;\n                    parentGOutputDerivE = (parentGInputsumE <= 0.0) ? 0.01 : 1.0;\n                }\n                if(weightQuadSum != 0.0) {\n                    linkWeight += -lr* ( (l2_decay*weightQuadSum) + (l1_decay*weightAbsSum) + ((childGDeltaA*parentGOutputDerivA*childGOutputA)/(gpu_batch_size*batch_repeats)) );\n                    linkWeight += -lr* ( (l2_decay*weightQuadSum) + (l1_decay*weightAbsSum) + ((childGDeltaB*parentGOutputDerivB*childGOutputB)/(gpu_batch_size*batch_repeats)) );\n                    linkWeight += -lr* ( (l2_decay*weightQuadSum) + (l1_decay*weightAbsSum) + ((childGDeltaC*parentGOutputDerivC*childGOutputC)/(gpu_batch_size*batch_repeats)) );\n                    linkWeight += -lr* ( (l2_decay*weightQuadSum) + (l1_decay*weightAbsSum) + ((childGDeltaD*parentGOutputDerivD*childGOutputD)/(gpu_batch_size*batch_repeats)) );\n                    linkWeight += -lr* ( (l2_decay*weightQuadSum) + (l1_decay*weightAbsSum) + ((childGDeltaE*parentGOutputDerivE*childGOutputE)/(gpu_batch_size*batch_repeats)) ); \n                    \n                    " + "\n                    \n                    weightQuadSum = 0.0;\n                    weightAbsSum = 0.0;\n                } else {\n                    weightQuadSum += linkWeight*linkWeight;\n                    weightAbsSum += abs(linkWeight);\n                }\n                \n                \n                " + "\n            }\n            \n            return [vec4(linkLayerNum, weightQuadSum, linkWeight, linkTypeParent), vec4(weightAbsSum, costSum, adjMatB.z, adjMatB.w)];\n            ")];
        }
    }]);

    return KERNEL_ADJMATRIX_UPDATE;
}();

global.KERNEL_ADJMATRIX_UPDATE = KERNEL_ADJMATRIX_UPDATE;
module.exports.KERNEL_ADJMATRIX_UPDATE = KERNEL_ADJMATRIX_UPDATE;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvZ2JyYWluL0tFUk5FTF9BREpNQVRSSVhfVVBEQVRFLmNsYXNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfXJldHVybiBlfSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07ZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO2Rlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICAgICAgfVxuICAgIH1yZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgICAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO2lmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO3JldHVybiBDb25zdHJ1Y3RvcjtcbiAgICB9O1xufSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgICB9XG59XG5cbnZhciBLRVJORUxfQURKTUFUUklYX1VQREFURSA9IGV4cG9ydHMuS0VSTkVMX0FESk1BVFJJWF9VUERBVEUgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS0VSTkVMX0FESk1BVFJJWF9VUERBVEUoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBLRVJORUxfQURKTUFUUklYX1VQREFURSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEtFUk5FTF9BREpNQVRSSVhfVVBEQVRFLCBudWxsLCBbe1xuICAgICAgICBrZXk6IFwiZ2V0U3JjXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTcmMoZ2VvbWV0cnlMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBbXCJ4XCIsIFtcImFkamFjZW5jeU1hdHJpeFwiLCBcImFkamFjZW5jeU1hdHJpeEJcIl0sXG4gICAgICAgICAgICAvLyBoZWFkXG4gICAgICAgICAgICBcIlwiLFxuXG4gICAgICAgICAgICAvLyBzb3VyY2VcbiAgICAgICAgICAgIFwidmVjNCBhZGpNYXQgPSBhZGphY2VuY3lNYXRyaXhbeF07IFxcbiAgICAgICAgICAgIHZlYzQgYWRqTWF0QiA9IGFkamFjZW5jeU1hdHJpeEJbeF07XFxuXFxuICAgICAgICAgICAgZmxvYXQgbGlua0xheWVyTnVtID0gYWRqTWF0Lng7XFxuICAgICAgICAgICAgZmxvYXQgd2VpZ2h0UXVhZFN1bSA9IGFkak1hdC55O1xcbiAgICAgICAgICAgIGZsb2F0IGxpbmtXZWlnaHQgPSBhZGpNYXQuejtcXG4gICAgICAgICAgICBmbG9hdCBsaW5rVHlwZVBhcmVudCA9IGFkak1hdC53O1xcbiAgICAgICAgICAgIFxcbiAgICAgICAgICAgIGZsb2F0IHdlaWdodEFic1N1bSA9IGFkak1hdEIueDtcXG4gICAgICAgICAgICBmbG9hdCBjb3N0U3VtID0gYWRqTWF0Qi55O1xcbiAgICAgICAgICAgIFxcbiAgICAgICAgICAgIGlmKGxpbmtUeXBlUGFyZW50ID09IDAuNSAmJiBsaW5rTGF5ZXJOdW0gPj0gMC4wKSB7XFxuICAgICAgICAgICAgICAgIGZsb2F0IGlkID0gYWRqTWF0Qi56O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBpZEludiA9IGFkak1hdEIudztcXG4gICAgICAgICAgICBcXG4gICAgICAgICAgICAgICAgdmVjMiB4R2VvbWV0cnlDdXJyZW50Q2hpbGQgPSBnZXRfZ2xvYmFsX2lkKGlkLCBidWZmZXJOb2Rlc1dpZHRoLCBcIiArIGdlb21ldHJ5TGVuZ3RoLnRvRml4ZWQoMSkgKyBcIik7XFxuICAgICAgICAgICAgICAgIHZlYzIgeEdlb21ldHJ5UGFyZW50ID0gZ2V0X2dsb2JhbF9pZChpZEludiwgYnVmZmVyTm9kZXNXaWR0aCwgXCIgKyBnZW9tZXRyeUxlbmd0aC50b0ZpeGVkKDEpICsgKFwiKTtcXG5cXG4gICAgICAgICAgICAgICAgZmxvYXQgY2hpbGRHRGVsdGFBID0gZGF0YUJbeEdlb21ldHJ5Q3VycmVudENoaWxkXS55O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBjaGlsZEdPdXRwdXRBID0gZGF0YUJbeEdlb21ldHJ5Q3VycmVudENoaWxkXS56O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBwYXJlbnRHT3V0cHV0QSA9IGRhdGFCW3hHZW9tZXRyeVBhcmVudF0uejtcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R0lucHV0c3VtQSA9IGRhdGFCW3hHZW9tZXRyeVBhcmVudF0udztcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R091dHB1dERlcml2QSA9IDEuMDtcXG4gICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgIGZsb2F0IGNoaWxkR0RlbHRhQiA9IGRhdGFGW3hHZW9tZXRyeUN1cnJlbnRDaGlsZF0ueDtcXG4gICAgICAgICAgICAgICAgZmxvYXQgY2hpbGRHT3V0cHV0QiA9IGRhdGFGW3hHZW9tZXRyeUN1cnJlbnRDaGlsZF0ueTtcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R091dHB1dEIgPSBkYXRhRlt4R2VvbWV0cnlQYXJlbnRdLnk7XFxuICAgICAgICAgICAgICAgIGZsb2F0IHBhcmVudEdJbnB1dHN1bUIgPSBkYXRhRlt4R2VvbWV0cnlQYXJlbnRdLno7XFxuICAgICAgICAgICAgICAgIGZsb2F0IHBhcmVudEdPdXRwdXREZXJpdkIgPSAxLjA7XFxuICAgICAgICAgICAgICAgIFxcbiAgICAgICAgICAgICAgICBmbG9hdCBjaGlsZEdEZWx0YUMgPSBkYXRhRlt4R2VvbWV0cnlDdXJyZW50Q2hpbGRdLnc7XFxuICAgICAgICAgICAgICAgIGZsb2F0IGNoaWxkR091dHB1dEMgPSBkYXRhR1t4R2VvbWV0cnlDdXJyZW50Q2hpbGRdLng7XFxuICAgICAgICAgICAgICAgIGZsb2F0IHBhcmVudEdPdXRwdXRDID0gZGF0YUdbeEdlb21ldHJ5UGFyZW50XS54O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBwYXJlbnRHSW5wdXRzdW1DID0gZGF0YUdbeEdlb21ldHJ5UGFyZW50XS55O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBwYXJlbnRHT3V0cHV0RGVyaXZDID0gMS4wO1xcbiAgICAgICAgICAgICAgICBcXG4gICAgICAgICAgICAgICAgZmxvYXQgY2hpbGRHRGVsdGFEID0gZGF0YUdbeEdlb21ldHJ5Q3VycmVudENoaWxkXS56O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBjaGlsZEdPdXRwdXREID0gZGF0YUdbeEdlb21ldHJ5Q3VycmVudENoaWxkXS53O1xcbiAgICAgICAgICAgICAgICBmbG9hdCBwYXJlbnRHT3V0cHV0RCA9IGRhdGFHW3hHZW9tZXRyeVBhcmVudF0udztcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R0lucHV0c3VtRCA9IGRhdGFIW3hHZW9tZXRyeVBhcmVudF0ueDtcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R091dHB1dERlcml2RCA9IDEuMDtcXG4gICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgIGZsb2F0IGNoaWxkR0RlbHRhRSA9IGRhdGFIW3hHZW9tZXRyeUN1cnJlbnRDaGlsZF0ueTtcXG4gICAgICAgICAgICAgICAgZmxvYXQgY2hpbGRHT3V0cHV0RSA9IGRhdGFIW3hHZW9tZXRyeUN1cnJlbnRDaGlsZF0uejtcXG4gICAgICAgICAgICAgICAgZmxvYXQgcGFyZW50R091dHB1dEUgPSBkYXRhSFt4R2VvbWV0cnlQYXJlbnRdLno7XFxuICAgICAgICAgICAgICAgIGZsb2F0IHBhcmVudEdJbnB1dHN1bUUgPSBkYXRhSFt4R2VvbWV0cnlQYXJlbnRdLnc7XFxuICAgICAgICAgICAgICAgIGZsb2F0IHBhcmVudEdPdXRwdXREZXJpdkUgPSAxLjA7XFxuICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgIGZsb2F0IGxyID0gbGVhcm5pbmdSYXRlO1xcbiAgICAgICAgICAgICAgICBmbG9hdCBsMV9kZWNheSA9IDAuMDtcXG4gICAgICAgICAgICAgICAgZmxvYXQgbDJfZGVjYXkgPSAwLjAxO1xcbiAgICAgICAgICAgICAgICBmbG9hdCBncHVfYmF0Y2hfc2l6ZSA9NS4wO1xcbiAgICAgICAgICAgICAgICBcXG4gICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgIGlmKGxpbmtMYXllck51bSA8IGxheWVyQ291bnQtMi4wKSB7IFxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50R091dHB1dERlcml2QSA9IChwYXJlbnRHSW5wdXRzdW1BIDw9IDAuMCkgPyAwLjAxIDogMS4wOyAgICAgICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRHT3V0cHV0RGVyaXZCID0gKHBhcmVudEdJbnB1dHN1bUIgPD0gMC4wKSA/IDAuMDEgOiAxLjA7XFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRHT3V0cHV0RGVyaXZDID0gKHBhcmVudEdJbnB1dHN1bUMgPD0gMC4wKSA/IDAuMDEgOiAxLjA7XFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRHT3V0cHV0RGVyaXZEID0gKHBhcmVudEdJbnB1dHN1bUQgPD0gMC4wKSA/IDAuMDEgOiAxLjA7XFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRHT3V0cHV0RGVyaXZFID0gKHBhcmVudEdJbnB1dHN1bUUgPD0gMC4wKSA/IDAuMDEgOiAxLjA7XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgaWYod2VpZ2h0UXVhZFN1bSAhPSAwLjApIHtcXG4gICAgICAgICAgICAgICAgICAgIGxpbmtXZWlnaHQgKz0gLWxyKiAoIChsMl9kZWNheSp3ZWlnaHRRdWFkU3VtKSArIChsMV9kZWNheSp3ZWlnaHRBYnNTdW0pICsgKChjaGlsZEdEZWx0YUEqcGFyZW50R091dHB1dERlcml2QSpjaGlsZEdPdXRwdXRBKS8oZ3B1X2JhdGNoX3NpemUqYmF0Y2hfcmVwZWF0cykpICk7XFxuICAgICAgICAgICAgICAgICAgICBsaW5rV2VpZ2h0ICs9IC1sciogKCAobDJfZGVjYXkqd2VpZ2h0UXVhZFN1bSkgKyAobDFfZGVjYXkqd2VpZ2h0QWJzU3VtKSArICgoY2hpbGRHRGVsdGFCKnBhcmVudEdPdXRwdXREZXJpdkIqY2hpbGRHT3V0cHV0QikvKGdwdV9iYXRjaF9zaXplKmJhdGNoX3JlcGVhdHMpKSApO1xcbiAgICAgICAgICAgICAgICAgICAgbGlua1dlaWdodCArPSAtbHIqICggKGwyX2RlY2F5KndlaWdodFF1YWRTdW0pICsgKGwxX2RlY2F5KndlaWdodEFic1N1bSkgKyAoKGNoaWxkR0RlbHRhQypwYXJlbnRHT3V0cHV0RGVyaXZDKmNoaWxkR091dHB1dEMpLyhncHVfYmF0Y2hfc2l6ZSpiYXRjaF9yZXBlYXRzKSkgKTtcXG4gICAgICAgICAgICAgICAgICAgIGxpbmtXZWlnaHQgKz0gLWxyKiAoIChsMl9kZWNheSp3ZWlnaHRRdWFkU3VtKSArIChsMV9kZWNheSp3ZWlnaHRBYnNTdW0pICsgKChjaGlsZEdEZWx0YUQqcGFyZW50R091dHB1dERlcml2RCpjaGlsZEdPdXRwdXREKS8oZ3B1X2JhdGNoX3NpemUqYmF0Y2hfcmVwZWF0cykpICk7XFxuICAgICAgICAgICAgICAgICAgICBsaW5rV2VpZ2h0ICs9IC1sciogKCAobDJfZGVjYXkqd2VpZ2h0UXVhZFN1bSkgKyAobDFfZGVjYXkqd2VpZ2h0QWJzU3VtKSArICgoY2hpbGRHRGVsdGFFKnBhcmVudEdPdXRwdXREZXJpdkUqY2hpbGRHT3V0cHV0RSkvKGdwdV9iYXRjaF9zaXplKmJhdGNoX3JlcGVhdHMpKSApOyBcXG4gICAgICAgICAgICAgICAgICAgIFxcbiAgICAgICAgICAgICAgICAgICAgXCIgKyBcIlxcbiAgICAgICAgICAgICAgICAgICAgXFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHRRdWFkU3VtID0gMC4wO1xcbiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0QWJzU3VtID0gMC4wO1xcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xcbiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0UXVhZFN1bSArPSBsaW5rV2VpZ2h0KmxpbmtXZWlnaHQ7XFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHRBYnNTdW0gKz0gYWJzKGxpbmtXZWlnaHQpO1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIFxcbiAgICAgICAgICAgICAgICBcXG4gICAgICAgICAgICAgICAgXCIgKyBcIlxcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBcXG4gICAgICAgICAgICByZXR1cm4gW3ZlYzQobGlua0xheWVyTnVtLCB3ZWlnaHRRdWFkU3VtLCBsaW5rV2VpZ2h0LCBsaW5rVHlwZVBhcmVudCksIHZlYzQod2VpZ2h0QWJzU3VtLCBjb3N0U3VtLCBhZGpNYXRCLnosIGFkak1hdEIudyldO1xcbiAgICAgICAgICAgIFwiKV07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gS0VSTkVMX0FESk1BVFJJWF9VUERBVEU7XG59KCk7XG5cbmdsb2JhbC5LRVJORUxfQURKTUFUUklYX1VQREFURSA9IEtFUk5FTF9BREpNQVRSSVhfVVBEQVRFO1xubW9kdWxlLmV4cG9ydHMuS0VSTkVMX0FESk1BVFJJWF9VUERBVEUgPSBLRVJORUxfQURKTUFUUklYX1VQREFURTsiXX0=
